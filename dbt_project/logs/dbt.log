[0m02:26:49.396833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11904eff70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f118f8d3940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f118f8d0250>]}


============================== 02:26:49.407674 | d500ab6d-8bd8-4316-8355-75d3c2a813df ==============================
[0m02:26:49.407674 [info ] [MainThread]: Running with dbt=1.9.4
[0m02:26:49.409938 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select trip_enriched trip_summary_per_hour high_value_customers', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:26:50.023192 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "nyc_profile", target "dev" invalid: 'port' is a required property
[0m02:26:50.026160 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.85712063, "process_in_blocks": "21744", "process_kernel_time": 0.224958, "process_mem_max_rss": "101952", "process_out_blocks": "496", "process_user_time": 2.566576}
[0m02:26:50.028815 [debug] [MainThread]: Command `dbt run` failed at 02:26:50.028608 after 0.86 seconds
[0m02:26:50.030769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11904eff70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f118f5c7850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f118f74cfd0>]}
[0m02:26:50.032733 [debug] [MainThread]: Flushing usage events
[0m02:26:50.573712 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:31:54.758105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2771c3bf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2770c8cc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2770c8cc70>]}


============================== 02:31:54.766917 | d4bbd740-6d29-42c3-bb93-8ffb940acb19 ==============================
[0m02:31:54.766917 [info ] [MainThread]: Running with dbt=1.9.4
[0m02:31:54.768874 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select trip_enriched trip_summary_per_hour high_value_customers', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:31:54.851699 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "nyc_profile", target "dev" invalid: 'port' is a required property
[0m02:31:54.854108 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.21227269, "process_in_blocks": "0", "process_kernel_time": 0.140501, "process_mem_max_rss": "99736", "process_out_blocks": "0", "process_user_time": 2.328317}
[0m02:31:54.856160 [debug] [MainThread]: Command `dbt run` failed at 02:31:54.855909 after 0.21 seconds
[0m02:31:54.857846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2771c3bf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2770ce66b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2770ff9510>]}
[0m02:31:54.859938 [debug] [MainThread]: Flushing usage events
[0m02:31:55.359172 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:49:37.544099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f040752bee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0406904280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04069074f0>]}


============================== 02:49:37.962379 | a3996a8e-7e04-4ca7-97d0-60b74136fbff ==============================
[0m02:49:37.962379 [info ] [MainThread]: Running with dbt=1.9.4
[0m02:49:37.965045 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select trip_enriched trip_summary_per_hour high_value_customers', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m02:49:39.033986 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m02:49:39.035688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a3996a8e-7e04-4ca7-97d0-60b74136fbff', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0406905db0>]}
[0m02:49:39.037771 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m02:49:39.040454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a3996a8e-7e04-4ca7-97d0-60b74136fbff', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04069050f0>]}
[0m02:49:42.308348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3996a8e-7e04-4ca7-97d0-60b74136fbff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0408d9d690>]}
[0m02:49:42.416403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3996a8e-7e04-4ca7-97d0-60b74136fbff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f040735d5d0>]}
[0m02:49:42.490771 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m02:49:42.718141 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m02:49:42.724987 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m02:49:42.727113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a3996a8e-7e04-4ca7-97d0-60b74136fbff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0405931120>]}
[0m02:49:45.294266 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.nyc_mobility_project.source_dim_weather' (models/staging/source_dim_weather.sql) depends on a source named 'nyc.dim_weather' which was not found
[0m02:49:45.297087 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.890745, "process_in_blocks": "8632", "process_kernel_time": 0.28237, "process_mem_max_rss": "111340", "process_out_blocks": "496", "process_user_time": 4.78984}
[0m02:49:45.299069 [debug] [MainThread]: Command `dbt run` failed at 02:49:45.298869 after 7.89 seconds
[0m02:49:45.300795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f040752bee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f040491f220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f040491f1f0>]}
[0m02:49:45.302751 [debug] [MainThread]: Flushing usage events
[0m02:49:46.355924 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:54:50.525677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed1fd1bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed1ed90c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed1ed90cd0>]}


============================== 02:54:50.534485 | 597212b3-b756-4f68-82bf-bcb9ff423cc3 ==============================
[0m02:54:50.534485 [info ] [MainThread]: Running with dbt=1.9.4
[0m02:54:50.536524 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select trip_enriched trip_summary_per_hour high_value_customers', 'send_anonymous_usage_stats': 'True'}
[0m02:54:50.655983 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m02:54:50.657794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '597212b3-b756-4f68-82bf-bcb9ff423cc3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed1ee4c700>]}
[0m02:54:50.659560 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m02:54:50.661734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '597212b3-b756-4f68-82bf-bcb9ff423cc3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed1ee4ce20>]}
[0m02:54:50.858033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '597212b3-b756-4f68-82bf-bcb9ff423cc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed2194b550>]}
[0m02:54:50.972387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '597212b3-b756-4f68-82bf-bcb9ff423cc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed1ed94a60>]}
[0m02:54:50.974738 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m02:54:51.122235 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m02:54:51.128271 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m02:54:51.130504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '597212b3-b756-4f68-82bf-bcb9ff423cc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed1e145270>]}
[0m02:54:53.035835 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.nyc_mobility_project.source_dim_weather' (models/staging/source_dim_weather.sql) depends on a source named 'nyc.dim_weather' which was not found
[0m02:54:53.038560 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.6557224, "process_in_blocks": "0", "process_kernel_time": 0.149413, "process_mem_max_rss": "111428", "process_out_blocks": "0", "process_user_time": 4.572065}
[0m02:54:53.041022 [debug] [MainThread]: Command `dbt run` failed at 02:54:53.040712 after 2.66 seconds
[0m02:54:53.043815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed1fd1bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed1d12f340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fed1d12f310>]}
[0m02:54:53.046232 [debug] [MainThread]: Flushing usage events
[0m02:54:53.513899 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:00:00.556576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc46debf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc45f30c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc45f30c70>]}


============================== 03:00:00.566185 | d93c5da3-2420-4d5c-bf63-4e4c54097363 ==============================
[0m03:00:00.566185 [info ] [MainThread]: Running with dbt=1.9.4
[0m03:00:00.570024 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select trip_enriched trip_summary_per_hour high_value_customers', 'send_anonymous_usage_stats': 'True'}
[0m03:00:00.703150 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m03:00:00.705244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd93c5da3-2420-4d5c-bf63-4e4c54097363', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc45ff7190>]}
[0m03:00:00.707385 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m03:00:00.709417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd93c5da3-2420-4d5c-bf63-4e4c54097363', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc45ff4730>]}
[0m03:00:00.913872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd93c5da3-2420-4d5c-bf63-4e4c54097363', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc4878baf0>]}
[0m03:00:01.007742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd93c5da3-2420-4d5c-bf63-4e4c54097363', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc45e14280>]}
[0m03:00:01.009994 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m03:00:01.179180 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m03:00:01.183851 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m03:00:01.185464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd93c5da3-2420-4d5c-bf63-4e4c54097363', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc44d512d0>]}
[0m03:00:03.444323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd93c5da3-2420-4d5c-bf63-4e4c54097363', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc4313a0b0>]}
[0m03:00:03.602186 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m03:00:03.621113 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m03:00:03.683106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd93c5da3-2420-4d5c-bf63-4e4c54097363', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc431a14e0>]}
[0m03:00:03.686078 [info ] [MainThread]: Found 5 models, 2 sources, 433 macros
[0m03:00:03.688382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd93c5da3-2420-4d5c-bf63-4e4c54097363', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc431a1540>]}
[0m03:00:03.692310 [info ] [MainThread]: 
[0m03:00:03.695342 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:00:03.697273 [info ] [MainThread]: 
[0m03:00:03.699954 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:00:03.709488 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nyc_dwh'
[0m03:00:03.776609 [debug] [ThreadPool]: Using postgres connection "list_nyc_dwh"
[0m03:00:03.778357 [debug] [ThreadPool]: On list_nyc_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "connection_name": "list_nyc_dwh"} */

    select distinct nspname from pg_namespace
  
[0m03:00:03.780032 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:00:03.787782 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.008 seconds
[0m03:00:03.790785 [debug] [ThreadPool]: On list_nyc_dwh: Close
[0m03:00:03.794959 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nyc_dwh, now list_nyc_dwh_public)
[0m03:00:03.806953 [debug] [ThreadPool]: Using postgres connection "list_nyc_dwh_public"
[0m03:00:03.808666 [debug] [ThreadPool]: On list_nyc_dwh_public: BEGIN
[0m03:00:03.810289 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:00:03.815978 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m03:00:03.818182 [debug] [ThreadPool]: Using postgres connection "list_nyc_dwh_public"
[0m03:00:03.820278 [debug] [ThreadPool]: On list_nyc_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "connection_name": "list_nyc_dwh_public"} */
select
      'nyc_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'nyc_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'nyc_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m03:00:03.830488 [debug] [ThreadPool]: SQL status: SELECT 46 in 0.008 seconds
[0m03:00:03.835741 [debug] [ThreadPool]: On list_nyc_dwh_public: ROLLBACK
[0m03:00:03.837914 [debug] [ThreadPool]: On list_nyc_dwh_public: Close
[0m03:00:03.859980 [debug] [MainThread]: Using postgres connection "master"
[0m03:00:03.861935 [debug] [MainThread]: On master: BEGIN
[0m03:00:03.863949 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:00:03.870590 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m03:00:03.872775 [debug] [MainThread]: Using postgres connection "master"
[0m03:00:03.875057 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:00:03.883220 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m03:00:03.886394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd93c5da3-2420-4d5c-bf63-4e4c54097363', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc43171d80>]}
[0m03:00:03.888481 [debug] [MainThread]: On master: ROLLBACK
[0m03:00:03.890473 [debug] [MainThread]: Using postgres connection "master"
[0m03:00:03.892479 [debug] [MainThread]: On master: BEGIN
[0m03:00:03.895926 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m03:00:03.898554 [debug] [MainThread]: On master: COMMIT
[0m03:00:03.900496 [debug] [MainThread]: Using postgres connection "master"
[0m03:00:03.902756 [debug] [MainThread]: On master: COMMIT
[0m03:00:03.904909 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:00:03.906759 [debug] [MainThread]: On master: Close
[0m03:00:03.918339 [debug] [Thread-1 (]: Began running node model.nyc_mobility_project.trip_enriched
[0m03:00:03.920579 [info ] [Thread-1 (]: 1 of 3 START sql table model public.trip_enriched .............................. [RUN]
[0m03:00:03.922913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nyc_dwh_public, now model.nyc_mobility_project.trip_enriched)
[0m03:00:03.924766 [debug] [Thread-1 (]: Began compiling node model.nyc_mobility_project.trip_enriched
[0m03:00:03.941417 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_mobility_project.trip_enriched"
[0m03:00:03.960493 [debug] [Thread-1 (]: Began executing node model.nyc_mobility_project.trip_enriched
[0m03:00:04.041829 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_mobility_project.trip_enriched"
[0m03:00:04.067211 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_enriched"
[0m03:00:04.069235 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: BEGIN
[0m03:00:04.071891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:00:04.078273 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m03:00:04.081905 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_enriched"
[0m03:00:04.086239 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.trip_enriched"} */

  
    

  create  table "nyc_dwh"."public"."trip_enriched__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    t.*,
    w.weather_category,
    w.temperature,
    w.humidity,
    w.wind_speed
FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
LEFT JOIN "nyc_dwh"."public"."source_dim_weather" w
  ON date_trunc('hour', t.tpep_pickup_datetime) = date_trunc('hour', w.event_time)
  );
  
[0m03:00:04.089098 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.source_fact_taxi_trips" does not exist
LINE 20: FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
              ^

[0m03:00:04.091262 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: ROLLBACK
[0m03:00:04.093673 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: Close
[0m03:00:04.106978 [debug] [Thread-1 (]: Database Error in model trip_enriched (models/marts/trip_enriched.sql)
  relation "public.source_fact_taxi_trips" does not exist
  LINE 20: FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
                ^
  compiled code at target/run/nyc_mobility_project/models/marts/trip_enriched.sql
[0m03:00:04.111631 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd93c5da3-2420-4d5c-bf63-4e4c54097363', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc4253fa90>]}
[0m03:00:04.114476 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model public.trip_enriched ..................... [[31mERROR[0m in 0.19s]
[0m03:00:04.119352 [debug] [Thread-1 (]: Finished running node model.nyc_mobility_project.trip_enriched
[0m03:00:04.123444 [debug] [Thread-4 (]: Marking all children of 'model.nyc_mobility_project.trip_enriched' to be skipped because of status 'error'.  Reason: Database Error in model trip_enriched (models/marts/trip_enriched.sql)
  relation "public.source_fact_taxi_trips" does not exist
  LINE 20: FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
                ^
  compiled code at target/run/nyc_mobility_project/models/marts/trip_enriched.sql.
[0m03:00:04.127056 [debug] [Thread-1 (]: Began running node model.nyc_mobility_project.high_value_customers
[0m03:00:04.129151 [info ] [Thread-1 (]: 2 of 3 SKIP relation public.high_value_customers ............................... [[33mSKIP[0m]
[0m03:00:04.132135 [debug] [Thread-1 (]: Finished running node model.nyc_mobility_project.high_value_customers
[0m03:00:04.138236 [debug] [Thread-1 (]: Began running node model.nyc_mobility_project.trip_summary_per_hour
[0m03:00:04.140926 [info ] [Thread-1 (]: 3 of 3 SKIP relation public.trip_summary_per_hour .............................. [[33mSKIP[0m]
[0m03:00:04.143047 [debug] [Thread-1 (]: Finished running node model.nyc_mobility_project.trip_summary_per_hour
[0m03:00:04.146467 [debug] [MainThread]: Using postgres connection "master"
[0m03:00:04.149791 [debug] [MainThread]: On master: BEGIN
[0m03:00:04.153022 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:00:04.159731 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m03:00:04.161823 [debug] [MainThread]: On master: COMMIT
[0m03:00:04.163975 [debug] [MainThread]: Using postgres connection "master"
[0m03:00:04.168158 [debug] [MainThread]: On master: COMMIT
[0m03:00:04.170424 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:00:04.172111 [debug] [MainThread]: On master: Close
[0m03:00:04.174190 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:00:04.176178 [debug] [MainThread]: Connection 'model.nyc_mobility_project.trip_enriched' was properly closed.
[0m03:00:04.178231 [info ] [MainThread]: 
[0m03:00:04.180169 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m03:00:04.183760 [debug] [MainThread]: Command end result
[0m03:00:04.251109 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m03:00:04.259830 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m03:00:04.283790 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m03:00:04.286107 [info ] [MainThread]: 
[0m03:00:04.288579 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m03:00:04.290769 [info ] [MainThread]: 
[0m03:00:04.293474 [error] [MainThread]:   Database Error in model trip_enriched (models/marts/trip_enriched.sql)
  relation "public.source_fact_taxi_trips" does not exist
  LINE 20: FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
                ^
  compiled code at target/run/nyc_mobility_project/models/marts/trip_enriched.sql
[0m03:00:04.296089 [info ] [MainThread]: 
[0m03:00:04.299828 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m03:00:04.303539 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.8572254, "process_in_blocks": "4000", "process_kernel_time": 0.333352, "process_mem_max_rss": "125388", "process_out_blocks": "0", "process_user_time": 5.414455}
[0m03:00:04.306176 [debug] [MainThread]: Command `dbt run` failed at 03:00:04.305845 after 3.86 seconds
[0m03:00:04.308369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc46debf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc44582b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcc424be4d0>]}
[0m03:00:04.310373 [debug] [MainThread]: Flushing usage events
[0m03:00:04.835893 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:05:08.928347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3608effa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe35f964bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe35f964c10>]}


============================== 03:05:08.936952 | b483104f-921d-441c-9653-25b1acd72e8e ==============================
[0m03:05:08.936952 [info ] [MainThread]: Running with dbt=1.9.4
[0m03:05:08.939281 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/opt/airflow/dbt_project', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select trip_enriched trip_summary_per_hour high_value_customers', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:05:09.076214 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m03:05:09.078199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b483104f-921d-441c-9653-25b1acd72e8e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe35fa1c790>]}
[0m03:05:09.080258 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m03:05:09.082314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b483104f-921d-441c-9653-25b1acd72e8e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe35fa1d090>]}
[0m03:05:09.302622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b483104f-921d-441c-9653-25b1acd72e8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe360844940>]}
[0m03:05:09.451123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b483104f-921d-441c-9653-25b1acd72e8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe362180b20>]}
[0m03:05:09.454594 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m03:05:09.629381 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m03:05:09.966674 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:05:09.968420 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:05:10.045672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b483104f-921d-441c-9653-25b1acd72e8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe35e1f67d0>]}
[0m03:05:10.239456 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m03:05:10.258228 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m03:05:10.289963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b483104f-921d-441c-9653-25b1acd72e8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe35dde9db0>]}
[0m03:05:10.292715 [info ] [MainThread]: Found 5 models, 2 sources, 433 macros
[0m03:05:10.295885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b483104f-921d-441c-9653-25b1acd72e8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe35dde9e10>]}
[0m03:05:10.301355 [info ] [MainThread]: 
[0m03:05:10.303461 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:05:10.305738 [info ] [MainThread]: 
[0m03:05:10.307950 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:05:10.317771 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nyc_dwh'
[0m03:05:10.445751 [debug] [ThreadPool]: Using postgres connection "list_nyc_dwh"
[0m03:05:10.447489 [debug] [ThreadPool]: On list_nyc_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "connection_name": "list_nyc_dwh"} */

    select distinct nspname from pg_namespace
  
[0m03:05:10.449183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:05:10.456795 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m03:05:10.460012 [debug] [ThreadPool]: On list_nyc_dwh: Close
[0m03:05:10.464522 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nyc_dwh, now list_nyc_dwh_public)
[0m03:05:10.478268 [debug] [ThreadPool]: Using postgres connection "list_nyc_dwh_public"
[0m03:05:10.488086 [debug] [ThreadPool]: On list_nyc_dwh_public: BEGIN
[0m03:05:10.492078 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:05:10.505941 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m03:05:10.508562 [debug] [ThreadPool]: Using postgres connection "list_nyc_dwh_public"
[0m03:05:10.511615 [debug] [ThreadPool]: On list_nyc_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "connection_name": "list_nyc_dwh_public"} */
select
      'nyc_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'nyc_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'nyc_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m03:05:10.520824 [debug] [ThreadPool]: SQL status: SELECT 46 in 0.007 seconds
[0m03:05:10.528518 [debug] [ThreadPool]: On list_nyc_dwh_public: ROLLBACK
[0m03:05:10.531176 [debug] [ThreadPool]: On list_nyc_dwh_public: Close
[0m03:05:10.562400 [debug] [MainThread]: Using postgres connection "master"
[0m03:05:10.564574 [debug] [MainThread]: On master: BEGIN
[0m03:05:10.566809 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:05:10.575256 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m03:05:10.577801 [debug] [MainThread]: Using postgres connection "master"
[0m03:05:10.580748 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:05:10.588657 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m03:05:10.592928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b483104f-921d-441c-9653-25b1acd72e8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3639dd5d0>]}
[0m03:05:10.595423 [debug] [MainThread]: On master: ROLLBACK
[0m03:05:10.598003 [debug] [MainThread]: Using postgres connection "master"
[0m03:05:10.600172 [debug] [MainThread]: On master: BEGIN
[0m03:05:10.603169 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m03:05:10.605702 [debug] [MainThread]: On master: COMMIT
[0m03:05:10.608032 [debug] [MainThread]: Using postgres connection "master"
[0m03:05:10.610706 [debug] [MainThread]: On master: COMMIT
[0m03:05:10.613101 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:05:10.615532 [debug] [MainThread]: On master: Close
[0m03:05:10.626656 [debug] [Thread-1 (]: Began running node model.nyc_mobility_project.trip_enriched
[0m03:05:10.632841 [info ] [Thread-1 (]: 1 of 3 START sql table model public.trip_enriched .............................. [RUN]
[0m03:05:10.636399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nyc_dwh_public, now model.nyc_mobility_project.trip_enriched)
[0m03:05:10.639809 [debug] [Thread-1 (]: Began compiling node model.nyc_mobility_project.trip_enriched
[0m03:05:10.675778 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_mobility_project.trip_enriched"
[0m03:05:10.684245 [debug] [Thread-1 (]: Began executing node model.nyc_mobility_project.trip_enriched
[0m03:05:10.814732 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_mobility_project.trip_enriched"
[0m03:05:10.829236 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_enriched"
[0m03:05:10.831604 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: BEGIN
[0m03:05:10.833582 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:05:10.840462 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m03:05:10.844171 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_enriched"
[0m03:05:10.847352 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.trip_enriched"} */

  
    

  create  table "nyc_dwh"."public"."trip_enriched__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    t.*,
    w.weather_category,
    w.temperature,
    w.humidity,
    w.wind_speed
FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
LEFT JOIN "nyc_dwh"."public"."source_dim_weather" w
  ON date_trunc('hour', t.tpep_pickup_datetime) = date_trunc('hour', w.event_time)
  );
  
[0m03:05:10.851055 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.source_fact_taxi_trips" does not exist
LINE 20: FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
              ^

[0m03:05:10.853707 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: ROLLBACK
[0m03:05:10.859036 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: Close
[0m03:05:10.866366 [debug] [Thread-1 (]: Database Error in model trip_enriched (models/marts/trip_enriched.sql)
  relation "public.source_fact_taxi_trips" does not exist
  LINE 20: FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
                ^
  compiled code at target/run/nyc_mobility_project/models/marts/trip_enriched.sql
[0m03:05:10.875932 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b483104f-921d-441c-9653-25b1acd72e8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe35dd77d60>]}
[0m03:05:10.879568 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model public.trip_enriched ..................... [[31mERROR[0m in 0.23s]
[0m03:05:10.882864 [debug] [Thread-1 (]: Finished running node model.nyc_mobility_project.trip_enriched
[0m03:05:10.885944 [debug] [Thread-4 (]: Marking all children of 'model.nyc_mobility_project.trip_enriched' to be skipped because of status 'error'.  Reason: Database Error in model trip_enriched (models/marts/trip_enriched.sql)
  relation "public.source_fact_taxi_trips" does not exist
  LINE 20: FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
                ^
  compiled code at target/run/nyc_mobility_project/models/marts/trip_enriched.sql.
[0m03:05:10.892122 [debug] [Thread-1 (]: Began running node model.nyc_mobility_project.high_value_customers
[0m03:05:10.894914 [info ] [Thread-1 (]: 2 of 3 SKIP relation public.high_value_customers ............................... [[33mSKIP[0m]
[0m03:05:10.897482 [debug] [Thread-1 (]: Finished running node model.nyc_mobility_project.high_value_customers
[0m03:05:10.900030 [debug] [Thread-1 (]: Began running node model.nyc_mobility_project.trip_summary_per_hour
[0m03:05:10.902503 [info ] [Thread-1 (]: 3 of 3 SKIP relation public.trip_summary_per_hour .............................. [[33mSKIP[0m]
[0m03:05:10.905474 [debug] [Thread-1 (]: Finished running node model.nyc_mobility_project.trip_summary_per_hour
[0m03:05:10.911712 [debug] [MainThread]: Using postgres connection "master"
[0m03:05:10.914098 [debug] [MainThread]: On master: BEGIN
[0m03:05:10.916138 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:05:10.928443 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m03:05:10.930955 [debug] [MainThread]: On master: COMMIT
[0m03:05:10.933454 [debug] [MainThread]: Using postgres connection "master"
[0m03:05:10.936217 [debug] [MainThread]: On master: COMMIT
[0m03:05:10.939712 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m03:05:10.945149 [debug] [MainThread]: On master: Close
[0m03:05:10.948580 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:05:10.951374 [debug] [MainThread]: Connection 'model.nyc_mobility_project.trip_enriched' was properly closed.
[0m03:05:10.953861 [info ] [MainThread]: 
[0m03:05:10.957076 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m03:05:10.961636 [debug] [MainThread]: Command end result
[0m03:05:11.069432 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m03:05:11.092917 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m03:05:11.131346 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m03:05:11.133800 [info ] [MainThread]: 
[0m03:05:11.137205 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m03:05:11.147460 [info ] [MainThread]: 
[0m03:05:11.150653 [error] [MainThread]:   Database Error in model trip_enriched (models/marts/trip_enriched.sql)
  relation "public.source_fact_taxi_trips" does not exist
  LINE 20: FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
                ^
  compiled code at target/run/nyc_mobility_project/models/marts/trip_enriched.sql
[0m03:05:11.154258 [info ] [MainThread]: 
[0m03:05:11.160348 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m03:05:11.164978 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.3763835, "process_in_blocks": "0", "process_kernel_time": 0.22972, "process_mem_max_rss": "121456", "process_out_blocks": "0", "process_user_time": 4.204875}
[0m03:05:11.167737 [debug] [MainThread]: Command `dbt run` failed at 03:05:11.167403 after 2.38 seconds
[0m03:05:11.170633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3608effa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe360889570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe35fb150c0>]}
[0m03:05:11.177157 [debug] [MainThread]: Flushing usage events
[0m03:05:11.811613 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:13:26.157640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e3bb57f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e3ae6b940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e3ae6b910>]}


============================== 03:13:26.168250 | 067099ce-b9a0-45e6-98a2-a0485668677d ==============================
[0m03:13:26.168250 [info ] [MainThread]: Running with dbt=1.9.4
[0m03:13:26.170921 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select trip_enriched trip_summary_per_hour high_value_customers', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m03:13:26.320521 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m03:13:26.322599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '067099ce-b9a0-45e6-98a2-a0485668677d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e3ae69e70>]}
[0m03:13:26.324706 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m03:13:26.326682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '067099ce-b9a0-45e6-98a2-a0485668677d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e3ae6a8c0>]}
[0m03:13:26.585178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '067099ce-b9a0-45e6-98a2-a0485668677d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e3ae68a00>]}
[0m03:13:26.682185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '067099ce-b9a0-45e6-98a2-a0485668677d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e3ae71840>]}
[0m03:13:26.684420 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m03:13:26.837428 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m03:13:27.163877 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:13:27.165639 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:13:27.239050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '067099ce-b9a0-45e6-98a2-a0485668677d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e38fac130>]}
[0m03:13:27.404961 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m03:13:27.423417 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m03:13:27.453564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '067099ce-b9a0-45e6-98a2-a0485668677d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e38ff5fc0>]}
[0m03:13:27.455737 [info ] [MainThread]: Found 5 models, 2 sources, 433 macros
[0m03:13:27.457670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '067099ce-b9a0-45e6-98a2-a0485668677d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e38ff6020>]}
[0m03:13:27.461596 [info ] [MainThread]: 
[0m03:13:27.464186 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:13:27.465940 [info ] [MainThread]: 
[0m03:13:27.467985 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:13:27.476298 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nyc_dwh'
[0m03:13:27.603618 [debug] [ThreadPool]: Using postgres connection "list_nyc_dwh"
[0m03:13:27.605542 [debug] [ThreadPool]: On list_nyc_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "connection_name": "list_nyc_dwh"} */

    select distinct nspname from pg_namespace
  
[0m03:13:27.607274 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:13:27.615059 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.008 seconds
[0m03:13:27.618131 [debug] [ThreadPool]: On list_nyc_dwh: Close
[0m03:13:27.621865 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nyc_dwh, now list_nyc_dwh_public)
[0m03:13:27.635355 [debug] [ThreadPool]: Using postgres connection "list_nyc_dwh_public"
[0m03:13:27.637138 [debug] [ThreadPool]: On list_nyc_dwh_public: BEGIN
[0m03:13:27.638794 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:13:27.644291 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m03:13:27.647530 [debug] [ThreadPool]: Using postgres connection "list_nyc_dwh_public"
[0m03:13:27.649717 [debug] [ThreadPool]: On list_nyc_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "connection_name": "list_nyc_dwh_public"} */
select
      'nyc_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'nyc_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'nyc_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m03:13:27.655887 [debug] [ThreadPool]: SQL status: SELECT 46 in 0.004 seconds
[0m03:13:27.661137 [debug] [ThreadPool]: On list_nyc_dwh_public: ROLLBACK
[0m03:13:27.664192 [debug] [ThreadPool]: On list_nyc_dwh_public: Close
[0m03:13:27.689525 [debug] [MainThread]: Using postgres connection "master"
[0m03:13:27.691411 [debug] [MainThread]: On master: BEGIN
[0m03:13:27.693112 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:13:27.700918 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m03:13:27.703166 [debug] [MainThread]: Using postgres connection "master"
[0m03:13:27.705405 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:13:27.712092 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m03:13:27.717329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '067099ce-b9a0-45e6-98a2-a0485668677d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e393e7d90>]}
[0m03:13:27.719372 [debug] [MainThread]: On master: ROLLBACK
[0m03:13:27.721499 [debug] [MainThread]: Using postgres connection "master"
[0m03:13:27.723226 [debug] [MainThread]: On master: BEGIN
[0m03:13:27.725670 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m03:13:27.728700 [debug] [MainThread]: On master: COMMIT
[0m03:13:27.732742 [debug] [MainThread]: Using postgres connection "master"
[0m03:13:27.734475 [debug] [MainThread]: On master: COMMIT
[0m03:13:27.736747 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:13:27.738659 [debug] [MainThread]: On master: Close
[0m03:13:27.748930 [debug] [Thread-1 (]: Began running node model.nyc_mobility_project.trip_enriched
[0m03:13:27.751162 [info ] [Thread-1 (]: 1 of 3 START sql table model public.trip_enriched .............................. [RUN]
[0m03:13:27.753550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nyc_dwh_public, now model.nyc_mobility_project.trip_enriched)
[0m03:13:27.755411 [debug] [Thread-1 (]: Began compiling node model.nyc_mobility_project.trip_enriched
[0m03:13:27.774693 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_mobility_project.trip_enriched"
[0m03:13:27.785209 [debug] [Thread-1 (]: Began executing node model.nyc_mobility_project.trip_enriched
[0m03:13:27.865825 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_mobility_project.trip_enriched"
[0m03:13:27.874838 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_enriched"
[0m03:13:27.876762 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: BEGIN
[0m03:13:27.879213 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:13:27.885296 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m03:13:27.887763 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_enriched"
[0m03:13:27.891682 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.trip_enriched"} */

  
    

  create  table "nyc_dwh"."public"."trip_enriched__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    t.*,
    w.weather_category,
    w.temperature,
    w.humidity,
    w.wind_speed
FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
LEFT JOIN "nyc_dwh"."public"."source_dim_weather" w
  ON date_trunc('hour', t.tpep_pickup_datetime) = date_trunc('hour', w.event_time)
  );
  
[0m03:13:27.898905 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.source_fact_taxi_trips" does not exist
LINE 20: FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
              ^

[0m03:13:27.907510 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: ROLLBACK
[0m03:13:27.914310 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: Close
[0m03:13:27.937662 [debug] [Thread-1 (]: Database Error in model trip_enriched (models/marts/trip_enriched.sql)
  relation "public.source_fact_taxi_trips" does not exist
  LINE 20: FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
                ^
  compiled code at target/run/nyc_mobility_project/models/marts/trip_enriched.sql
[0m03:13:27.946918 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '067099ce-b9a0-45e6-98a2-a0485668677d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e3b828040>]}
[0m03:13:27.950366 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model public.trip_enriched ..................... [[31mERROR[0m in 0.19s]
[0m03:13:27.954842 [debug] [Thread-1 (]: Finished running node model.nyc_mobility_project.trip_enriched
[0m03:13:27.958128 [debug] [Thread-4 (]: Marking all children of 'model.nyc_mobility_project.trip_enriched' to be skipped because of status 'error'.  Reason: Database Error in model trip_enriched (models/marts/trip_enriched.sql)
  relation "public.source_fact_taxi_trips" does not exist
  LINE 20: FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
                ^
  compiled code at target/run/nyc_mobility_project/models/marts/trip_enriched.sql.
[0m03:13:27.968930 [debug] [Thread-1 (]: Began running node model.nyc_mobility_project.high_value_customers
[0m03:13:27.971919 [info ] [Thread-1 (]: 2 of 3 SKIP relation public.high_value_customers ............................... [[33mSKIP[0m]
[0m03:13:27.975103 [debug] [Thread-1 (]: Finished running node model.nyc_mobility_project.high_value_customers
[0m03:13:27.982282 [debug] [Thread-1 (]: Began running node model.nyc_mobility_project.trip_summary_per_hour
[0m03:13:27.985541 [info ] [Thread-1 (]: 3 of 3 SKIP relation public.trip_summary_per_hour .............................. [[33mSKIP[0m]
[0m03:13:27.997421 [debug] [Thread-1 (]: Finished running node model.nyc_mobility_project.trip_summary_per_hour
[0m03:13:28.008393 [debug] [MainThread]: Using postgres connection "master"
[0m03:13:28.014228 [debug] [MainThread]: On master: BEGIN
[0m03:13:28.022141 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:13:28.042831 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m03:13:28.047019 [debug] [MainThread]: On master: COMMIT
[0m03:13:28.051316 [debug] [MainThread]: Using postgres connection "master"
[0m03:13:28.054292 [debug] [MainThread]: On master: COMMIT
[0m03:13:28.066155 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m03:13:28.069173 [debug] [MainThread]: On master: Close
[0m03:13:28.071760 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:13:28.074122 [debug] [MainThread]: Connection 'model.nyc_mobility_project.trip_enriched' was properly closed.
[0m03:13:28.076533 [info ] [MainThread]: 
[0m03:13:28.085400 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m03:13:28.089839 [debug] [MainThread]: Command end result
[0m03:13:28.189358 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m03:13:28.203570 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m03:13:28.236894 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m03:13:28.239622 [info ] [MainThread]: 
[0m03:13:28.243143 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m03:13:28.250062 [info ] [MainThread]: 
[0m03:13:28.252882 [error] [MainThread]:   Database Error in model trip_enriched (models/marts/trip_enriched.sql)
  relation "public.source_fact_taxi_trips" does not exist
  LINE 20: FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
                ^
  compiled code at target/run/nyc_mobility_project/models/marts/trip_enriched.sql
[0m03:13:28.255641 [info ] [MainThread]: 
[0m03:13:28.258340 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m03:13:28.266779 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.297358, "process_in_blocks": "4808", "process_kernel_time": 0.259567, "process_mem_max_rss": "119324", "process_out_blocks": "496", "process_user_time": 3.983355}
[0m03:13:28.269896 [debug] [MainThread]: Command `dbt run` failed at 03:13:28.269577 after 2.30 seconds
[0m03:13:28.271970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e3bb57f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e3d068a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e3d068760>]}
[0m03:13:28.274350 [debug] [MainThread]: Flushing usage events
[0m03:13:28.800608 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:18:32.162497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ef9cc3ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ef9c5f340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ef8eeb010>]}


============================== 03:18:32.170622 | 424243b3-88b2-42cc-a8c6-806735468446 ==============================
[0m03:18:32.170622 [info ] [MainThread]: Running with dbt=1.9.4
[0m03:18:32.172687 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/opt/airflow/dbt_project', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select trip_enriched trip_summary_per_hour high_value_customers', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:18:32.319744 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m03:18:32.322106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '424243b3-88b2-42cc-a8c6-806735468446', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ef8df7c40>]}
[0m03:18:32.324342 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m03:18:32.327055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '424243b3-88b2-42cc-a8c6-806735468446', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ef8df6830>]}
[0m03:18:32.579840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '424243b3-88b2-42cc-a8c6-806735468446', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4efb8f3400>]}
[0m03:18:32.708348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '424243b3-88b2-42cc-a8c6-806735468446', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ef9c30f40>]}
[0m03:18:32.710921 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m03:18:33.073432 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m03:18:34.095579 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:18:34.097832 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:18:34.215659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '424243b3-88b2-42cc-a8c6-806735468446', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ef71a4130>]}
[0m03:18:34.664279 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m03:18:34.707727 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m03:18:34.792535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '424243b3-88b2-42cc-a8c6-806735468446', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ef71e94b0>]}
[0m03:18:34.795169 [info ] [MainThread]: Found 5 models, 2 sources, 433 macros
[0m03:18:34.797930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '424243b3-88b2-42cc-a8c6-806735468446', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ef71e9450>]}
[0m03:18:34.809650 [info ] [MainThread]: 
[0m03:18:34.812189 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:18:34.814936 [info ] [MainThread]: 
[0m03:18:34.817867 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m03:18:34.847828 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nyc_dwh'
[0m03:18:35.029199 [debug] [ThreadPool]: Using postgres connection "list_nyc_dwh"
[0m03:18:35.030964 [debug] [ThreadPool]: On list_nyc_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "connection_name": "list_nyc_dwh"} */

    select distinct nspname from pg_namespace
  
[0m03:18:35.032719 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:18:35.040075 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m03:18:35.043482 [debug] [ThreadPool]: On list_nyc_dwh: Close
[0m03:18:35.047787 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nyc_dwh, now list_nyc_dwh_public)
[0m03:18:35.061988 [debug] [ThreadPool]: Using postgres connection "list_nyc_dwh_public"
[0m03:18:35.064057 [debug] [ThreadPool]: On list_nyc_dwh_public: BEGIN
[0m03:18:35.066309 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m03:18:35.076508 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m03:18:35.096909 [debug] [ThreadPool]: Using postgres connection "list_nyc_dwh_public"
[0m03:18:35.105595 [debug] [ThreadPool]: On list_nyc_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "connection_name": "list_nyc_dwh_public"} */
select
      'nyc_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'nyc_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'nyc_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m03:18:35.115309 [debug] [ThreadPool]: SQL status: SELECT 46 in 0.005 seconds
[0m03:18:35.123055 [debug] [ThreadPool]: On list_nyc_dwh_public: ROLLBACK
[0m03:18:35.125529 [debug] [ThreadPool]: On list_nyc_dwh_public: Close
[0m03:18:35.162475 [debug] [MainThread]: Using postgres connection "master"
[0m03:18:35.164474 [debug] [MainThread]: On master: BEGIN
[0m03:18:35.174934 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:18:35.181621 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m03:18:35.184410 [debug] [MainThread]: Using postgres connection "master"
[0m03:18:35.187510 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m03:18:35.196465 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m03:18:35.201026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '424243b3-88b2-42cc-a8c6-806735468446', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ef75f5ab0>]}
[0m03:18:35.206328 [debug] [MainThread]: On master: ROLLBACK
[0m03:18:35.208859 [debug] [MainThread]: Using postgres connection "master"
[0m03:18:35.211055 [debug] [MainThread]: On master: BEGIN
[0m03:18:35.213863 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m03:18:35.222226 [debug] [MainThread]: On master: COMMIT
[0m03:18:35.224418 [debug] [MainThread]: Using postgres connection "master"
[0m03:18:35.226663 [debug] [MainThread]: On master: COMMIT
[0m03:18:35.229158 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:18:35.231359 [debug] [MainThread]: On master: Close
[0m03:18:35.248877 [debug] [Thread-1 (]: Began running node model.nyc_mobility_project.trip_enriched
[0m03:18:35.254701 [info ] [Thread-1 (]: 1 of 3 START sql table model public.trip_enriched .............................. [RUN]
[0m03:18:35.281345 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nyc_dwh_public, now model.nyc_mobility_project.trip_enriched)
[0m03:18:35.283627 [debug] [Thread-1 (]: Began compiling node model.nyc_mobility_project.trip_enriched
[0m03:18:35.315404 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_mobility_project.trip_enriched"
[0m03:18:35.328276 [debug] [Thread-1 (]: Began executing node model.nyc_mobility_project.trip_enriched
[0m03:18:35.506183 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_mobility_project.trip_enriched"
[0m03:18:35.518855 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_enriched"
[0m03:18:35.521461 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: BEGIN
[0m03:18:35.523904 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m03:18:35.539788 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m03:18:35.543975 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_enriched"
[0m03:18:35.553940 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.trip_enriched"} */

  
    

  create  table "nyc_dwh"."public"."trip_enriched__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    t.*,
    w.weather_category,
    w.temperature,
    w.humidity,
    w.wind_speed
FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
LEFT JOIN "nyc_dwh"."public"."source_dim_weather" w
  ON date_trunc('hour', t.tpep_pickup_datetime) = date_trunc('hour', w.event_time)
  );
  
[0m03:18:35.559567 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.source_fact_taxi_trips" does not exist
LINE 20: FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
              ^

[0m03:18:35.569148 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: ROLLBACK
[0m03:18:35.580198 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: Close
[0m03:18:35.591983 [debug] [Thread-1 (]: Database Error in model trip_enriched (models/marts/trip_enriched.sql)
  relation "public.source_fact_taxi_trips" does not exist
  LINE 20: FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
                ^
  compiled code at target/run/nyc_mobility_project/models/marts/trip_enriched.sql
[0m03:18:35.599074 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '424243b3-88b2-42cc-a8c6-806735468446', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ef7180250>]}
[0m03:18:35.605719 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model public.trip_enriched ..................... [[31mERROR[0m in 0.32s]
[0m03:18:35.610753 [debug] [Thread-1 (]: Finished running node model.nyc_mobility_project.trip_enriched
[0m03:18:35.613797 [debug] [Thread-4 (]: Marking all children of 'model.nyc_mobility_project.trip_enriched' to be skipped because of status 'error'.  Reason: Database Error in model trip_enriched (models/marts/trip_enriched.sql)
  relation "public.source_fact_taxi_trips" does not exist
  LINE 20: FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
                ^
  compiled code at target/run/nyc_mobility_project/models/marts/trip_enriched.sql.
[0m03:18:35.619305 [debug] [Thread-1 (]: Began running node model.nyc_mobility_project.high_value_customers
[0m03:18:35.623218 [info ] [Thread-1 (]: 2 of 3 SKIP relation public.high_value_customers ............................... [[33mSKIP[0m]
[0m03:18:35.626209 [debug] [Thread-1 (]: Finished running node model.nyc_mobility_project.high_value_customers
[0m03:18:35.628804 [debug] [Thread-1 (]: Began running node model.nyc_mobility_project.trip_summary_per_hour
[0m03:18:35.631180 [info ] [Thread-1 (]: 3 of 3 SKIP relation public.trip_summary_per_hour .............................. [[33mSKIP[0m]
[0m03:18:35.634885 [debug] [Thread-1 (]: Finished running node model.nyc_mobility_project.trip_summary_per_hour
[0m03:18:35.639071 [debug] [MainThread]: Using postgres connection "master"
[0m03:18:35.641186 [debug] [MainThread]: On master: BEGIN
[0m03:18:35.643247 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m03:18:35.650026 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m03:18:35.655259 [debug] [MainThread]: On master: COMMIT
[0m03:18:35.657553 [debug] [MainThread]: Using postgres connection "master"
[0m03:18:35.659732 [debug] [MainThread]: On master: COMMIT
[0m03:18:35.662497 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m03:18:35.665005 [debug] [MainThread]: On master: Close
[0m03:18:35.669656 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:18:35.672026 [debug] [MainThread]: Connection 'model.nyc_mobility_project.trip_enriched' was properly closed.
[0m03:18:35.674455 [info ] [MainThread]: 
[0m03:18:35.677013 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.86 seconds (0.86s).
[0m03:18:35.680636 [debug] [MainThread]: Command end result
[0m03:18:35.781111 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m03:18:35.790601 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m03:18:35.818845 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m03:18:35.822504 [info ] [MainThread]: 
[0m03:18:35.825114 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m03:18:35.827785 [info ] [MainThread]: 
[0m03:18:35.830540 [error] [MainThread]:   Database Error in model trip_enriched (models/marts/trip_enriched.sql)
  relation "public.source_fact_taxi_trips" does not exist
  LINE 20: FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
                ^
  compiled code at target/run/nyc_mobility_project/models/marts/trip_enriched.sql
[0m03:18:35.838565 [info ] [MainThread]: 
[0m03:18:35.842101 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m03:18:35.846946 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.7839618, "process_in_blocks": "0", "process_kernel_time": 0.333425, "process_mem_max_rss": "119256", "process_out_blocks": "0", "process_user_time": 4.900339}
[0m03:18:35.849481 [debug] [MainThread]: Command `dbt run` failed at 03:18:35.849123 after 3.79 seconds
[0m03:18:35.854675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ef9cc3ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4efcd7e950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ef7d68ca0>]}
[0m03:18:35.856975 [debug] [MainThread]: Flushing usage events
[0m03:18:36.353463 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:43:26.505201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff790c27f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff79000b940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff79000b910>]}


============================== 03:43:26.594481 | 15a45a23-88c1-4c08-91f2-549451640a6b ==============================
[0m03:43:26.594481 [info ] [MainThread]: Running with dbt=1.9.4
[0m03:43:26.598222 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select trip_enriched trip_summary_per_hour high_value_customers', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:43:26.851920 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m03:43:26.854682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '15a45a23-88c1-4c08-91f2-549451640a6b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff790009e70>]}
[0m03:43:26.857259 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m03:43:26.859977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '15a45a23-88c1-4c08-91f2-549451640a6b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff79000a8c0>]}
[0m03:43:27.290536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15a45a23-88c1-4c08-91f2-549451640a6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff790008a00>]}
[0m03:43:27.453876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '15a45a23-88c1-4c08-91f2-549451640a6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff790011840>]}
[0m03:43:27.549884 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m03:43:27.974540 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m03:43:28.751775 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:43:28.754497 [debug] [MainThread]: Partial parsing: updated file: nyc_mobility_project://models/marts/trip_enriched.sql
[0m03:43:29.292335 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.nyc_mobility_project.trip_enriched' (models/marts/trip_enriched.sql) depends on a node named 'fact_taxi_trips' in package or project 'nyc' which was not found
[0m03:43:29.294994 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.057581, "process_in_blocks": "25248", "process_kernel_time": 0.419197, "process_mem_max_rss": "111780", "process_out_blocks": "496", "process_user_time": 6.420881}
[0m03:43:29.297167 [debug] [MainThread]: Command `dbt run` failed at 03:43:29.296908 after 3.06 seconds
[0m03:43:29.299362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff790c27f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff790b9cd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff78e79fe80>]}
[0m03:43:29.301068 [debug] [MainThread]: Flushing usage events
[0m03:43:29.862393 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:48:35.855661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9f8623f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9f7674c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9f7674c70>]}


============================== 03:48:35.868840 | d1ade2cd-225b-4419-87a4-0770a74f7bc1 ==============================
[0m03:48:35.868840 [info ] [MainThread]: Running with dbt=1.9.4
[0m03:48:35.871480 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select trip_enriched trip_summary_per_hour high_value_customers', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m03:48:36.068625 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m03:48:36.071228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd1ade2cd-225b-4419-87a4-0770a74f7bc1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9f792f190>]}
[0m03:48:36.074092 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m03:48:36.076620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd1ade2cd-225b-4419-87a4-0770a74f7bc1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9f792c730>]}
[0m03:48:36.495805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1ade2cd-225b-4419-87a4-0770a74f7bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9fa0ffaf0>]}
[0m03:48:36.690477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1ade2cd-225b-4419-87a4-0770a74f7bc1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9f7758280>]}
[0m03:48:36.693268 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m03:48:37.053276 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m03:48:37.644462 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m03:48:37.647976 [debug] [MainThread]: Partial parsing: updated file: nyc_mobility_project://models/marts/trip_enriched.sql
[0m03:48:38.495448 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.nyc_mobility_project.trip_enriched' (models/marts/trip_enriched.sql) depends on a node named 'fact_taxi_trips' in package or project 'nyc' which was not found
[0m03:48:38.500105 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.8280098, "process_in_blocks": "0", "process_kernel_time": 0.421326, "process_mem_max_rss": "111964", "process_out_blocks": "0", "process_user_time": 6.319898}
[0m03:48:38.502835 [debug] [MainThread]: Command `dbt run` failed at 03:48:38.502457 after 2.83 seconds
[0m03:48:38.506071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9f8623f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9f65b3730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9f615feb0>]}
[0m03:48:38.508890 [debug] [MainThread]: Flushing usage events
[0m03:48:39.043119 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:09:06.363889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd02181bf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd020b2e560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd020b2f8e0>]}


============================== 04:09:06.378063 | b86a7b91-02ab-45f3-9dd2-ff029d5cd1e5 ==============================
[0m04:09:06.378063 [info ] [MainThread]: Running with dbt=1.9.4
[0m04:09:06.384065 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select trip_enriched trip_summary_per_hour high_value_customers', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:09:06.676556 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m04:09:06.681577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b86a7b91-02ab-45f3-9dd2-ff029d5cd1e5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd020b2dde0>]}
[0m04:09:06.684518 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m04:09:06.687829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b86a7b91-02ab-45f3-9dd2-ff029d5cd1e5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd020b2d1e0>]}
[0m04:09:06.707602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c161aff70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c15224be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c15224c40>]}


============================== 04:09:06.734619 | b0dc528d-0717-46d8-9df0-bc1d3af06561 ==============================
[0m04:09:06.734619 [info ] [MainThread]: Running with dbt=1.9.4
[0m04:09:06.738775 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select trip_enriched trip_summary_per_hour high_value_customers', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:09:07.081426 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m04:09:07.084077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b0dc528d-0717-46d8-9df0-bc1d3af06561', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c152e0760>]}
[0m04:09:07.086567 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m04:09:07.089507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b0dc528d-0717-46d8-9df0-bc1d3af06561', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c152e1090>]}
[0m04:09:07.219529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b86a7b91-02ab-45f3-9dd2-ff029d5cd1e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd020b2d540>]}
[0m04:09:07.519198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b86a7b91-02ab-45f3-9dd2-ff029d5cd1e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd022fc2e90>]}
[0m04:09:07.525506 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m04:09:07.751065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0dc528d-0717-46d8-9df0-bc1d3af06561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c1786f3a0>]}
[0m04:09:08.011358 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m04:09:08.172515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0dc528d-0717-46d8-9df0-bc1d3af06561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c14938280>]}
[0m04:09:08.175365 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m04:09:08.481353 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m04:09:08.746789 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:09:08.750806 [debug] [MainThread]: Partial parsing: updated file: nyc_mobility_project://models/marts/trip_enriched.sql
[0m04:09:09.517785 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:09:09.520619 [debug] [MainThread]: Partial parsing: updated file: nyc_mobility_project://models/marts/trip_enriched.sql
[0m04:09:09.682301 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.nyc_mobility_project.trip_enriched' (models/marts/trip_enriched.sql) depends on a node named 'fact_taxi_trips' in package or project 'nyc' which was not found
[0m04:09:09.686030 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.5809402, "process_in_blocks": "0", "process_kernel_time": 0.422691, "process_mem_max_rss": "111928", "process_out_blocks": "496", "process_user_time": 8.806066}
[0m04:09:09.688805 [debug] [MainThread]: Command `dbt run` failed at 04:09:09.688509 after 3.58 seconds
[0m04:09:09.691054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd02181bf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd01f3e5c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd01efa7e50>]}
[0m04:09:09.693435 [debug] [MainThread]: Flushing usage events
[0m04:09:10.235498 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.nyc_mobility_project.trip_enriched' (models/marts/trip_enriched.sql) depends on a node named 'fact_taxi_trips' in package or project 'nyc' which was not found
[0m04:09:10.243566 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.839487, "process_in_blocks": "0", "process_kernel_time": 0.689904, "process_mem_max_rss": "111848", "process_out_blocks": "0", "process_user_time": 8.458831}
[0m04:09:10.247038 [debug] [MainThread]: Command `dbt run` failed at 04:09:10.246477 after 3.84 seconds
[0m04:09:10.250266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c161aff70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c15226290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4c13df7340>]}
[0m04:09:10.253385 [debug] [MainThread]: Flushing usage events
[0m04:09:10.275106 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:09:10.765419 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:14:18.084699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed7087f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed61ccc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed61ccc70>]}


============================== 04:14:18.125434 | 66e3add7-ae6b-497b-b28d-d752490107cf ==============================
[0m04:14:18.125434 [info ] [MainThread]: Running with dbt=1.9.4
[0m04:14:18.138735 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select trip_enriched trip_summary_per_hour high_value_customers', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:14:18.498742 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m04:14:18.503207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '66e3add7-ae6b-497b-b28d-d752490107cf', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed6293190>]}
[0m04:14:18.506631 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m04:14:18.509310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '66e3add7-ae6b-497b-b28d-d752490107cf', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed6290730>]}
[0m04:14:19.033473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66e3add7-ae6b-497b-b28d-d752490107cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed876f3a0>]}
[0m04:14:19.295709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66e3add7-ae6b-497b-b28d-d752490107cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed6ff63e0>]}
[0m04:14:19.298810 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m04:14:19.561583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4378e1bf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4377e90c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4377e90c70>]}


============================== 04:14:19.580750 | 9672fd13-9336-49ed-bd46-22f112b6c359 ==============================
[0m04:14:19.580750 [info ] [MainThread]: Running with dbt=1.9.4
[0m04:14:19.584910 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select trip_enriched trip_summary_per_hour high_value_customers', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:14:19.640731 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m04:14:19.814028 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m04:14:19.820953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9672fd13-9336-49ed-bd46-22f112b6c359', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4377f4b190>]}
[0m04:14:19.826008 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m04:14:19.829983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9672fd13-9336-49ed-bd46-22f112b6c359', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4377f48730>]}
[0m04:14:20.331027 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:14:20.336263 [debug] [MainThread]: Partial parsing: updated file: nyc_mobility_project://models/marts/trip_enriched.sql
[0m04:14:20.348111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9672fd13-9336-49ed-bd46-22f112b6c359', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f437a8d3af0>]}
[0m04:14:20.628388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9672fd13-9336-49ed-bd46-22f112b6c359', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4377898280>]}
[0m04:14:20.633210 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m04:14:20.976967 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m04:14:21.174835 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.nyc_mobility_project.trip_enriched' (models/marts/trip_enriched.sql) depends on a node named 'fact_taxi_trips' in package or project 'nyc' which was not found
[0m04:14:21.182277 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.3893785, "process_in_blocks": "0", "process_kernel_time": 0.431063, "process_mem_max_rss": "111932", "process_out_blocks": "0", "process_user_time": 8.180191}
[0m04:14:21.186103 [debug] [MainThread]: Command `dbt run` failed at 04:14:21.185445 after 3.39 seconds
[0m04:14:21.190164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed7087f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed4b9d750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ed4743eb0>]}
[0m04:14:21.193519 [debug] [MainThread]: Flushing usage events
[0m04:14:21.773194 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:14:21.776424 [debug] [MainThread]: Partial parsing: updated file: nyc_mobility_project://models/marts/trip_enriched.sql
[0m04:14:21.896172 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m04:14:22.514408 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.nyc_mobility_project.trip_enriched' (models/marts/trip_enriched.sql) depends on a node named 'fact_taxi_trips' in package or project 'nyc' which was not found
[0m04:14:22.521763 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.2390218, "process_in_blocks": "0", "process_kernel_time": 0.498033, "process_mem_max_rss": "112108", "process_out_blocks": "0", "process_user_time": 7.988455}
[0m04:14:22.525366 [debug] [MainThread]: Command `dbt run` failed at 04:14:22.525066 after 3.24 seconds
[0m04:14:22.527725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4378e1bf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4376df7730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f437699feb0>]}
[0m04:14:22.530544 [debug] [MainThread]: Flushing usage events
[0m04:14:23.135176 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:19:56.702100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1dbc03f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1dafe6560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1dafe78e0>]}


============================== 05:19:56.816224 | cbc1257b-2d09-4d51-b9e9-1c8a8d438501 ==============================
[0m05:19:56.816224 [info ] [MainThread]: Running with dbt=1.9.4
[0m05:19:56.818779 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select trip_enriched trip_summary_per_hour high_value_customers', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:19:57.088551 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m05:19:57.096591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cbc1257b-2d09-4d51-b9e9-1c8a8d438501', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1dafe5de0>]}
[0m05:19:57.101402 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m05:19:57.107114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cbc1257b-2d09-4d51-b9e9-1c8a8d438501', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1dafe51e0>]}
[0m05:19:57.597788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cbc1257b-2d09-4d51-b9e9-1c8a8d438501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1dafe5540>]}
[0m05:19:57.805704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cbc1257b-2d09-4d51-b9e9-1c8a8d438501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1dd476e90>]}
[0m05:19:57.808589 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:19:58.103627 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m05:19:59.058131 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m05:19:59.061711 [debug] [MainThread]: Partial parsing: added file: nyc_mobility_project://models/staging/fact_taxi_trips.sql
[0m05:19:59.064132 [debug] [MainThread]: Partial parsing: updated file: nyc_mobility_project://models/marts/trip_enriched.sql
[0m05:19:59.752551 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.nyc_mobility_project.trip_enriched' (models/marts/trip_enriched.sql) depends on a node named 'fact_taxi_trips' in package or project 'nyc' which was not found
[0m05:19:59.757066 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.4162176, "process_in_blocks": "0", "process_kernel_time": 0.381459, "process_mem_max_rss": "113884", "process_out_blocks": "496", "process_user_time": 6.745803}
[0m05:19:59.760014 [debug] [MainThread]: Command `dbt run` failed at 05:19:59.759652 after 3.42 seconds
[0m05:19:59.762186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1dbc03f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1d9394ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1d9395390>]}
[0m05:19:59.764311 [debug] [MainThread]: Flushing usage events
[0m05:20:00.367511 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:25:06.890593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dd29eff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dd1994c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dd1994cd0>]}


============================== 05:25:06.903917 | 8c7eab29-d2bd-40d3-95b7-2197044f1bc3 ==============================
[0m05:25:06.903917 [info ] [MainThread]: Running with dbt=1.9.4
[0m05:25:06.905923 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select trip_enriched trip_summary_per_hour high_value_customers', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m05:25:07.089183 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m05:25:07.093946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8c7eab29-d2bd-40d3-95b7-2197044f1bc3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dd1a4c700>]}
[0m05:25:07.096256 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m05:25:07.098607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8c7eab29-d2bd-40d3-95b7-2197044f1bc3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dd1a4ce20>]}
[0m05:25:07.457061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c7eab29-d2bd-40d3-95b7-2197044f1bc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dd4543550>]}
[0m05:25:07.661136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c7eab29-d2bd-40d3-95b7-2197044f1bc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dd1998a60>]}
[0m05:25:07.663956 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m05:25:07.928389 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m05:25:08.430528 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m05:25:08.432867 [debug] [MainThread]: Partial parsing: added file: nyc_mobility_project://models/staging/fact_taxi_trips.sql
[0m05:25:08.435336 [debug] [MainThread]: Partial parsing: updated file: nyc_mobility_project://models/marts/trip_enriched.sql
[0m05:25:09.270638 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.nyc_mobility_project.trip_enriched' (models/marts/trip_enriched.sql) depends on a node named 'fact_taxi_trips' in package or project 'nyc' which was not found
[0m05:25:09.277441 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.5974302, "process_in_blocks": "0", "process_kernel_time": 0.310182, "process_mem_max_rss": "111940", "process_out_blocks": "0", "process_user_time": 6.063572}
[0m05:25:09.280511 [debug] [MainThread]: Command `dbt run` failed at 05:25:09.280128 after 2.60 seconds
[0m05:25:09.283043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dd29eff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dd019d360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7dd019cf10>]}
[0m05:25:09.285386 [debug] [MainThread]: Flushing usage events
[0m05:25:09.805418 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:17:34.391317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd01737ff70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0163e0be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0163e0c40>]}


============================== 09:17:34.405410 | 0dc74ff8-7d92-41bc-ac41-b0adc07601b9 ==============================
[0m09:17:34.405410 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:17:34.408759 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select trip_enriched trip_summary_per_hour high_value_customers', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:17:34.624719 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m09:17:34.627989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0dc74ff8-7d92-41bc-ac41-b0adc07601b9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0164a0760>]}
[0m09:17:34.630888 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m09:17:34.634078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0dc74ff8-7d92-41bc-ac41-b0adc07601b9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0164a1090>]}
[0m09:17:35.074676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0dc74ff8-7d92-41bc-ac41-b0adc07601b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd018a2f3a0>]}
[0m09:17:35.340522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0dc74ff8-7d92-41bc-ac41-b0adc07601b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd015b28280>]}
[0m09:17:35.345336 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:17:35.673600 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m09:17:36.558967 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m09:17:36.562210 [debug] [MainThread]: Partial parsing: added file: nyc_mobility_project://models/staging/fact_taxi_trips.sql
[0m09:17:36.566063 [debug] [MainThread]: Partial parsing: updated file: nyc_mobility_project://models/marts/trip_enriched.sql
[0m09:17:37.207940 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.nyc_mobility_project.trip_enriched' (models/marts/trip_enriched.sql) depends on a node named 'fact_taxi_trips' in package or project 'nyc' which was not found
[0m09:17:37.212953 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.1120324, "process_in_blocks": "6424", "process_kernel_time": 0.412261, "process_mem_max_rss": "112076", "process_out_blocks": "0", "process_user_time": 7.873187}
[0m09:17:37.215817 [debug] [MainThread]: Command `dbt run` failed at 09:17:37.215574 after 3.12 seconds
[0m09:17:37.217532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd01737ff70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd014b813c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd014b80f70>]}
[0m09:17:37.219125 [debug] [MainThread]: Flushing usage events
[0m09:17:37.707933 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:40:31.691250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0efa73f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0eee33940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0eee33910>]}


============================== 09:40:31.711699 | 5d755c39-7534-45c9-9412-9cde3d6a6628 ==============================
[0m09:40:31.711699 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:40:31.726588 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select trip_enriched trip_summary_per_hour high_value_customers', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:40:32.262917 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m09:40:32.277758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5d755c39-7534-45c9-9412-9cde3d6a6628', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0eee31e70>]}
[0m09:40:32.283169 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m09:40:32.287373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5d755c39-7534-45c9-9412-9cde3d6a6628', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0eee328c0>]}
[0m09:40:33.111091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d755c39-7534-45c9-9412-9cde3d6a6628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0eee30a00>]}
[0m09:40:33.467654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d755c39-7534-45c9-9412-9cde3d6a6628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0eee39840>]}
[0m09:40:33.480135 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:40:33.862051 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m09:40:34.431687 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m09:40:34.436570 [debug] [MainThread]: Partial parsing: added file: nyc_mobility_project://models/staging/fact_taxi_trips.sql
[0m09:40:34.441132 [debug] [MainThread]: Partial parsing: updated file: nyc_mobility_project://models/marts/trip_enriched.sql
[0m09:40:35.929006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d755c39-7534-45c9-9412-9cde3d6a6628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0ecbf80d0>]}
[0m09:40:37.192699 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m09:40:37.308779 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m09:40:37.465173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d755c39-7534-45c9-9412-9cde3d6a6628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0edf20bb0>]}
[0m09:40:37.472370 [info ] [MainThread]: Found 6 models, 2 sources, 433 macros
[0m09:40:37.475602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d755c39-7534-45c9-9412-9cde3d6a6628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0edf20ca0>]}
[0m09:40:37.490618 [info ] [MainThread]: 
[0m09:40:37.504160 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:40:37.507549 [info ] [MainThread]: 
[0m09:40:37.511529 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:40:37.538378 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nyc_dwh'
[0m09:40:37.764225 [debug] [ThreadPool]: Using postgres connection "list_nyc_dwh"
[0m09:40:37.770304 [debug] [ThreadPool]: On list_nyc_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "connection_name": "list_nyc_dwh"} */

    select distinct nspname from pg_namespace
  
[0m09:40:37.773977 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:40:37.786712 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.013 seconds
[0m09:40:37.790926 [debug] [ThreadPool]: On list_nyc_dwh: Close
[0m09:40:37.808351 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nyc_dwh_public'
[0m09:40:37.835454 [debug] [ThreadPool]: Using postgres connection "list_nyc_dwh_public"
[0m09:40:37.848743 [debug] [ThreadPool]: On list_nyc_dwh_public: BEGIN
[0m09:40:37.851151 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:40:37.868345 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m09:40:37.870615 [debug] [ThreadPool]: Using postgres connection "list_nyc_dwh_public"
[0m09:40:37.873212 [debug] [ThreadPool]: On list_nyc_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "connection_name": "list_nyc_dwh_public"} */
select
      'nyc_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'nyc_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'nyc_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:40:37.893828 [debug] [ThreadPool]: SQL status: SELECT 44 in 0.017 seconds
[0m09:40:37.900597 [debug] [ThreadPool]: On list_nyc_dwh_public: ROLLBACK
[0m09:40:37.908956 [debug] [ThreadPool]: On list_nyc_dwh_public: Close
[0m09:40:37.945850 [debug] [MainThread]: Using postgres connection "master"
[0m09:40:37.948415 [debug] [MainThread]: On master: BEGIN
[0m09:40:37.950966 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:40:37.960505 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m09:40:37.966119 [debug] [MainThread]: Using postgres connection "master"
[0m09:40:37.968765 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:40:37.977098 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m09:40:37.981607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d755c39-7534-45c9-9412-9cde3d6a6628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0ecfc0a90>]}
[0m09:40:37.998034 [debug] [MainThread]: On master: ROLLBACK
[0m09:40:38.000428 [debug] [MainThread]: Using postgres connection "master"
[0m09:40:38.002644 [debug] [MainThread]: On master: BEGIN
[0m09:40:38.012962 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:40:38.015513 [debug] [MainThread]: On master: COMMIT
[0m09:40:38.019297 [debug] [MainThread]: Using postgres connection "master"
[0m09:40:38.021997 [debug] [MainThread]: On master: COMMIT
[0m09:40:38.024472 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:40:38.027678 [debug] [MainThread]: On master: Close
[0m09:40:38.094946 [debug] [Thread-1 (]: Began running node model.nyc_mobility_project.trip_enriched
[0m09:40:38.097899 [info ] [Thread-1 (]: 1 of 3 START sql table model public.trip_enriched .............................. [RUN]
[0m09:40:38.100932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nyc_dwh_public, now model.nyc_mobility_project.trip_enriched)
[0m09:40:38.104549 [debug] [Thread-1 (]: Began compiling node model.nyc_mobility_project.trip_enriched
[0m09:40:38.151544 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_mobility_project.trip_enriched"
[0m09:40:38.176635 [debug] [Thread-1 (]: Began executing node model.nyc_mobility_project.trip_enriched
[0m09:40:38.359959 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_mobility_project.trip_enriched"
[0m09:40:38.378592 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_enriched"
[0m09:40:38.405636 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: BEGIN
[0m09:40:38.411242 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:40:38.431498 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m09:40:38.434228 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_enriched"
[0m09:40:38.437460 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.trip_enriched"} */

  
    

  create  table "nyc_dwh"."public"."trip_enriched__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    t.*,
    w.weather_category,
    w.temperature,
    w.humidity,
    w.wind_speed
FROM "nyc_dwh"."public"."fact_taxi_trips" t
LEFT JOIN "nyc_dwh"."public"."dim_weather" w
  ON date_trunc('hour', t.tpep_pickup_datetime) = date_trunc('hour', w.event_time)
  );
  
[0m09:44:06.193634 [debug] [Thread-1 (]: SQL status: SELECT 12267064 in 207.775 seconds
[0m09:44:06.227832 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_enriched"
[0m09:44:06.231842 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.trip_enriched"} */
alter table "nyc_dwh"."public"."trip_enriched__dbt_tmp" rename to "trip_enriched"
[0m09:44:06.235354 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:44:06.285660 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: COMMIT
[0m09:44:06.288810 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_enriched"
[0m09:44:06.290896 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: COMMIT
[0m09:44:06.294262 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:44:06.325915 [debug] [Thread-1 (]: Applying DROP to: "nyc_dwh"."public"."trip_enriched__dbt_backup"
[0m09:44:06.347815 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_enriched"
[0m09:44:06.350628 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.trip_enriched"} */
drop table if exists "nyc_dwh"."public"."trip_enriched__dbt_backup" cascade
[0m09:44:06.352956 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m09:44:06.360896 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: Close
[0m09:44:06.370835 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d755c39-7534-45c9-9412-9cde3d6a6628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0f16c7940>]}
[0m09:44:06.376232 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.trip_enriched ......................... [[32mSELECT 12267064[0m in 208.26s]
[0m09:44:06.381747 [debug] [Thread-1 (]: Finished running node model.nyc_mobility_project.trip_enriched
[0m09:44:06.386411 [debug] [Thread-1 (]: Began running node model.nyc_mobility_project.high_value_customers
[0m09:44:06.389103 [info ] [Thread-1 (]: 2 of 3 START sql table model public.high_value_customers ....................... [RUN]
[0m09:44:06.392339 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_mobility_project.trip_enriched, now model.nyc_mobility_project.high_value_customers)
[0m09:44:06.397335 [debug] [Thread-1 (]: Began compiling node model.nyc_mobility_project.high_value_customers
[0m09:44:06.407305 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_mobility_project.high_value_customers"
[0m09:44:06.431479 [debug] [Thread-1 (]: Began executing node model.nyc_mobility_project.high_value_customers
[0m09:44:06.459609 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_mobility_project.high_value_customers"
[0m09:44:06.476846 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.high_value_customers"
[0m09:44:06.482658 [debug] [Thread-1 (]: On model.nyc_mobility_project.high_value_customers: BEGIN
[0m09:44:06.485216 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:06.494651 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m09:44:06.498768 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.high_value_customers"
[0m09:44:06.501710 [debug] [Thread-1 (]: On model.nyc_mobility_project.high_value_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.high_value_customers"} */

  
    

  create  table "nyc_dwh"."public"."high_value_customers__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    passenger_count,
    COUNT(*) AS total_trips,
    SUM(fare_amount + tip_amount) AS total_spent,
    AVG(tip_percentage) AS avg_tip_percentage
FROM "nyc_dwh"."public"."trip_enriched"
WHERE passenger_count IS NOT NULL AND passenger_count > 0
GROUP BY passenger_count
HAVING COUNT(*) > 10 AND SUM(fare_amount + tip_amount) > 300
  );
  
[0m09:44:06.504747 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "passenger_count" does not exist
LINE 15:     passenger_count,
             ^

[0m09:44:06.506978 [debug] [Thread-1 (]: On model.nyc_mobility_project.high_value_customers: ROLLBACK
[0m09:44:06.509365 [debug] [Thread-1 (]: On model.nyc_mobility_project.high_value_customers: Close
[0m09:44:06.520405 [debug] [Thread-1 (]: Database Error in model high_value_customers (models/marts/high_value_customers.sql)
  column "passenger_count" does not exist
  LINE 15:     passenger_count,
               ^
  compiled code at target/run/nyc_mobility_project/models/marts/high_value_customers.sql
[0m09:44:06.523171 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d755c39-7534-45c9-9412-9cde3d6a6628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0efa08040>]}
[0m09:44:06.526717 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model public.high_value_customers .............. [[31mERROR[0m in 0.13s]
[0m09:44:06.531514 [debug] [Thread-1 (]: Finished running node model.nyc_mobility_project.high_value_customers
[0m09:44:06.534073 [debug] [Thread-1 (]: Began running node model.nyc_mobility_project.trip_summary_per_hour
[0m09:44:06.535913 [debug] [Thread-4 (]: Marking all children of 'model.nyc_mobility_project.high_value_customers' to be skipped because of status 'error'.  Reason: Database Error in model high_value_customers (models/marts/high_value_customers.sql)
  column "passenger_count" does not exist
  LINE 15:     passenger_count,
               ^
  compiled code at target/run/nyc_mobility_project/models/marts/high_value_customers.sql.
[0m09:44:06.538466 [info ] [Thread-1 (]: 3 of 3 START sql table model public.trip_summary_per_hour ...................... [RUN]
[0m09:44:06.544437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_mobility_project.high_value_customers, now model.nyc_mobility_project.trip_summary_per_hour)
[0m09:44:06.548148 [debug] [Thread-1 (]: Began compiling node model.nyc_mobility_project.trip_summary_per_hour
[0m09:44:06.559397 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_mobility_project.trip_summary_per_hour"
[0m09:44:06.572408 [debug] [Thread-1 (]: Began executing node model.nyc_mobility_project.trip_summary_per_hour
[0m09:44:06.616411 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_mobility_project.trip_summary_per_hour"
[0m09:44:06.646281 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_summary_per_hour"
[0m09:44:06.659243 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_summary_per_hour: BEGIN
[0m09:44:06.663813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:44:06.683157 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m09:44:06.686545 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_summary_per_hour"
[0m09:44:06.690368 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_summary_per_hour: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.trip_summary_per_hour"} */

  
    

  create  table "nyc_dwh"."public"."trip_summary_per_hour__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    date_trunc('hour', tpep_pickup_datetime) AS hour,
    weather_category,
    COUNT(*) AS trip_count,
    AVG(trip_duration_minutes) AS avg_duration,
    AVG(tip_percentage) AS avg_tip
FROM "nyc_dwh"."public"."trip_enriched"
GROUP BY hour, weather_category
  );
  
[0m09:44:48.215385 [debug] [Thread-1 (]: SQL status: SELECT 760 in 41.524 seconds
[0m09:44:48.223422 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_summary_per_hour"
[0m09:44:48.225519 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_summary_per_hour: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.trip_summary_per_hour"} */
alter table "nyc_dwh"."public"."trip_summary_per_hour__dbt_tmp" rename to "trip_summary_per_hour"
[0m09:44:48.228204 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:44:48.235475 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_summary_per_hour: COMMIT
[0m09:44:48.239361 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_summary_per_hour"
[0m09:44:48.242448 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_summary_per_hour: COMMIT
[0m09:45:29.736018 [debug] [Thread-1 (]: SQL status: COMMIT in 41.494 seconds
[0m09:45:29.750293 [debug] [Thread-1 (]: Applying DROP to: "nyc_dwh"."public"."trip_summary_per_hour__dbt_backup"
[0m09:45:29.768498 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_summary_per_hour"
[0m09:45:29.772964 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_summary_per_hour: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.trip_summary_per_hour"} */
drop table if exists "nyc_dwh"."public"."trip_summary_per_hour__dbt_backup" cascade
[0m09:45:29.777177 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m09:45:29.791976 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_summary_per_hour: Close
[0m09:45:29.797850 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d755c39-7534-45c9-9412-9cde3d6a6628', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0f16c7940>]}
[0m09:45:29.807978 [info ] [Thread-1 (]: 3 of 3 OK created sql table model public.trip_summary_per_hour ................. [[32mSELECT 760[0m in 83.25s]
[0m09:45:29.833279 [debug] [Thread-1 (]: Finished running node model.nyc_mobility_project.trip_summary_per_hour
[0m09:45:29.889325 [debug] [MainThread]: Using postgres connection "master"
[0m09:45:29.893862 [debug] [MainThread]: On master: BEGIN
[0m09:45:29.909029 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:45:29.926159 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m09:45:29.951108 [debug] [MainThread]: On master: COMMIT
[0m09:45:29.955399 [debug] [MainThread]: Using postgres connection "master"
[0m09:45:29.966247 [debug] [MainThread]: On master: COMMIT
[0m09:45:29.970035 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:45:29.972910 [debug] [MainThread]: On master: Close
[0m09:45:29.975861 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:45:29.980949 [debug] [MainThread]: Connection 'list_nyc_dwh' was properly closed.
[0m09:45:29.984606 [debug] [MainThread]: Connection 'model.nyc_mobility_project.trip_summary_per_hour' was properly closed.
[0m09:45:29.998081 [info ] [MainThread]: 
[0m09:45:30.001183 [info ] [MainThread]: Finished running 3 table models in 0 hours 4 minutes and 52.49 seconds (292.49s).
[0m09:45:30.010532 [debug] [MainThread]: Command end result
[0m09:45:30.211096 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m09:45:30.260893 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m09:45:30.305251 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m09:45:30.307378 [info ] [MainThread]: 
[0m09:45:30.310182 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:45:30.320785 [info ] [MainThread]: 
[0m09:45:30.324760 [error] [MainThread]:   Database Error in model high_value_customers (models/marts/high_value_customers.sql)
  column "passenger_count" does not exist
  LINE 15:     passenger_count,
               ^
  compiled code at target/run/nyc_mobility_project/models/marts/high_value_customers.sql
[0m09:45:30.334538 [info ] [MainThread]: 
[0m09:45:30.336728 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m09:45:30.388735 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 299.0512, "process_in_blocks": "3160", "process_kernel_time": 1.382492, "process_mem_max_rss": "122092", "process_out_blocks": "496", "process_user_time": 8.894357}
[0m09:45:30.393980 [debug] [MainThread]: Command `dbt run` failed at 09:45:30.393685 after 299.06 seconds
[0m09:45:30.400946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0efa73f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0eed12fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0ecf44e50>]}
[0m09:45:30.404190 [debug] [MainThread]: Flushing usage events
[0m09:45:31.218745 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:48:31.574362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c041cbf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c03170be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c03170c40>]}


============================== 09:48:31.600137 | d5e6a5fc-c477-4ef8-a163-dfb4a7d3e897 ==============================
[0m09:48:31.600137 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:48:31.604364 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/opt/airflow/dbt_project', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select trip_enriched trip_summary_per_hour high_value_customers', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:48:31.848119 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m09:48:31.850930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd5e6a5fc-c477-4ef8-a163-dfb4a7d3e897', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c0322c760>]}
[0m09:48:31.853344 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m09:48:31.855917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd5e6a5fc-c477-4ef8-a163-dfb4a7d3e897', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c0322d090>]}
[0m09:48:32.340133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5e6a5fc-c477-4ef8-a163-dfb4a7d3e897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c057af3a0>]}
[0m09:48:32.545168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5e6a5fc-c477-4ef8-a163-dfb4a7d3e897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c02540280>]}
[0m09:48:32.547770 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:48:32.861743 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m09:48:33.519567 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:48:33.521288 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:48:33.688845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd5e6a5fc-c477-4ef8-a163-dfb4a7d3e897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c019fd1b0>]}
[0m09:48:34.154347 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m09:48:34.177838 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m09:48:34.638968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5e6a5fc-c477-4ef8-a163-dfb4a7d3e897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c011624d0>]}
[0m09:48:34.641842 [info ] [MainThread]: Found 6 models, 2 sources, 433 macros
[0m09:48:34.645294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5e6a5fc-c477-4ef8-a163-dfb4a7d3e897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c01162740>]}
[0m09:48:34.654192 [info ] [MainThread]: 
[0m09:48:34.657979 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:48:34.661954 [info ] [MainThread]: 
[0m09:48:34.666860 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:48:34.684168 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nyc_dwh'
[0m09:48:34.857290 [debug] [ThreadPool]: Using postgres connection "list_nyc_dwh"
[0m09:48:34.858838 [debug] [ThreadPool]: On list_nyc_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "connection_name": "list_nyc_dwh"} */

    select distinct nspname from pg_namespace
  
[0m09:48:34.860902 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:48:34.884502 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.023 seconds
[0m09:48:34.891551 [debug] [ThreadPool]: On list_nyc_dwh: Close
[0m09:48:34.897418 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nyc_dwh, now list_nyc_dwh_public)
[0m09:48:34.913631 [debug] [ThreadPool]: Using postgres connection "list_nyc_dwh_public"
[0m09:48:34.915489 [debug] [ThreadPool]: On list_nyc_dwh_public: BEGIN
[0m09:48:34.917113 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:48:34.924438 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m09:48:34.926473 [debug] [ThreadPool]: Using postgres connection "list_nyc_dwh_public"
[0m09:48:34.928698 [debug] [ThreadPool]: On list_nyc_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "connection_name": "list_nyc_dwh_public"} */
select
      'nyc_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'nyc_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'nyc_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:48:34.940567 [debug] [ThreadPool]: SQL status: SELECT 46 in 0.010 seconds
[0m09:48:34.946810 [debug] [ThreadPool]: On list_nyc_dwh_public: ROLLBACK
[0m09:48:34.948607 [debug] [ThreadPool]: On list_nyc_dwh_public: Close
[0m09:48:34.985150 [debug] [MainThread]: Using postgres connection "master"
[0m09:48:34.986801 [debug] [MainThread]: On master: BEGIN
[0m09:48:34.988288 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:48:34.994960 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m09:48:34.997090 [debug] [MainThread]: Using postgres connection "master"
[0m09:48:34.999586 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:48:35.009083 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m09:48:35.013547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5e6a5fc-c477-4ef8-a163-dfb4a7d3e897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c025ffc40>]}
[0m09:48:35.016380 [debug] [MainThread]: On master: ROLLBACK
[0m09:48:35.018591 [debug] [MainThread]: Using postgres connection "master"
[0m09:48:35.020574 [debug] [MainThread]: On master: BEGIN
[0m09:48:35.023068 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:48:35.025084 [debug] [MainThread]: On master: COMMIT
[0m09:48:35.027052 [debug] [MainThread]: Using postgres connection "master"
[0m09:48:35.028956 [debug] [MainThread]: On master: COMMIT
[0m09:48:35.031289 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:48:35.033158 [debug] [MainThread]: On master: Close
[0m09:48:35.041399 [debug] [Thread-1 (]: Began running node model.nyc_mobility_project.trip_enriched
[0m09:48:35.043916 [info ] [Thread-1 (]: 1 of 3 START sql table model public.trip_enriched .............................. [RUN]
[0m09:48:35.046824 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nyc_dwh_public, now model.nyc_mobility_project.trip_enriched)
[0m09:48:35.049423 [debug] [Thread-1 (]: Began compiling node model.nyc_mobility_project.trip_enriched
[0m09:48:35.077759 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_mobility_project.trip_enriched"
[0m09:48:35.088453 [debug] [Thread-1 (]: Began executing node model.nyc_mobility_project.trip_enriched
[0m09:48:35.204836 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_mobility_project.trip_enriched"
[0m09:48:35.213896 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_enriched"
[0m09:48:35.215823 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: BEGIN
[0m09:48:35.218163 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:48:35.224871 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m09:48:35.227066 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_enriched"
[0m09:48:35.230697 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.trip_enriched"} */

  
    

  create  table "nyc_dwh"."public"."trip_enriched__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    t.*,
    w.weather_category,
    w.temperature,
    w.humidity,
    w.wind_speed
FROM "nyc_dwh"."public"."fact_taxi_trips" t
LEFT JOIN "nyc_dwh"."public"."dim_weather" w
  ON date_trunc('hour', t.tpep_pickup_datetime) = date_trunc('hour', w.event_time)
  );
  
[0m09:51:48.473284 [debug] [Thread-1 (]: SQL status: SELECT 15333830 in 195.865 seconds
[0m09:51:48.510708 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_enriched"
[0m09:51:48.516058 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.trip_enriched"} */
alter table "nyc_dwh"."public"."trip_enriched" rename to "trip_enriched__dbt_backup"
[0m09:51:48.573237 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.054 seconds
[0m09:51:48.585917 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_enriched"
[0m09:51:48.589063 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.trip_enriched"} */
alter table "nyc_dwh"."public"."trip_enriched__dbt_tmp" rename to "trip_enriched"
[0m09:51:48.592619 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:51:48.670431 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: COMMIT
[0m09:51:48.673419 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_enriched"
[0m09:51:48.676087 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: COMMIT
[0m09:51:48.688247 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m09:51:48.727380 [debug] [Thread-1 (]: Applying DROP to: "nyc_dwh"."public"."trip_enriched__dbt_backup"
[0m09:51:48.756431 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_enriched"
[0m09:51:48.762634 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.trip_enriched"} */
drop table if exists "nyc_dwh"."public"."trip_enriched__dbt_backup" cascade
[0m09:51:48.982842 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.216 seconds
[0m09:51:48.995986 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: Close
[0m09:51:49.008339 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5e6a5fc-c477-4ef8-a163-dfb4a7d3e897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c01546fe0>]}
[0m09:51:49.012852 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.trip_enriched ......................... [[32mSELECT 15333830[0m in 193.95s]
[0m09:51:49.018246 [debug] [Thread-1 (]: Finished running node model.nyc_mobility_project.trip_enriched
[0m09:51:49.022738 [debug] [Thread-1 (]: Began running node model.nyc_mobility_project.high_value_customers
[0m09:51:49.025964 [info ] [Thread-1 (]: 2 of 3 START sql table model public.high_value_customers ....................... [RUN]
[0m09:51:49.029015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_mobility_project.trip_enriched, now model.nyc_mobility_project.high_value_customers)
[0m09:51:49.032128 [debug] [Thread-1 (]: Began compiling node model.nyc_mobility_project.high_value_customers
[0m09:51:49.045944 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_mobility_project.high_value_customers"
[0m09:51:49.060255 [debug] [Thread-1 (]: Began executing node model.nyc_mobility_project.high_value_customers
[0m09:51:49.079990 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_mobility_project.high_value_customers"
[0m09:51:49.096554 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.high_value_customers"
[0m09:51:49.099356 [debug] [Thread-1 (]: On model.nyc_mobility_project.high_value_customers: BEGIN
[0m09:51:49.102132 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:51:49.112668 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m09:51:49.116473 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.high_value_customers"
[0m09:51:49.122073 [debug] [Thread-1 (]: On model.nyc_mobility_project.high_value_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.high_value_customers"} */

  
    

  create  table "nyc_dwh"."public"."high_value_customers__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    passenger_count,
    COUNT(*) AS total_trips,
    SUM(fare_amount + tip_amount) AS total_spent,
    AVG(tip_percentage) AS avg_tip_percentage
FROM "nyc_dwh"."public"."trip_enriched"
WHERE passenger_count IS NOT NULL AND passenger_count > 0
GROUP BY passenger_count
HAVING COUNT(*) > 10 AND SUM(fare_amount + tip_amount) > 300
  );
  
[0m09:51:49.128212 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "passenger_count" does not exist
LINE 15:     passenger_count,
             ^

[0m09:51:49.130511 [debug] [Thread-1 (]: On model.nyc_mobility_project.high_value_customers: ROLLBACK
[0m09:51:49.133795 [debug] [Thread-1 (]: On model.nyc_mobility_project.high_value_customers: Close
[0m09:51:49.157443 [debug] [Thread-1 (]: Database Error in model high_value_customers (models/marts/high_value_customers.sql)
  column "passenger_count" does not exist
  LINE 15:     passenger_count,
               ^
  compiled code at target/run/nyc_mobility_project/models/marts/high_value_customers.sql
[0m09:51:49.160839 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5e6a5fc-c477-4ef8-a163-dfb4a7d3e897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c01545ba0>]}
[0m09:51:49.164100 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model public.high_value_customers .............. [[31mERROR[0m in 0.13s]
[0m09:51:49.167520 [debug] [Thread-1 (]: Finished running node model.nyc_mobility_project.high_value_customers
[0m09:51:49.170370 [debug] [Thread-1 (]: Began running node model.nyc_mobility_project.trip_summary_per_hour
[0m09:51:49.172402 [debug] [Thread-4 (]: Marking all children of 'model.nyc_mobility_project.high_value_customers' to be skipped because of status 'error'.  Reason: Database Error in model high_value_customers (models/marts/high_value_customers.sql)
  column "passenger_count" does not exist
  LINE 15:     passenger_count,
               ^
  compiled code at target/run/nyc_mobility_project/models/marts/high_value_customers.sql.
[0m09:51:49.176809 [info ] [Thread-1 (]: 3 of 3 START sql table model public.trip_summary_per_hour ...................... [RUN]
[0m09:51:49.184931 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_mobility_project.high_value_customers, now model.nyc_mobility_project.trip_summary_per_hour)
[0m09:51:49.188568 [debug] [Thread-1 (]: Began compiling node model.nyc_mobility_project.trip_summary_per_hour
[0m09:51:49.208709 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_mobility_project.trip_summary_per_hour"
[0m09:51:49.229842 [debug] [Thread-1 (]: Began executing node model.nyc_mobility_project.trip_summary_per_hour
[0m09:51:49.254164 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_mobility_project.trip_summary_per_hour"
[0m09:51:49.271458 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_summary_per_hour"
[0m09:51:49.274747 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_summary_per_hour: BEGIN
[0m09:51:49.277546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:51:49.285950 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m09:51:49.292425 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_summary_per_hour"
[0m09:51:49.296219 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_summary_per_hour: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.trip_summary_per_hour"} */

  
    

  create  table "nyc_dwh"."public"."trip_summary_per_hour__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    date_trunc('hour', tpep_pickup_datetime) AS hour,
    weather_category,
    COUNT(*) AS trip_count,
    AVG(trip_duration_minutes) AS avg_duration,
    AVG(tip_percentage) AS avg_tip
FROM "nyc_dwh"."public"."trip_enriched"
GROUP BY hour, weather_category
  );
  
[0m09:52:06.288193 [debug] [Thread-1 (]: SQL status: SELECT 760 in 17.027 seconds
[0m09:52:06.300597 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_summary_per_hour"
[0m09:52:06.303545 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_summary_per_hour: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.trip_summary_per_hour"} */
alter table "nyc_dwh"."public"."trip_summary_per_hour" rename to "trip_summary_per_hour__dbt_backup"
[0m09:52:06.307100 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:52:06.322738 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_summary_per_hour"
[0m09:52:06.326842 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_summary_per_hour: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.trip_summary_per_hour"} */
alter table "nyc_dwh"."public"."trip_summary_per_hour__dbt_tmp" rename to "trip_summary_per_hour"
[0m09:52:06.332553 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:52:06.344106 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_summary_per_hour: COMMIT
[0m09:52:06.348677 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_summary_per_hour"
[0m09:52:06.351674 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_summary_per_hour: COMMIT
[0m09:52:06.356131 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:52:06.368665 [debug] [Thread-1 (]: Applying DROP to: "nyc_dwh"."public"."trip_summary_per_hour__dbt_backup"
[0m09:52:06.376623 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_summary_per_hour"
[0m09:52:06.382639 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_summary_per_hour: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.trip_summary_per_hour"} */
drop table if exists "nyc_dwh"."public"."trip_summary_per_hour__dbt_backup" cascade
[0m09:52:06.405420 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.011 seconds
[0m09:52:06.418443 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_summary_per_hour: Close
[0m09:52:06.436232 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5e6a5fc-c477-4ef8-a163-dfb4a7d3e897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c00241990>]}
[0m09:52:06.449931 [info ] [Thread-1 (]: 3 of 3 OK created sql table model public.trip_summary_per_hour ................. [[32mSELECT 760[0m in 17.25s]
[0m09:52:06.454452 [debug] [Thread-1 (]: Finished running node model.nyc_mobility_project.trip_summary_per_hour
[0m09:52:06.469394 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:06.478583 [debug] [MainThread]: On master: BEGIN
[0m09:52:06.481745 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:52:06.494758 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m09:52:06.497494 [debug] [MainThread]: On master: COMMIT
[0m09:52:06.500401 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:06.504303 [debug] [MainThread]: On master: COMMIT
[0m09:52:06.509746 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m09:52:06.513383 [debug] [MainThread]: On master: Close
[0m09:52:06.516489 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:52:06.520650 [debug] [MainThread]: Connection 'model.nyc_mobility_project.trip_summary_per_hour' was properly closed.
[0m09:52:06.523389 [info ] [MainThread]: 
[0m09:52:06.527514 [info ] [MainThread]: Finished running 3 table models in 0 hours 3 minutes and 31.86 seconds (211.86s).
[0m09:52:06.534585 [debug] [MainThread]: Command end result
[0m09:52:06.657765 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m09:52:06.670880 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m09:52:06.706296 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m09:52:06.708659 [info ] [MainThread]: 
[0m09:52:06.712288 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:52:06.716013 [info ] [MainThread]: 
[0m09:52:06.719598 [error] [MainThread]:   Database Error in model high_value_customers (models/marts/high_value_customers.sql)
  column "passenger_count" does not exist
  LINE 15:     passenger_count,
               ^
  compiled code at target/run/nyc_mobility_project/models/marts/high_value_customers.sql
[0m09:52:06.724038 [info ] [MainThread]: 
[0m09:52:06.729792 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m09:52:06.747133 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 218.02716, "process_in_blocks": "31384", "process_kernel_time": 0.463416, "process_mem_max_rss": "118936", "process_out_blocks": "0", "process_user_time": 6.980832}
[0m09:52:06.751056 [debug] [MainThread]: Command `dbt run` failed at 09:52:06.750497 after 218.03 seconds
[0m09:52:06.753965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c041cbf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c01161de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c01161570>]}
[0m09:52:06.758164 [debug] [MainThread]: Flushing usage events
[0m09:52:07.393698 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:57:17.228181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42235effa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4222650bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4222650c10>]}


============================== 09:57:17.253781 | 3e22cc08-ee77-47c2-a4f1-541e6ad00338 ==============================
[0m09:57:17.253781 [info ] [MainThread]: Running with dbt=1.9.4
[0m09:57:17.257015 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select trip_enriched trip_summary_per_hour high_value_customers', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:57:17.621941 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m09:57:17.625486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3e22cc08-ee77-47c2-a4f1-541e6ad00338', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4222710790>]}
[0m09:57:17.629068 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m09:57:17.637105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3e22cc08-ee77-47c2-a4f1-541e6ad00338', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4222711090>]}
[0m09:57:18.321440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e22cc08-ee77-47c2-a4f1-541e6ad00338', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42235473d0>]}
[0m09:57:18.712549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e22cc08-ee77-47c2-a4f1-541e6ad00338', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4224e80b20>]}
[0m09:57:18.724587 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:57:19.253723 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m09:57:20.418537 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:57:20.421631 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:57:20.655208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e22cc08-ee77-47c2-a4f1-541e6ad00338', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42211e0be0>]}
[0m09:57:21.489565 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m09:57:21.531576 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m09:57:21.740144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e22cc08-ee77-47c2-a4f1-541e6ad00338', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f422094a440>]}
[0m09:57:21.751288 [info ] [MainThread]: Found 6 models, 2 sources, 433 macros
[0m09:57:21.755247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e22cc08-ee77-47c2-a4f1-541e6ad00338', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f422094a6b0>]}
[0m09:57:21.769943 [info ] [MainThread]: 
[0m09:57:21.775401 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:57:21.783278 [info ] [MainThread]: 
[0m09:57:21.787483 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:57:21.833212 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nyc_dwh'
[0m09:57:22.173659 [debug] [ThreadPool]: Using postgres connection "list_nyc_dwh"
[0m09:57:22.184997 [debug] [ThreadPool]: On list_nyc_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "connection_name": "list_nyc_dwh"} */

    select distinct nspname from pg_namespace
  
[0m09:57:22.193523 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:57:22.215596 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.022 seconds
[0m09:57:22.235113 [debug] [ThreadPool]: On list_nyc_dwh: Close
[0m09:57:22.257944 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nyc_dwh, now list_nyc_dwh_public)
[0m09:57:22.316335 [debug] [ThreadPool]: Using postgres connection "list_nyc_dwh_public"
[0m09:57:22.325161 [debug] [ThreadPool]: On list_nyc_dwh_public: BEGIN
[0m09:57:22.335610 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:57:22.346297 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m09:57:22.354420 [debug] [ThreadPool]: Using postgres connection "list_nyc_dwh_public"
[0m09:57:22.372599 [debug] [ThreadPool]: On list_nyc_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "connection_name": "list_nyc_dwh_public"} */
select
      'nyc_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'nyc_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'nyc_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:57:22.409575 [debug] [ThreadPool]: SQL status: SELECT 46 in 0.015 seconds
[0m09:57:22.420813 [debug] [ThreadPool]: On list_nyc_dwh_public: ROLLBACK
[0m09:57:22.423388 [debug] [ThreadPool]: On list_nyc_dwh_public: Close
[0m09:57:22.475330 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:22.478250 [debug] [MainThread]: On master: BEGIN
[0m09:57:22.481572 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:57:22.490526 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m09:57:22.494759 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:22.499280 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:57:22.508323 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m09:57:22.518430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e22cc08-ee77-47c2-a4f1-541e6ad00338', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4224bce320>]}
[0m09:57:22.522376 [debug] [MainThread]: On master: ROLLBACK
[0m09:57:22.529804 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:22.532538 [debug] [MainThread]: On master: BEGIN
[0m09:57:22.536468 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:57:22.540527 [debug] [MainThread]: On master: COMMIT
[0m09:57:22.545249 [debug] [MainThread]: Using postgres connection "master"
[0m09:57:22.547697 [debug] [MainThread]: On master: COMMIT
[0m09:57:22.549981 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:57:22.552162 [debug] [MainThread]: On master: Close
[0m09:57:22.569249 [debug] [Thread-1 (]: Began running node model.nyc_mobility_project.trip_enriched
[0m09:57:22.572014 [info ] [Thread-1 (]: 1 of 3 START sql table model public.trip_enriched .............................. [RUN]
[0m09:57:22.575517 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nyc_dwh_public, now model.nyc_mobility_project.trip_enriched)
[0m09:57:22.579295 [debug] [Thread-1 (]: Began compiling node model.nyc_mobility_project.trip_enriched
[0m09:57:22.639560 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_mobility_project.trip_enriched"
[0m09:57:22.685877 [debug] [Thread-1 (]: Began executing node model.nyc_mobility_project.trip_enriched
[0m09:57:22.984156 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_mobility_project.trip_enriched"
[0m09:57:23.014255 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_enriched"
[0m09:57:23.016601 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: BEGIN
[0m09:57:23.019581 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:57:23.031015 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m09:57:23.034834 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_enriched"
[0m09:57:23.037434 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.trip_enriched"} */

  
    

  create  table "nyc_dwh"."public"."trip_enriched__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    t.*,
    w.weather_category,
    w.temperature,
    w.humidity,
    w.wind_speed
FROM "nyc_dwh"."public"."fact_taxi_trips" t
LEFT JOIN "nyc_dwh"."public"."dim_weather" w
  ON date_trunc('hour', t.tpep_pickup_datetime) = date_trunc('hour', w.event_time)
  );
  
[0m09:59:52.560574 [debug] [Thread-1 (]: SQL status: SELECT 15333830 in 149.535 seconds
[0m09:59:52.627849 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_enriched"
[0m09:59:52.634474 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.trip_enriched"} */
alter table "nyc_dwh"."public"."trip_enriched" rename to "trip_enriched__dbt_backup"
[0m09:59:52.639812 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:59:52.659970 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_enriched"
[0m09:59:52.663026 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.trip_enriched"} */
alter table "nyc_dwh"."public"."trip_enriched__dbt_tmp" rename to "trip_enriched"
[0m09:59:52.669959 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:59:52.758722 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: COMMIT
[0m09:59:52.761338 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_enriched"
[0m09:59:52.768841 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: COMMIT
[0m09:59:52.775532 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m09:59:52.798083 [debug] [Thread-1 (]: Applying DROP to: "nyc_dwh"."public"."trip_enriched__dbt_backup"
[0m09:59:52.813588 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_enriched"
[0m09:59:52.816589 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.trip_enriched"} */
drop table if exists "nyc_dwh"."public"."trip_enriched__dbt_backup" cascade
[0m09:59:53.136867 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.318 seconds
[0m09:59:53.144092 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: Close
[0m09:59:53.150412 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e22cc08-ee77-47c2-a4f1-541e6ad00338', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4220d2efb0>]}
[0m09:59:53.153812 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.trip_enriched ......................... [[32mSELECT 15333830[0m in 150.57s]
[0m09:59:53.160072 [debug] [Thread-1 (]: Finished running node model.nyc_mobility_project.trip_enriched
[0m09:59:53.165188 [debug] [Thread-1 (]: Began running node model.nyc_mobility_project.high_value_customers
[0m09:59:53.168516 [info ] [Thread-1 (]: 2 of 3 START sql table model public.high_value_customers ....................... [RUN]
[0m09:59:53.172370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_mobility_project.trip_enriched, now model.nyc_mobility_project.high_value_customers)
[0m09:59:53.176122 [debug] [Thread-1 (]: Began compiling node model.nyc_mobility_project.high_value_customers
[0m09:59:53.185970 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_mobility_project.high_value_customers"
[0m09:59:53.198196 [debug] [Thread-1 (]: Began executing node model.nyc_mobility_project.high_value_customers
[0m09:59:53.216134 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_mobility_project.high_value_customers"
[0m09:59:53.230921 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.high_value_customers"
[0m09:59:53.233656 [debug] [Thread-1 (]: On model.nyc_mobility_project.high_value_customers: BEGIN
[0m09:59:53.236262 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:59:53.245016 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m09:59:53.249679 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.high_value_customers"
[0m09:59:53.252948 [debug] [Thread-1 (]: On model.nyc_mobility_project.high_value_customers: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.high_value_customers"} */

  
    

  create  table "nyc_dwh"."public"."high_value_customers__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    passenger_count,
    COUNT(*) AS total_trips,
    SUM(fare_amount + tip_amount) AS total_spent,
    AVG(tip_percentage) AS avg_tip_percentage
FROM "nyc_dwh"."public"."trip_enriched"
WHERE passenger_count IS NOT NULL AND passenger_count > 0
GROUP BY passenger_count
HAVING COUNT(*) > 10 AND SUM(fare_amount + tip_amount) > 300
  );
  
[0m09:59:53.257632 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "passenger_count" does not exist
LINE 15:     passenger_count,
             ^

[0m09:59:53.260429 [debug] [Thread-1 (]: On model.nyc_mobility_project.high_value_customers: ROLLBACK
[0m09:59:53.264011 [debug] [Thread-1 (]: On model.nyc_mobility_project.high_value_customers: Close
[0m09:59:53.284643 [debug] [Thread-1 (]: Database Error in model high_value_customers (models/marts/high_value_customers.sql)
  column "passenger_count" does not exist
  LINE 15:     passenger_count,
               ^
  compiled code at target/run/nyc_mobility_project/models/marts/high_value_customers.sql
[0m09:59:53.286624 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e22cc08-ee77-47c2-a4f1-541e6ad00338', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4220d2d120>]}
[0m09:59:53.288775 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model public.high_value_customers .............. [[31mERROR[0m in 0.11s]
[0m09:59:53.291078 [debug] [Thread-1 (]: Finished running node model.nyc_mobility_project.high_value_customers
[0m09:59:53.293116 [debug] [Thread-1 (]: Began running node model.nyc_mobility_project.trip_summary_per_hour
[0m09:59:53.295549 [debug] [Thread-4 (]: Marking all children of 'model.nyc_mobility_project.high_value_customers' to be skipped because of status 'error'.  Reason: Database Error in model high_value_customers (models/marts/high_value_customers.sql)
  column "passenger_count" does not exist
  LINE 15:     passenger_count,
               ^
  compiled code at target/run/nyc_mobility_project/models/marts/high_value_customers.sql.
[0m09:59:53.298423 [info ] [Thread-1 (]: 3 of 3 START sql table model public.trip_summary_per_hour ...................... [RUN]
[0m09:59:53.303881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_mobility_project.high_value_customers, now model.nyc_mobility_project.trip_summary_per_hour)
[0m09:59:53.306274 [debug] [Thread-1 (]: Began compiling node model.nyc_mobility_project.trip_summary_per_hour
[0m09:59:53.320571 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_mobility_project.trip_summary_per_hour"
[0m09:59:53.330415 [debug] [Thread-1 (]: Began executing node model.nyc_mobility_project.trip_summary_per_hour
[0m09:59:53.346270 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_mobility_project.trip_summary_per_hour"
[0m09:59:53.360089 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_summary_per_hour"
[0m09:59:53.361805 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_summary_per_hour: BEGIN
[0m09:59:53.363657 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:59:53.371240 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m09:59:53.373721 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_summary_per_hour"
[0m09:59:53.376024 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_summary_per_hour: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.trip_summary_per_hour"} */

  
    

  create  table "nyc_dwh"."public"."trip_summary_per_hour__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    date_trunc('hour', tpep_pickup_datetime) AS hour,
    weather_category,
    COUNT(*) AS trip_count,
    AVG(trip_duration_minutes) AS avg_duration,
    AVG(tip_percentage) AS avg_tip
FROM "nyc_dwh"."public"."trip_enriched"
GROUP BY hour, weather_category
  );
  
[0m10:01:14.075108 [debug] [Thread-1 (]: SQL status: SELECT 760 in 80.702 seconds
[0m10:01:14.089155 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_summary_per_hour"
[0m10:01:14.091761 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_summary_per_hour: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.trip_summary_per_hour"} */
alter table "nyc_dwh"."public"."trip_summary_per_hour" rename to "trip_summary_per_hour__dbt_backup"
[0m10:01:14.095220 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:01:14.109098 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_summary_per_hour"
[0m10:01:14.111897 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_summary_per_hour: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.trip_summary_per_hour"} */
alter table "nyc_dwh"."public"."trip_summary_per_hour__dbt_tmp" rename to "trip_summary_per_hour"
[0m10:01:14.114887 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:01:14.121921 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_summary_per_hour: COMMIT
[0m10:01:14.125125 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_summary_per_hour"
[0m10:01:14.127266 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_summary_per_hour: COMMIT
[0m10:01:14.131980 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m10:01:14.140008 [debug] [Thread-1 (]: Applying DROP to: "nyc_dwh"."public"."trip_summary_per_hour__dbt_backup"
[0m10:01:14.145200 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_summary_per_hour"
[0m10:01:14.148468 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_summary_per_hour: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.trip_summary_per_hour"} */
drop table if exists "nyc_dwh"."public"."trip_summary_per_hour__dbt_backup" cascade
[0m10:01:14.156956 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m10:01:14.162435 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_summary_per_hour: Close
[0m10:01:14.166058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e22cc08-ee77-47c2-a4f1-541e6ad00338', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f421f7359c0>]}
[0m10:01:14.169498 [info ] [Thread-1 (]: 3 of 3 OK created sql table model public.trip_summary_per_hour ................. [[32mSELECT 760[0m in 80.86s]
[0m10:01:14.177043 [debug] [Thread-1 (]: Finished running node model.nyc_mobility_project.trip_summary_per_hour
[0m10:01:14.182425 [debug] [MainThread]: Using postgres connection "master"
[0m10:01:14.185125 [debug] [MainThread]: On master: BEGIN
[0m10:01:14.187360 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:01:14.194806 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m10:01:14.196849 [debug] [MainThread]: On master: COMMIT
[0m10:01:14.199056 [debug] [MainThread]: Using postgres connection "master"
[0m10:01:14.201685 [debug] [MainThread]: On master: COMMIT
[0m10:01:14.204534 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:01:14.207028 [debug] [MainThread]: On master: Close
[0m10:01:14.210232 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:01:14.212565 [debug] [MainThread]: Connection 'model.nyc_mobility_project.trip_summary_per_hour' was properly closed.
[0m10:01:14.215504 [info ] [MainThread]: 
[0m10:01:14.218256 [info ] [MainThread]: Finished running 3 table models in 0 hours 3 minutes and 52.43 seconds (232.43s).
[0m10:01:14.223398 [debug] [MainThread]: Command end result
[0m10:01:14.317007 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m10:01:14.328041 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m10:01:14.363848 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m10:01:14.368070 [info ] [MainThread]: 
[0m10:01:14.373678 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:01:14.376311 [info ] [MainThread]: 
[0m10:01:14.379373 [error] [MainThread]:   Database Error in model high_value_customers (models/marts/high_value_customers.sql)
  column "passenger_count" does not exist
  LINE 15:     passenger_count,
               ^
  compiled code at target/run/nyc_mobility_project/models/marts/high_value_customers.sql
[0m10:01:14.381848 [info ] [MainThread]: 
[0m10:01:14.384641 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m10:01:14.393231 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 237.51143, "process_in_blocks": "27896", "process_kernel_time": 0.655149, "process_mem_max_rss": "118112", "process_out_blocks": "0", "process_user_time": 10.323575}
[0m10:01:14.398243 [debug] [MainThread]: Command `dbt run` failed at 10:01:14.397829 after 237.52 seconds
[0m10:01:14.402345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42235effa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4220d27100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42235892d0>]}
[0m10:01:14.405819 [debug] [MainThread]: Flushing usage events
[0m10:01:14.954859 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:28:15.903127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96e9513fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96e88ef640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96e88ef5e0>]}


============================== 14:28:15.939622 | 110fb2ca-2f4a-4f56-b34c-ffd1e97698a0 ==============================
[0m14:28:15.939622 [info ] [MainThread]: Running with dbt=1.9.4
[0m14:28:15.956501 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/opt/airflow/dbt_project', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select trip_enriched trip_summary_per_hour high_value_customers source_dim_weather', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:28:16.817121 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m14:28:16.832327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '110fb2ca-2f4a-4f56-b34c-ffd1e97698a0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96e88ed270>]}
[0m14:28:16.835876 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m14:28:16.858924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '110fb2ca-2f4a-4f56-b34c-ffd1e97698a0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96e88ee950>]}
[0m14:28:18.361263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '110fb2ca-2f4a-4f56-b34c-ffd1e97698a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96e87655a0>]}
[0m14:28:19.117765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '110fb2ca-2f4a-4f56-b34c-ffd1e97698a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96e94868f0>]}
[0m14:28:19.146892 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:28:20.304034 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m14:28:22.650301 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m14:28:22.665733 [debug] [MainThread]: Partial parsing: updated file: nyc_mobility_project://models/marts/trip_enriched.sql
[0m14:28:22.685434 [debug] [MainThread]: Partial parsing: updated file: nyc_mobility_project://models/marts/high_value_customers.sql
[0m14:28:25.290435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '110fb2ca-2f4a-4f56-b34c-ffd1e97698a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96e65440d0>]}
[0m14:28:26.677569 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m14:28:26.777949 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m14:28:27.095607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '110fb2ca-2f4a-4f56-b34c-ffd1e97698a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96e6df50c0>]}
[0m14:28:27.109046 [info ] [MainThread]: Found 6 models, 2 sources, 433 macros
[0m14:28:27.117278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '110fb2ca-2f4a-4f56-b34c-ffd1e97698a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96e65a8040>]}
[0m14:28:27.134497 [info ] [MainThread]: 
[0m14:28:27.153314 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:28:27.164608 [info ] [MainThread]: 
[0m14:28:27.177729 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:28:27.257506 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nyc_dwh'
[0m14:28:27.474806 [debug] [ThreadPool]: Using postgres connection "list_nyc_dwh"
[0m14:28:27.482772 [debug] [ThreadPool]: On list_nyc_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "connection_name": "list_nyc_dwh"} */

    select distinct nspname from pg_namespace
  
[0m14:28:27.496529 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:28:27.538468 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.041 seconds
[0m14:28:27.558682 [debug] [ThreadPool]: On list_nyc_dwh: Close
[0m14:28:27.580556 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nyc_dwh, now list_nyc_dwh_public)
[0m14:28:27.640653 [debug] [ThreadPool]: Using postgres connection "list_nyc_dwh_public"
[0m14:28:27.668149 [debug] [ThreadPool]: On list_nyc_dwh_public: BEGIN
[0m14:28:27.672714 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:28:27.701679 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m14:28:27.708002 [debug] [ThreadPool]: Using postgres connection "list_nyc_dwh_public"
[0m14:28:27.721269 [debug] [ThreadPool]: On list_nyc_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "connection_name": "list_nyc_dwh_public"} */
select
      'nyc_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'nyc_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'nyc_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:28:27.762018 [debug] [ThreadPool]: SQL status: SELECT 46 in 0.034 seconds
[0m14:28:27.770328 [debug] [ThreadPool]: On list_nyc_dwh_public: ROLLBACK
[0m14:28:27.800622 [debug] [ThreadPool]: On list_nyc_dwh_public: Close
[0m14:28:27.898826 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:27.908347 [debug] [MainThread]: On master: BEGIN
[0m14:28:27.921051 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:28:27.956945 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m14:28:27.974047 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:27.985111 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:28:28.031412 [debug] [MainThread]: SQL status: SELECT 0 in 0.023 seconds
[0m14:28:28.036229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '110fb2ca-2f4a-4f56-b34c-ffd1e97698a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96e650bb50>]}
[0m14:28:28.051280 [debug] [MainThread]: On master: ROLLBACK
[0m14:28:28.056064 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:28.113161 [debug] [MainThread]: On master: BEGIN
[0m14:28:28.137514 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:28:28.140257 [debug] [MainThread]: On master: COMMIT
[0m14:28:28.150177 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:28.174887 [debug] [MainThread]: On master: COMMIT
[0m14:28:28.189367 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:28:28.192014 [debug] [MainThread]: On master: Close
[0m14:28:28.250386 [debug] [Thread-1 (]: Began running node model.nyc_mobility_project.source_dim_weather
[0m14:28:28.255306 [info ] [Thread-1 (]: 1 of 4 START sql view model public.source_dim_weather .......................... [RUN]
[0m14:28:28.271573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nyc_dwh_public, now model.nyc_mobility_project.source_dim_weather)
[0m14:28:28.280288 [debug] [Thread-1 (]: Began compiling node model.nyc_mobility_project.source_dim_weather
[0m14:28:28.405457 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_mobility_project.source_dim_weather"
[0m14:28:28.496328 [debug] [Thread-1 (]: Began executing node model.nyc_mobility_project.source_dim_weather
[0m14:28:28.698499 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_mobility_project.source_dim_weather"
[0m14:28:28.819247 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.source_dim_weather"
[0m14:28:28.828653 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: BEGIN
[0m14:28:28.843849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:28.859225 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m14:28:28.901162 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.source_dim_weather"
[0m14:28:28.907326 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.source_dim_weather"} */

  create view "nyc_dwh"."public"."source_dim_weather__dbt_tmp"
    
    
  as (
    

SELECT * FROM "nyc_dwh"."public"."dim_weather"
  );
[0m14:28:29.075883 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.165 seconds
[0m14:28:29.167394 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.source_dim_weather"
[0m14:28:29.199732 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.source_dim_weather"} */
alter table "nyc_dwh"."public"."source_dim_weather__dbt_tmp" rename to "source_dim_weather"
[0m14:28:29.213662 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m14:28:29.398772 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: COMMIT
[0m14:28:29.412257 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.source_dim_weather"
[0m14:28:29.426690 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: COMMIT
[0m14:28:29.448580 [debug] [Thread-1 (]: SQL status: COMMIT in 0.016 seconds
[0m14:28:29.526276 [debug] [Thread-1 (]: Applying DROP to: "nyc_dwh"."public"."source_dim_weather__dbt_backup"
[0m14:28:29.566409 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.source_dim_weather"
[0m14:28:29.582628 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.source_dim_weather"} */
drop view if exists "nyc_dwh"."public"."source_dim_weather__dbt_backup" cascade
[0m14:28:29.604249 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:28:29.626465 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: Close
[0m14:28:29.749002 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '110fb2ca-2f4a-4f56-b34c-ffd1e97698a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96e6d2ca30>]}
[0m14:28:29.769685 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.source_dim_weather ..................... [[32mCREATE VIEW[0m in 1.42s]
[0m14:28:29.782448 [debug] [Thread-1 (]: Finished running node model.nyc_mobility_project.source_dim_weather
[0m14:28:29.805603 [debug] [Thread-1 (]: Began running node model.nyc_mobility_project.trip_enriched
[0m14:28:29.808834 [info ] [Thread-1 (]: 2 of 4 START sql table model public.trip_enriched .............................. [RUN]
[0m14:28:29.812552 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_mobility_project.source_dim_weather, now model.nyc_mobility_project.trip_enriched)
[0m14:28:29.818686 [debug] [Thread-1 (]: Began compiling node model.nyc_mobility_project.trip_enriched
[0m14:28:29.859745 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_mobility_project.trip_enriched"
[0m14:28:29.896518 [debug] [Thread-1 (]: Began executing node model.nyc_mobility_project.trip_enriched
[0m14:28:30.191943 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_mobility_project.trip_enriched"
[0m14:28:30.242239 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_enriched"
[0m14:28:30.244802 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: BEGIN
[0m14:28:30.253583 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:28:30.266212 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m14:28:30.281224 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_enriched"
[0m14:28:30.307170 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.trip_enriched"} */

  
    

  create  table "nyc_dwh"."public"."trip_enriched__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    t.passenger_count,
    t.trip_distance,
    t.tpep_pickup_datetime,
    t.tpep_dropoff_datetime,
    t.payment_type,
    t.fare_amount,
    t.tip_amount,
    t.tip_percentage,
    t.distance_bucket,
    t.pickup_hour,
    t.pickup_day_of_week,
    w.weather_category,
    w.temperature,
    w.humidity,
    w.wind_speed
FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
LEFT JOIN "nyc_dwh"."public"."source_dim_weather" w
    ON date_trunc('hour', t.tpep_pickup_datetime) = date_trunc('hour', w.event_time)
  );
  
[0m14:28:30.323343 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.source_fact_taxi_trips" does not exist
LINE 30: FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
              ^

[0m14:28:30.328733 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: ROLLBACK
[0m14:28:30.352025 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: Close
[0m14:28:30.458550 [debug] [Thread-1 (]: Database Error in model trip_enriched (models/marts/trip_enriched.sql)
  relation "public.source_fact_taxi_trips" does not exist
  LINE 30: FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
                ^
  compiled code at target/run/nyc_mobility_project/models/marts/trip_enriched.sql
[0m14:28:30.497941 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '110fb2ca-2f4a-4f56-b34c-ffd1e97698a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96e9709750>]}
[0m14:28:30.509596 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.trip_enriched ..................... [[31mERROR[0m in 0.65s]
[0m14:28:30.544283 [debug] [Thread-1 (]: Finished running node model.nyc_mobility_project.trip_enriched
[0m14:28:30.565997 [debug] [Thread-4 (]: Marking all children of 'model.nyc_mobility_project.trip_enriched' to be skipped because of status 'error'.  Reason: Database Error in model trip_enriched (models/marts/trip_enriched.sql)
  relation "public.source_fact_taxi_trips" does not exist
  LINE 30: FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
                ^
  compiled code at target/run/nyc_mobility_project/models/marts/trip_enriched.sql.
[0m14:28:30.607434 [debug] [Thread-1 (]: Began running node model.nyc_mobility_project.high_value_customers
[0m14:28:30.623777 [info ] [Thread-1 (]: 3 of 4 SKIP relation public.high_value_customers ............................... [[33mSKIP[0m]
[0m14:28:30.640391 [debug] [Thread-1 (]: Finished running node model.nyc_mobility_project.high_value_customers
[0m14:28:30.658864 [debug] [Thread-1 (]: Began running node model.nyc_mobility_project.trip_summary_per_hour
[0m14:28:30.676566 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.trip_summary_per_hour .............................. [[33mSKIP[0m]
[0m14:28:30.706485 [debug] [Thread-1 (]: Finished running node model.nyc_mobility_project.trip_summary_per_hour
[0m14:28:30.735610 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:30.773532 [debug] [MainThread]: On master: BEGIN
[0m14:28:30.812075 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:28:30.879563 [debug] [MainThread]: SQL status: BEGIN in 0.067 seconds
[0m14:28:30.892214 [debug] [MainThread]: On master: COMMIT
[0m14:28:30.921573 [debug] [MainThread]: Using postgres connection "master"
[0m14:28:30.965997 [debug] [MainThread]: On master: COMMIT
[0m14:28:30.976575 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:28:30.996302 [debug] [MainThread]: On master: Close
[0m14:28:31.035784 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:28:31.052331 [debug] [MainThread]: Connection 'model.nyc_mobility_project.trip_enriched' was properly closed.
[0m14:28:31.065532 [info ] [MainThread]: 
[0m14:28:31.086828 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 3.89 seconds (3.89s).
[0m14:28:31.120765 [debug] [MainThread]: Command end result
[0m14:28:31.766549 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m14:28:31.851215 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m14:28:31.940192 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m14:28:31.942744 [info ] [MainThread]: 
[0m14:28:31.968411 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:28:31.973741 [info ] [MainThread]: 
[0m14:28:31.979026 [error] [MainThread]:   Database Error in model trip_enriched (models/marts/trip_enriched.sql)
  relation "public.source_fact_taxi_trips" does not exist
  LINE 30: FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
                ^
  compiled code at target/run/nyc_mobility_project/models/marts/trip_enriched.sql
[0m14:28:31.989878 [info ] [MainThread]: 
[0m14:28:31.997216 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=2 TOTAL=4
[0m14:28:32.012767 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 16.917883, "process_in_blocks": "35864", "process_kernel_time": 4.52513, "process_mem_max_rss": "124604", "process_out_blocks": "496", "process_user_time": 12.067015}
[0m14:28:32.024156 [debug] [MainThread]: Command `dbt run` failed at 14:28:32.023800 after 16.93 seconds
[0m14:28:32.028500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96e9513fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96e8d9e6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96ead45ae0>]}
[0m14:28:32.034491 [debug] [MainThread]: Flushing usage events
[0m14:28:32.963691 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:30:41.080863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78bb11ff70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78ba194be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78ba194c40>]}


============================== 14:30:41.095334 | d91f7beb-a5ed-471f-b74e-c4cd15f28d40 ==============================
[0m14:30:41.095334 [info ] [MainThread]: Running with dbt=1.9.4
[0m14:30:41.098312 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/opt/airflow/dbt_project', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select trip_enriched trip_summary_per_hour high_value_customers source_dim_weather', 'send_anonymous_usage_stats': 'True'}
[0m14:30:41.271304 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m14:30:41.274411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd91f7beb-a5ed-471f-b74e-c4cd15f28d40', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78ba250760>]}
[0m14:30:41.276815 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m14:30:41.279529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd91f7beb-a5ed-471f-b74e-c4cd15f28d40', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78ba251090>]}
[0m14:30:41.575493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd91f7beb-a5ed-471f-b74e-c4cd15f28d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78bc7db3a0>]}
[0m14:30:41.842121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd91f7beb-a5ed-471f-b74e-c4cd15f28d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78b993c280>]}
[0m14:30:41.845851 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:30:42.130237 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m14:30:42.622755 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:30:42.625253 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:30:42.727950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd91f7beb-a5ed-471f-b74e-c4cd15f28d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78b99c4460>]}
[0m14:30:42.983564 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m14:30:43.008717 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m14:30:43.053419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd91f7beb-a5ed-471f-b74e-c4cd15f28d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78b855a260>]}
[0m14:30:43.056729 [info ] [MainThread]: Found 6 models, 2 sources, 433 macros
[0m14:30:43.059557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd91f7beb-a5ed-471f-b74e-c4cd15f28d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78b855a4d0>]}
[0m14:30:43.070984 [info ] [MainThread]: 
[0m14:30:43.073546 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:30:43.077138 [info ] [MainThread]: 
[0m14:30:43.079705 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:30:43.094751 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nyc_dwh'
[0m14:30:43.260794 [debug] [ThreadPool]: Using postgres connection "list_nyc_dwh"
[0m14:30:43.263201 [debug] [ThreadPool]: On list_nyc_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "connection_name": "list_nyc_dwh"} */

    select distinct nspname from pg_namespace
  
[0m14:30:43.265146 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:30:43.275110 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.010 seconds
[0m14:30:43.279073 [debug] [ThreadPool]: On list_nyc_dwh: Close
[0m14:30:43.284344 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nyc_dwh, now list_nyc_dwh_public)
[0m14:30:43.300767 [debug] [ThreadPool]: Using postgres connection "list_nyc_dwh_public"
[0m14:30:43.303654 [debug] [ThreadPool]: On list_nyc_dwh_public: BEGIN
[0m14:30:43.305623 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:30:43.312616 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m14:30:43.317382 [debug] [ThreadPool]: Using postgres connection "list_nyc_dwh_public"
[0m14:30:43.320547 [debug] [ThreadPool]: On list_nyc_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "connection_name": "list_nyc_dwh_public"} */
select
      'nyc_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'nyc_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'nyc_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:30:43.329165 [debug] [ThreadPool]: SQL status: SELECT 47 in 0.005 seconds
[0m14:30:43.338232 [debug] [ThreadPool]: On list_nyc_dwh_public: ROLLBACK
[0m14:30:43.340481 [debug] [ThreadPool]: On list_nyc_dwh_public: Close
[0m14:30:43.374631 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:43.377126 [debug] [MainThread]: On master: BEGIN
[0m14:30:43.379366 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:30:43.387575 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m14:30:43.390668 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:43.393988 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:30:43.415300 [debug] [MainThread]: SQL status: SELECT 1 in 0.017 seconds
[0m14:30:43.422850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd91f7beb-a5ed-471f-b74e-c4cd15f28d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78b99f6410>]}
[0m14:30:43.426554 [debug] [MainThread]: On master: ROLLBACK
[0m14:30:43.429274 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:43.431685 [debug] [MainThread]: On master: BEGIN
[0m14:30:43.438257 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m14:30:43.441046 [debug] [MainThread]: On master: COMMIT
[0m14:30:43.443997 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:43.446644 [debug] [MainThread]: On master: COMMIT
[0m14:30:43.449754 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:30:43.453899 [debug] [MainThread]: On master: Close
[0m14:30:43.465686 [debug] [Thread-1 (]: Began running node model.nyc_mobility_project.source_dim_weather
[0m14:30:43.470086 [info ] [Thread-1 (]: 1 of 4 START sql view model public.source_dim_weather .......................... [RUN]
[0m14:30:43.473091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nyc_dwh_public, now model.nyc_mobility_project.source_dim_weather)
[0m14:30:43.475306 [debug] [Thread-1 (]: Began compiling node model.nyc_mobility_project.source_dim_weather
[0m14:30:43.497184 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_mobility_project.source_dim_weather"
[0m14:30:43.512512 [debug] [Thread-1 (]: Began executing node model.nyc_mobility_project.source_dim_weather
[0m14:30:43.619991 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_mobility_project.source_dim_weather"
[0m14:30:43.632851 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.source_dim_weather"
[0m14:30:43.636317 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: BEGIN
[0m14:30:43.638275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:30:43.645682 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m14:30:43.648774 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.source_dim_weather"
[0m14:30:43.653257 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.source_dim_weather"} */

  create view "nyc_dwh"."public"."source_dim_weather__dbt_tmp"
    
    
  as (
    

SELECT * FROM "nyc_dwh"."public"."dim_weather"
  );
[0m14:30:43.659392 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m14:30:43.687114 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.source_dim_weather"
[0m14:30:43.689186 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.source_dim_weather"} */
alter table "nyc_dwh"."public"."source_dim_weather" rename to "source_dim_weather__dbt_backup"
[0m14:30:43.692109 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:30:43.703365 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.source_dim_weather"
[0m14:30:43.705809 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.source_dim_weather"} */
alter table "nyc_dwh"."public"."source_dim_weather__dbt_tmp" rename to "source_dim_weather"
[0m14:30:43.708753 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:30:43.755876 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: COMMIT
[0m14:30:43.758300 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.source_dim_weather"
[0m14:30:43.760960 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: COMMIT
[0m14:30:43.764986 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:30:43.786710 [debug] [Thread-1 (]: Applying DROP to: "nyc_dwh"."public"."source_dim_weather__dbt_backup"
[0m14:30:43.803896 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.source_dim_weather"
[0m14:30:43.807444 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.source_dim_weather"} */
drop view if exists "nyc_dwh"."public"."source_dim_weather__dbt_backup" cascade
[0m14:30:43.815826 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.006 seconds
[0m14:30:43.823764 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: Close
[0m14:30:43.829558 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd91f7beb-a5ed-471f-b74e-c4cd15f28d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78b89419f0>]}
[0m14:30:43.832537 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.source_dim_weather ..................... [[32mCREATE VIEW[0m in 0.35s]
[0m14:30:43.837796 [debug] [Thread-1 (]: Finished running node model.nyc_mobility_project.source_dim_weather
[0m14:30:43.841546 [debug] [Thread-1 (]: Began running node model.nyc_mobility_project.trip_enriched
[0m14:30:43.844149 [info ] [Thread-1 (]: 2 of 4 START sql table model public.trip_enriched .............................. [RUN]
[0m14:30:43.846959 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_mobility_project.source_dim_weather, now model.nyc_mobility_project.trip_enriched)
[0m14:30:43.849369 [debug] [Thread-1 (]: Began compiling node model.nyc_mobility_project.trip_enriched
[0m14:30:43.859730 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_mobility_project.trip_enriched"
[0m14:30:43.873215 [debug] [Thread-1 (]: Began executing node model.nyc_mobility_project.trip_enriched
[0m14:30:43.940023 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_mobility_project.trip_enriched"
[0m14:30:43.954271 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_enriched"
[0m14:30:43.956480 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: BEGIN
[0m14:30:43.958975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:30:43.966364 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m14:30:43.970552 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_enriched"
[0m14:30:43.973942 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.trip_enriched"} */

  
    

  create  table "nyc_dwh"."public"."trip_enriched__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    t.passenger_count,
    t.trip_distance,
    t.tpep_pickup_datetime,
    t.tpep_dropoff_datetime,
    t.payment_type,
    t.fare_amount,
    t.tip_amount,
    t.tip_percentage,
    t.distance_bucket,
    t.pickup_hour,
    t.pickup_day_of_week,
    w.weather_category,
    w.temperature,
    w.humidity,
    w.wind_speed
FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
LEFT JOIN "nyc_dwh"."public"."source_dim_weather" w
    ON date_trunc('hour', t.tpep_pickup_datetime) = date_trunc('hour', w.event_time)
  );
  
[0m14:30:43.977899 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.source_fact_taxi_trips" does not exist
LINE 30: FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
              ^

[0m14:30:43.980798 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: ROLLBACK
[0m14:30:43.985015 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: Close
[0m14:30:43.993073 [debug] [Thread-1 (]: Database Error in model trip_enriched (models/marts/trip_enriched.sql)
  relation "public.source_fact_taxi_trips" does not exist
  LINE 30: FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
                ^
  compiled code at target/run/nyc_mobility_project/models/marts/trip_enriched.sql
[0m14:30:43.998514 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd91f7beb-a5ed-471f-b74e-c4cd15f28d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78b5a0f520>]}
[0m14:30:44.003433 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.trip_enriched ..................... [[31mERROR[0m in 0.15s]
[0m14:30:44.007340 [debug] [Thread-1 (]: Finished running node model.nyc_mobility_project.trip_enriched
[0m14:30:44.010640 [debug] [Thread-4 (]: Marking all children of 'model.nyc_mobility_project.trip_enriched' to be skipped because of status 'error'.  Reason: Database Error in model trip_enriched (models/marts/trip_enriched.sql)
  relation "public.source_fact_taxi_trips" does not exist
  LINE 30: FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
                ^
  compiled code at target/run/nyc_mobility_project/models/marts/trip_enriched.sql.
[0m14:30:44.016099 [debug] [Thread-1 (]: Began running node model.nyc_mobility_project.high_value_customers
[0m14:30:44.020155 [info ] [Thread-1 (]: 3 of 4 SKIP relation public.high_value_customers ............................... [[33mSKIP[0m]
[0m14:30:44.024157 [debug] [Thread-1 (]: Finished running node model.nyc_mobility_project.high_value_customers
[0m14:30:44.027566 [debug] [Thread-1 (]: Began running node model.nyc_mobility_project.trip_summary_per_hour
[0m14:30:44.030486 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.trip_summary_per_hour .............................. [[33mSKIP[0m]
[0m14:30:44.034956 [debug] [Thread-1 (]: Finished running node model.nyc_mobility_project.trip_summary_per_hour
[0m14:30:44.041295 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:44.044148 [debug] [MainThread]: On master: BEGIN
[0m14:30:44.047119 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:30:44.071440 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m14:30:44.080652 [debug] [MainThread]: On master: COMMIT
[0m14:30:44.089505 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:44.093407 [debug] [MainThread]: On master: COMMIT
[0m14:30:44.096931 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:30:44.106686 [debug] [MainThread]: On master: Close
[0m14:30:44.112234 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:30:44.123333 [debug] [MainThread]: Connection 'model.nyc_mobility_project.trip_enriched' was properly closed.
[0m14:30:44.128618 [info ] [MainThread]: 
[0m14:30:44.140402 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 1.05 seconds (1.05s).
[0m14:30:44.158920 [debug] [MainThread]: Command end result
[0m14:30:44.314168 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m14:30:44.330119 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m14:30:44.370399 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m14:30:44.373661 [info ] [MainThread]: 
[0m14:30:44.377481 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:30:44.382317 [info ] [MainThread]: 
[0m14:30:44.385944 [error] [MainThread]:   Database Error in model trip_enriched (models/marts/trip_enriched.sql)
  relation "public.source_fact_taxi_trips" does not exist
  LINE 30: FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
                ^
  compiled code at target/run/nyc_mobility_project/models/marts/trip_enriched.sql
[0m14:30:44.390229 [info ] [MainThread]: 
[0m14:30:44.394192 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=2 TOTAL=4
[0m14:30:44.398061 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.540128, "process_in_blocks": "0", "process_kernel_time": 0.269281, "process_mem_max_rss": "118776", "process_out_blocks": "0", "process_user_time": 6.123663}
[0m14:30:44.402503 [debug] [MainThread]: Command `dbt run` failed at 14:30:44.402091 after 3.54 seconds
[0m14:30:44.405480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78bb11ff70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78ba500f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f78bcd4d1e0>]}
[0m14:30:44.408678 [debug] [MainThread]: Flushing usage events
[0m14:30:45.117942 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:33:37.588048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa54839ff40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5473f0c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5473f0c70>]}


============================== 14:33:37.596127 | 0fba6e80-ff94-43cd-a7ac-442ea75edeb6 ==============================
[0m14:33:37.596127 [info ] [MainThread]: Running with dbt=1.9.4
[0m14:33:37.599205 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select trip_enriched trip_summary_per_hour high_value_customers source_dim_weather', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:33:37.722805 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m14:33:37.725964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0fba6e80-ff94-43cd-a7ac-442ea75edeb6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5476ab190>]}
[0m14:33:37.728028 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m14:33:37.729925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0fba6e80-ff94-43cd-a7ac-442ea75edeb6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5476a8730>]}
[0m14:33:37.955752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0fba6e80-ff94-43cd-a7ac-442ea75edeb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa549e7baf0>]}
[0m14:33:38.089557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0fba6e80-ff94-43cd-a7ac-442ea75edeb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5474d4280>]}
[0m14:33:38.092625 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:33:38.413145 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m14:33:38.979553 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:33:38.981133 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:33:39.105478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0fba6e80-ff94-43cd-a7ac-442ea75edeb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa545fb0a60>]}
[0m14:33:39.351525 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m14:33:39.383255 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m14:33:39.429742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0fba6e80-ff94-43cd-a7ac-442ea75edeb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5457162c0>]}
[0m14:33:39.432268 [info ] [MainThread]: Found 6 models, 2 sources, 433 macros
[0m14:33:39.434892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fba6e80-ff94-43cd-a7ac-442ea75edeb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa545716530>]}
[0m14:33:39.441408 [info ] [MainThread]: 
[0m14:33:39.444104 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:33:39.446354 [info ] [MainThread]: 
[0m14:33:39.449364 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:33:39.463362 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nyc_dwh'
[0m14:33:39.603142 [debug] [ThreadPool]: Using postgres connection "list_nyc_dwh"
[0m14:33:39.605688 [debug] [ThreadPool]: On list_nyc_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "connection_name": "list_nyc_dwh"} */

    select distinct nspname from pg_namespace
  
[0m14:33:39.608514 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:33:39.617400 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.009 seconds
[0m14:33:39.621839 [debug] [ThreadPool]: On list_nyc_dwh: Close
[0m14:33:39.632380 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nyc_dwh, now list_nyc_dwh_public)
[0m14:33:39.655072 [debug] [ThreadPool]: Using postgres connection "list_nyc_dwh_public"
[0m14:33:39.659186 [debug] [ThreadPool]: On list_nyc_dwh_public: BEGIN
[0m14:33:39.661650 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:33:39.671401 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m14:33:39.680014 [debug] [ThreadPool]: Using postgres connection "list_nyc_dwh_public"
[0m14:33:39.684888 [debug] [ThreadPool]: On list_nyc_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "connection_name": "list_nyc_dwh_public"} */
select
      'nyc_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'nyc_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'nyc_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:33:39.705566 [debug] [ThreadPool]: SQL status: SELECT 47 in 0.017 seconds
[0m14:33:39.712787 [debug] [ThreadPool]: On list_nyc_dwh_public: ROLLBACK
[0m14:33:39.715584 [debug] [ThreadPool]: On list_nyc_dwh_public: Close
[0m14:33:39.765078 [debug] [MainThread]: Using postgres connection "master"
[0m14:33:39.766910 [debug] [MainThread]: On master: BEGIN
[0m14:33:39.768947 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:33:39.780219 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m14:33:39.782952 [debug] [MainThread]: Using postgres connection "master"
[0m14:33:39.786403 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:33:39.817092 [debug] [MainThread]: SQL status: SELECT 1 in 0.025 seconds
[0m14:33:39.829835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fba6e80-ff94-43cd-a7ac-442ea75edeb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa54989c490>]}
[0m14:33:39.831908 [debug] [MainThread]: On master: ROLLBACK
[0m14:33:39.834127 [debug] [MainThread]: Using postgres connection "master"
[0m14:33:39.836022 [debug] [MainThread]: On master: BEGIN
[0m14:33:39.842174 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:33:39.845543 [debug] [MainThread]: On master: COMMIT
[0m14:33:39.848867 [debug] [MainThread]: Using postgres connection "master"
[0m14:33:39.851235 [debug] [MainThread]: On master: COMMIT
[0m14:33:39.858038 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:33:39.860909 [debug] [MainThread]: On master: Close
[0m14:33:39.872728 [debug] [Thread-1 (]: Began running node model.nyc_mobility_project.source_dim_weather
[0m14:33:39.875070 [info ] [Thread-1 (]: 1 of 4 START sql view model public.source_dim_weather .......................... [RUN]
[0m14:33:39.877697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nyc_dwh_public, now model.nyc_mobility_project.source_dim_weather)
[0m14:33:39.879892 [debug] [Thread-1 (]: Began compiling node model.nyc_mobility_project.source_dim_weather
[0m14:33:39.902178 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_mobility_project.source_dim_weather"
[0m14:33:39.919052 [debug] [Thread-1 (]: Began executing node model.nyc_mobility_project.source_dim_weather
[0m14:33:40.033595 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_mobility_project.source_dim_weather"
[0m14:33:40.048070 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.source_dim_weather"
[0m14:33:40.050312 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: BEGIN
[0m14:33:40.052473 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:33:40.060864 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m14:33:40.064235 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.source_dim_weather"
[0m14:33:40.070457 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.source_dim_weather"} */

  create view "nyc_dwh"."public"."source_dim_weather__dbt_tmp"
    
    
  as (
    

SELECT * FROM "nyc_dwh"."public"."dim_weather"
  );
[0m14:33:40.084417 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m14:33:40.104378 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.source_dim_weather"
[0m14:33:40.107673 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.source_dim_weather"} */
alter table "nyc_dwh"."public"."source_dim_weather" rename to "source_dim_weather__dbt_backup"
[0m14:33:40.110522 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:33:40.119415 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.source_dim_weather"
[0m14:33:40.123745 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.source_dim_weather"} */
alter table "nyc_dwh"."public"."source_dim_weather__dbt_tmp" rename to "source_dim_weather"
[0m14:33:40.126670 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:33:40.176620 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: COMMIT
[0m14:33:40.178920 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.source_dim_weather"
[0m14:33:40.181863 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: COMMIT
[0m14:33:40.185608 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:33:40.204428 [debug] [Thread-1 (]: Applying DROP to: "nyc_dwh"."public"."source_dim_weather__dbt_backup"
[0m14:33:40.224973 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.source_dim_weather"
[0m14:33:40.227393 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.source_dim_weather"} */
drop view if exists "nyc_dwh"."public"."source_dim_weather__dbt_backup" cascade
[0m14:33:40.232220 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:33:40.239324 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: Close
[0m14:33:40.246811 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fba6e80-ff94-43cd-a7ac-442ea75edeb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa545ffd690>]}
[0m14:33:40.251331 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.source_dim_weather ..................... [[32mCREATE VIEW[0m in 0.36s]
[0m14:33:40.255816 [debug] [Thread-1 (]: Finished running node model.nyc_mobility_project.source_dim_weather
[0m14:33:40.259564 [debug] [Thread-1 (]: Began running node model.nyc_mobility_project.trip_enriched
[0m14:33:40.262399 [info ] [Thread-1 (]: 2 of 4 START sql table model public.trip_enriched .............................. [RUN]
[0m14:33:40.264703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_mobility_project.source_dim_weather, now model.nyc_mobility_project.trip_enriched)
[0m14:33:40.266932 [debug] [Thread-1 (]: Began compiling node model.nyc_mobility_project.trip_enriched
[0m14:33:40.278878 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_mobility_project.trip_enriched"
[0m14:33:40.292582 [debug] [Thread-1 (]: Began executing node model.nyc_mobility_project.trip_enriched
[0m14:33:40.357858 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_mobility_project.trip_enriched"
[0m14:33:40.376710 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_enriched"
[0m14:33:40.378994 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: BEGIN
[0m14:33:40.383082 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:33:40.396881 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m14:33:40.405008 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_enriched"
[0m14:33:40.409676 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.trip_enriched"} */

  
    

  create  table "nyc_dwh"."public"."trip_enriched__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    t.passenger_count,
    t.trip_distance,
    t.tpep_pickup_datetime,
    t.tpep_dropoff_datetime,
    t.payment_type,
    t.fare_amount,
    t.tip_amount,
    t.tip_percentage,
    t.distance_bucket,
    t.pickup_hour,
    t.pickup_day_of_week,
    w.weather_category,
    w.temperature,
    w.humidity,
    w.wind_speed
FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
LEFT JOIN "nyc_dwh"."public"."source_dim_weather" w
    ON date_trunc('hour', t.tpep_pickup_datetime) = date_trunc('hour', w.event_time)
  );
  
[0m14:33:40.414065 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.source_fact_taxi_trips" does not exist
LINE 30: FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
              ^

[0m14:33:40.417173 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: ROLLBACK
[0m14:33:40.424409 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: Close
[0m14:33:40.432255 [debug] [Thread-1 (]: Database Error in model trip_enriched (models/marts/trip_enriched.sql)
  relation "public.source_fact_taxi_trips" does not exist
  LINE 30: FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
                ^
  compiled code at target/run/nyc_mobility_project/models/marts/trip_enriched.sql
[0m14:33:40.435611 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0fba6e80-ff94-43cd-a7ac-442ea75edeb6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5445cb4f0>]}
[0m14:33:40.445251 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.trip_enriched ..................... [[31mERROR[0m in 0.17s]
[0m14:33:40.449545 [debug] [Thread-1 (]: Finished running node model.nyc_mobility_project.trip_enriched
[0m14:33:40.453557 [debug] [Thread-4 (]: Marking all children of 'model.nyc_mobility_project.trip_enriched' to be skipped because of status 'error'.  Reason: Database Error in model trip_enriched (models/marts/trip_enriched.sql)
  relation "public.source_fact_taxi_trips" does not exist
  LINE 30: FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
                ^
  compiled code at target/run/nyc_mobility_project/models/marts/trip_enriched.sql.
[0m14:33:40.462690 [debug] [Thread-1 (]: Began running node model.nyc_mobility_project.high_value_customers
[0m14:33:40.466630 [info ] [Thread-1 (]: 3 of 4 SKIP relation public.high_value_customers ............................... [[33mSKIP[0m]
[0m14:33:40.478570 [debug] [Thread-1 (]: Finished running node model.nyc_mobility_project.high_value_customers
[0m14:33:40.486058 [debug] [Thread-1 (]: Began running node model.nyc_mobility_project.trip_summary_per_hour
[0m14:33:40.493617 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.trip_summary_per_hour .............................. [[33mSKIP[0m]
[0m14:33:40.497442 [debug] [Thread-1 (]: Finished running node model.nyc_mobility_project.trip_summary_per_hour
[0m14:33:40.502934 [debug] [MainThread]: Using postgres connection "master"
[0m14:33:40.508005 [debug] [MainThread]: On master: BEGIN
[0m14:33:40.510625 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:33:40.531388 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m14:33:40.534474 [debug] [MainThread]: On master: COMMIT
[0m14:33:40.540739 [debug] [MainThread]: Using postgres connection "master"
[0m14:33:40.546300 [debug] [MainThread]: On master: COMMIT
[0m14:33:40.549753 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:33:40.554888 [debug] [MainThread]: On master: Close
[0m14:33:40.560121 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:33:40.563970 [debug] [MainThread]: Connection 'model.nyc_mobility_project.trip_enriched' was properly closed.
[0m14:33:40.566374 [info ] [MainThread]: 
[0m14:33:40.568766 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 1.12 seconds (1.12s).
[0m14:33:40.575199 [debug] [MainThread]: Command end result
[0m14:33:40.689918 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m14:33:40.703442 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m14:33:40.738802 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m14:33:40.742062 [info ] [MainThread]: 
[0m14:33:40.745104 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:33:40.747799 [info ] [MainThread]: 
[0m14:33:40.762474 [error] [MainThread]:   Database Error in model trip_enriched (models/marts/trip_enriched.sql)
  relation "public.source_fact_taxi_trips" does not exist
  LINE 30: FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
                ^
  compiled code at target/run/nyc_mobility_project/models/marts/trip_enriched.sql
[0m14:33:40.768932 [info ] [MainThread]: 
[0m14:33:40.776780 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=2 TOTAL=4
[0m14:33:40.781354 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.3055096, "process_in_blocks": "0", "process_kernel_time": 0.343323, "process_mem_max_rss": "120128", "process_out_blocks": "0", "process_user_time": 4.665157}
[0m14:33:40.785092 [debug] [MainThread]: Command `dbt run` failed at 14:33:40.784772 after 3.31 seconds
[0m14:33:40.790728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa54839ff40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa54989e320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa54989c9d0>]}
[0m14:33:40.793537 [debug] [MainThread]: Flushing usage events
[0m14:33:41.445230 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:35:48.079786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f922336ff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92223c0ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92223c0d00>]}


============================== 14:35:48.088386 | 3a353ca2-2c6f-4663-90d2-d962d1128d9b ==============================
[0m14:35:48.088386 [info ] [MainThread]: Running with dbt=1.9.4
[0m14:35:48.090460 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select trip_enriched trip_summary_per_hour high_value_customers source_dim_weather', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:35:48.200173 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m14:35:48.202037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3a353ca2-2c6f-4663-90d2-d962d1128d9b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f922267a800>]}
[0m14:35:48.204160 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m14:35:48.206074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3a353ca2-2c6f-4663-90d2-d962d1128d9b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9222679090>]}
[0m14:35:48.377642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a353ca2-2c6f-4663-90d2-d962d1128d9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9224fc3550>]}
[0m14:35:48.469062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a353ca2-2c6f-4663-90d2-d962d1128d9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92224a41f0>]}
[0m14:35:48.471711 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:35:48.603805 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m14:35:48.904026 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:35:48.906027 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:35:48.975114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a353ca2-2c6f-4663-90d2-d962d1128d9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9220fb0a00>]}
[0m14:35:49.134202 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m14:35:49.150113 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m14:35:49.180869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a353ca2-2c6f-4663-90d2-d962d1128d9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f922071a410>]}
[0m14:35:49.182957 [info ] [MainThread]: Found 6 models, 2 sources, 433 macros
[0m14:35:49.184854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a353ca2-2c6f-4663-90d2-d962d1128d9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f922071a680>]}
[0m14:35:49.189505 [info ] [MainThread]: 
[0m14:35:49.191629 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:35:49.193788 [info ] [MainThread]: 
[0m14:35:49.195844 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:35:49.204784 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nyc_dwh'
[0m14:35:49.305886 [debug] [ThreadPool]: Using postgres connection "list_nyc_dwh"
[0m14:35:49.307861 [debug] [ThreadPool]: On list_nyc_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "connection_name": "list_nyc_dwh"} */

    select distinct nspname from pg_namespace
  
[0m14:35:49.309765 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:35:49.317257 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m14:35:49.320533 [debug] [ThreadPool]: On list_nyc_dwh: Close
[0m14:35:49.325191 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nyc_dwh, now list_nyc_dwh_public)
[0m14:35:49.336222 [debug] [ThreadPool]: Using postgres connection "list_nyc_dwh_public"
[0m14:35:49.338607 [debug] [ThreadPool]: On list_nyc_dwh_public: BEGIN
[0m14:35:49.340511 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:35:49.346198 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m14:35:49.348475 [debug] [ThreadPool]: Using postgres connection "list_nyc_dwh_public"
[0m14:35:49.350675 [debug] [ThreadPool]: On list_nyc_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "connection_name": "list_nyc_dwh_public"} */
select
      'nyc_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'nyc_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'nyc_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:35:49.356537 [debug] [ThreadPool]: SQL status: SELECT 47 in 0.004 seconds
[0m14:35:49.361501 [debug] [ThreadPool]: On list_nyc_dwh_public: ROLLBACK
[0m14:35:49.363756 [debug] [ThreadPool]: On list_nyc_dwh_public: Close
[0m14:35:49.390933 [debug] [MainThread]: Using postgres connection "master"
[0m14:35:49.392767 [debug] [MainThread]: On master: BEGIN
[0m14:35:49.394513 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:35:49.400104 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m14:35:49.402728 [debug] [MainThread]: Using postgres connection "master"
[0m14:35:49.405236 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:35:49.417018 [debug] [MainThread]: SQL status: SELECT 1 in 0.009 seconds
[0m14:35:49.420407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a353ca2-2c6f-4663-90d2-d962d1128d9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9224fc04c0>]}
[0m14:35:49.422598 [debug] [MainThread]: On master: ROLLBACK
[0m14:35:49.424545 [debug] [MainThread]: Using postgres connection "master"
[0m14:35:49.426205 [debug] [MainThread]: On master: BEGIN
[0m14:35:49.428520 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:35:49.430981 [debug] [MainThread]: On master: COMMIT
[0m14:35:49.433071 [debug] [MainThread]: Using postgres connection "master"
[0m14:35:49.435270 [debug] [MainThread]: On master: COMMIT
[0m14:35:49.438304 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:35:49.440503 [debug] [MainThread]: On master: Close
[0m14:35:49.448241 [debug] [Thread-1 (]: Began running node model.nyc_mobility_project.source_dim_weather
[0m14:35:49.450228 [info ] [Thread-1 (]: 1 of 4 START sql view model public.source_dim_weather .......................... [RUN]
[0m14:35:49.452168 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nyc_dwh_public, now model.nyc_mobility_project.source_dim_weather)
[0m14:35:49.454295 [debug] [Thread-1 (]: Began compiling node model.nyc_mobility_project.source_dim_weather
[0m14:35:49.469097 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_mobility_project.source_dim_weather"
[0m14:35:49.479116 [debug] [Thread-1 (]: Began executing node model.nyc_mobility_project.source_dim_weather
[0m14:35:49.540899 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_mobility_project.source_dim_weather"
[0m14:35:49.550176 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.source_dim_weather"
[0m14:35:49.552343 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: BEGIN
[0m14:35:49.554813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:49.561643 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m14:35:49.564651 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.source_dim_weather"
[0m14:35:49.567495 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.source_dim_weather"} */

  create view "nyc_dwh"."public"."source_dim_weather__dbt_tmp"
    
    
  as (
    

SELECT * FROM "nyc_dwh"."public"."dim_weather"
  );
[0m14:35:49.573694 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m14:35:49.589794 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.source_dim_weather"
[0m14:35:49.591884 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.source_dim_weather"} */
alter table "nyc_dwh"."public"."source_dim_weather" rename to "source_dim_weather__dbt_backup"
[0m14:35:49.594440 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:35:49.601880 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.source_dim_weather"
[0m14:35:49.603580 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.source_dim_weather"} */
alter table "nyc_dwh"."public"."source_dim_weather__dbt_tmp" rename to "source_dim_weather"
[0m14:35:49.606215 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:35:49.635078 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: COMMIT
[0m14:35:49.637220 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.source_dim_weather"
[0m14:35:49.639069 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: COMMIT
[0m14:35:49.644921 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m14:35:49.656218 [debug] [Thread-1 (]: Applying DROP to: "nyc_dwh"."public"."source_dim_weather__dbt_backup"
[0m14:35:49.664733 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.source_dim_weather"
[0m14:35:49.666864 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.source_dim_weather"} */
drop view if exists "nyc_dwh"."public"."source_dim_weather__dbt_backup" cascade
[0m14:35:49.673504 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m14:35:49.678776 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: Close
[0m14:35:49.682939 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a353ca2-2c6f-4663-90d2-d962d1128d9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9220ff85b0>]}
[0m14:35:49.685837 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.source_dim_weather ..................... [[32mCREATE VIEW[0m in 0.23s]
[0m14:35:49.689742 [debug] [Thread-1 (]: Finished running node model.nyc_mobility_project.source_dim_weather
[0m14:35:49.693278 [debug] [Thread-1 (]: Began running node model.nyc_mobility_project.trip_enriched
[0m14:35:49.696069 [info ] [Thread-1 (]: 2 of 4 START sql table model public.trip_enriched .............................. [RUN]
[0m14:35:49.698590 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_mobility_project.source_dim_weather, now model.nyc_mobility_project.trip_enriched)
[0m14:35:49.700466 [debug] [Thread-1 (]: Began compiling node model.nyc_mobility_project.trip_enriched
[0m14:35:49.708171 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_mobility_project.trip_enriched"
[0m14:35:49.717277 [debug] [Thread-1 (]: Began executing node model.nyc_mobility_project.trip_enriched
[0m14:35:49.757212 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_mobility_project.trip_enriched"
[0m14:35:49.767173 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_enriched"
[0m14:35:49.769237 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: BEGIN
[0m14:35:49.771351 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:49.777607 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m14:35:49.779954 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_enriched"
[0m14:35:49.782238 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.trip_enriched"} */

  
    

  create  table "nyc_dwh"."public"."trip_enriched__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    t.passenger_count,
    t.trip_distance,
    t.tpep_pickup_datetime,
    t.tpep_dropoff_datetime,
    t.payment_type,
    t.fare_amount,
    t.tip_amount,
    t.tip_percentage,
    t.distance_bucket,
    t.pickup_hour,
    t.pickup_day_of_week,
    w.weather_category,
    w.temperature,
    w.humidity,
    w.wind_speed
FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
LEFT JOIN "nyc_dwh"."public"."source_dim_weather" w
    ON date_trunc('hour', t.tpep_pickup_datetime) = date_trunc('hour', w.event_time)
  );
  
[0m14:35:49.785751 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.source_fact_taxi_trips" does not exist
LINE 30: FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
              ^

[0m14:35:49.788256 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: ROLLBACK
[0m14:35:49.790730 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: Close
[0m14:35:49.796951 [debug] [Thread-1 (]: Database Error in model trip_enriched (models/marts/trip_enriched.sql)
  relation "public.source_fact_taxi_trips" does not exist
  LINE 30: FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
                ^
  compiled code at target/run/nyc_mobility_project/models/marts/trip_enriched.sql
[0m14:35:49.799177 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a353ca2-2c6f-4663-90d2-d962d1128d9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f921f5cb490>]}
[0m14:35:49.801652 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.trip_enriched ..................... [[31mERROR[0m in 0.10s]
[0m14:35:49.805007 [debug] [Thread-1 (]: Finished running node model.nyc_mobility_project.trip_enriched
[0m14:35:49.807760 [debug] [Thread-4 (]: Marking all children of 'model.nyc_mobility_project.trip_enriched' to be skipped because of status 'error'.  Reason: Database Error in model trip_enriched (models/marts/trip_enriched.sql)
  relation "public.source_fact_taxi_trips" does not exist
  LINE 30: FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
                ^
  compiled code at target/run/nyc_mobility_project/models/marts/trip_enriched.sql.
[0m14:35:49.812480 [debug] [Thread-1 (]: Began running node model.nyc_mobility_project.high_value_customers
[0m14:35:49.814573 [info ] [Thread-1 (]: 3 of 4 SKIP relation public.high_value_customers ............................... [[33mSKIP[0m]
[0m14:35:49.816813 [debug] [Thread-1 (]: Finished running node model.nyc_mobility_project.high_value_customers
[0m14:35:49.818875 [debug] [Thread-1 (]: Began running node model.nyc_mobility_project.trip_summary_per_hour
[0m14:35:49.821107 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.trip_summary_per_hour .............................. [[33mSKIP[0m]
[0m14:35:49.823586 [debug] [Thread-1 (]: Finished running node model.nyc_mobility_project.trip_summary_per_hour
[0m14:35:49.827133 [debug] [MainThread]: Using postgres connection "master"
[0m14:35:49.829770 [debug] [MainThread]: On master: BEGIN
[0m14:35:49.831772 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:35:49.840250 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m14:35:49.842282 [debug] [MainThread]: On master: COMMIT
[0m14:35:49.844342 [debug] [MainThread]: Using postgres connection "master"
[0m14:35:49.846223 [debug] [MainThread]: On master: COMMIT
[0m14:35:49.848521 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:35:49.850398 [debug] [MainThread]: On master: Close
[0m14:35:49.853096 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:35:49.857724 [debug] [MainThread]: Connection 'model.nyc_mobility_project.trip_enriched' was properly closed.
[0m14:35:49.859633 [info ] [MainThread]: 
[0m14:35:49.862100 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m14:35:49.866263 [debug] [MainThread]: Command end result
[0m14:35:49.935298 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m14:35:49.945401 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m14:35:49.968760 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m14:35:49.971614 [info ] [MainThread]: 
[0m14:35:49.974762 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:35:49.978810 [info ] [MainThread]: 
[0m14:35:49.981845 [error] [MainThread]:   Database Error in model trip_enriched (models/marts/trip_enriched.sql)
  relation "public.source_fact_taxi_trips" does not exist
  LINE 30: FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
                ^
  compiled code at target/run/nyc_mobility_project/models/marts/trip_enriched.sql
[0m14:35:49.983923 [info ] [MainThread]: 
[0m14:35:49.986280 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=2 TOTAL=4
[0m14:35:49.991043 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.0090644, "process_in_blocks": "0", "process_kernel_time": 0.197036, "process_mem_max_rss": "118704", "process_out_blocks": "0", "process_user_time": 3.349618}
[0m14:35:49.993301 [debug] [MainThread]: Command `dbt run` failed at 14:35:49.993017 after 2.01 seconds
[0m14:35:49.995325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f922336ff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9222bde2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9221703fd0>]}
[0m14:35:49.997501 [debug] [MainThread]: Flushing usage events
[0m14:35:50.624563 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:11:12.321007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd979c7f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd9696cc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd9696cc70>]}


============================== 20:11:12.337019 | 99d128a0-ef2d-49f4-8e11-d8997f9b4fd0 ==============================
[0m20:11:12.337019 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:11:12.341356 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select trip_enriched trip_summary_per_hour high_value_customers source_dim_weather', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:11:12.584589 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m20:11:12.588625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '99d128a0-ef2d-49f4-8e11-d8997f9b4fd0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd96a2b190>]}
[0m20:11:12.591762 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m20:11:12.594250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '99d128a0-ef2d-49f4-8e11-d8997f9b4fd0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd96a28730>]}
[0m20:11:12.998767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99d128a0-ef2d-49f4-8e11-d8997f9b4fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd993a3af0>]}
[0m20:11:13.231964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '99d128a0-ef2d-49f4-8e11-d8997f9b4fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd95d44280>]}
[0m20:11:13.235536 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:11:13.514253 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:11:14.357607 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 3 files added, 0 files changed.
[0m20:11:14.360352 [debug] [MainThread]: Partial parsing: added file: nyc_mobility_project://models/sources/sources.yml
[0m20:11:14.362449 [debug] [MainThread]: Partial parsing: added file: nyc_mobility_project://models/sources/source_dim_weather.sql
[0m20:11:14.364537 [debug] [MainThread]: Partial parsing: added file: nyc_mobility_project://models/sources/source_fact_taxi_trips.sql
[0m20:11:14.367214 [debug] [MainThread]: Partial parsing: deleted file: nyc_mobility_project://models/staging/source_fact_taxi_trips.sql
[0m20:11:14.369394 [debug] [MainThread]: Partial parsing: deleted file: nyc_mobility_project://models/staging/source_dim_weather.sql
[0m20:11:15.524515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99d128a0-ef2d-49f4-8e11-d8997f9b4fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd98e2a440>]}
[0m20:11:15.845602 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m20:11:15.874853 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m20:11:15.933624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99d128a0-ef2d-49f4-8e11-d8997f9b4fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd8fb2a260>]}
[0m20:11:15.941161 [info ] [MainThread]: Found 6 models, 2 sources, 433 macros
[0m20:11:15.945268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99d128a0-ef2d-49f4-8e11-d8997f9b4fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd8fb2a4d0>]}
[0m20:11:15.959740 [info ] [MainThread]: 
[0m20:11:15.962162 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:11:15.965087 [info ] [MainThread]: 
[0m20:11:15.969292 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:11:15.984089 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nyc_dwh'
[0m20:11:16.140875 [debug] [ThreadPool]: Using postgres connection "list_nyc_dwh"
[0m20:11:16.143058 [debug] [ThreadPool]: On list_nyc_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "connection_name": "list_nyc_dwh"} */

    select distinct nspname from pg_namespace
  
[0m20:11:16.145349 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:11:16.155313 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.010 seconds
[0m20:11:16.158523 [debug] [ThreadPool]: On list_nyc_dwh: Close
[0m20:11:16.163710 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nyc_dwh, now list_nyc_dwh_public)
[0m20:11:16.181362 [debug] [ThreadPool]: Using postgres connection "list_nyc_dwh_public"
[0m20:11:16.183722 [debug] [ThreadPool]: On list_nyc_dwh_public: BEGIN
[0m20:11:16.185836 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:11:16.194163 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m20:11:16.197520 [debug] [ThreadPool]: Using postgres connection "list_nyc_dwh_public"
[0m20:11:16.200059 [debug] [ThreadPool]: On list_nyc_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "connection_name": "list_nyc_dwh_public"} */
select
      'nyc_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'nyc_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'nyc_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:11:16.216360 [debug] [ThreadPool]: SQL status: SELECT 47 in 0.014 seconds
[0m20:11:16.221718 [debug] [ThreadPool]: On list_nyc_dwh_public: ROLLBACK
[0m20:11:16.223847 [debug] [ThreadPool]: On list_nyc_dwh_public: Close
[0m20:11:16.249639 [debug] [MainThread]: Using postgres connection "master"
[0m20:11:16.251904 [debug] [MainThread]: On master: BEGIN
[0m20:11:16.253677 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:11:16.260166 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m20:11:16.262631 [debug] [MainThread]: Using postgres connection "master"
[0m20:11:16.264844 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:11:16.286269 [debug] [MainThread]: SQL status: SELECT 1 in 0.019 seconds
[0m20:11:16.291015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99d128a0-ef2d-49f4-8e11-d8997f9b4fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd94d8ea70>]}
[0m20:11:16.293151 [debug] [MainThread]: On master: ROLLBACK
[0m20:11:16.295146 [debug] [MainThread]: Using postgres connection "master"
[0m20:11:16.296852 [debug] [MainThread]: On master: BEGIN
[0m20:11:16.299060 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:11:16.302280 [debug] [MainThread]: On master: COMMIT
[0m20:11:16.304317 [debug] [MainThread]: Using postgres connection "master"
[0m20:11:16.306173 [debug] [MainThread]: On master: COMMIT
[0m20:11:16.308308 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:11:16.310199 [debug] [MainThread]: On master: Close
[0m20:11:16.320297 [debug] [Thread-1 (]: Began running node model.nyc_mobility_project.source_dim_weather
[0m20:11:16.322500 [info ] [Thread-1 (]: 1 of 4 START sql view model public.source_dim_weather .......................... [RUN]
[0m20:11:16.324726 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nyc_dwh_public, now model.nyc_mobility_project.source_dim_weather)
[0m20:11:16.326684 [debug] [Thread-1 (]: Began compiling node model.nyc_mobility_project.source_dim_weather
[0m20:11:16.349525 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_mobility_project.source_dim_weather"
[0m20:11:16.374588 [debug] [Thread-1 (]: Began executing node model.nyc_mobility_project.source_dim_weather
[0m20:11:16.475361 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_mobility_project.source_dim_weather"
[0m20:11:16.492826 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.source_dim_weather"
[0m20:11:16.495589 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: BEGIN
[0m20:11:16.498431 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:11:16.506089 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m20:11:16.510191 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.source_dim_weather"
[0m20:11:16.513630 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.source_dim_weather"} */

  create view "nyc_dwh"."public"."source_dim_weather__dbt_tmp"
    
    
  as (
    

SELECT * FROM "nyc_dwh"."public"."dim_weather"
  );
[0m20:11:16.580788 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.064 seconds
[0m20:11:16.595465 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.source_dim_weather"
[0m20:11:16.597457 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.source_dim_weather"} */
alter table "nyc_dwh"."public"."source_dim_weather" rename to "source_dim_weather__dbt_backup"
[0m20:11:16.602045 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m20:11:16.609106 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.source_dim_weather"
[0m20:11:16.611080 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.source_dim_weather"} */
alter table "nyc_dwh"."public"."source_dim_weather__dbt_tmp" rename to "source_dim_weather"
[0m20:11:16.614229 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:11:16.656962 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: COMMIT
[0m20:11:16.658790 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.source_dim_weather"
[0m20:11:16.660598 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: COMMIT
[0m20:11:16.663780 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:11:16.677377 [debug] [Thread-1 (]: Applying DROP to: "nyc_dwh"."public"."source_dim_weather__dbt_backup"
[0m20:11:16.688789 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.source_dim_weather"
[0m20:11:16.690845 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.source_dim_weather"} */
drop view if exists "nyc_dwh"."public"."source_dim_weather__dbt_backup" cascade
[0m20:11:16.703048 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.010 seconds
[0m20:11:16.710770 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: Close
[0m20:11:16.716864 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99d128a0-ef2d-49f4-8e11-d8997f9b4fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd95972e30>]}
[0m20:11:16.719317 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.source_dim_weather ..................... [[32mCREATE VIEW[0m in 0.39s]
[0m20:11:16.721725 [debug] [Thread-1 (]: Finished running node model.nyc_mobility_project.source_dim_weather
[0m20:11:16.724664 [debug] [Thread-1 (]: Began running node model.nyc_mobility_project.trip_enriched
[0m20:11:16.726808 [info ] [Thread-1 (]: 2 of 4 START sql table model public.trip_enriched .............................. [RUN]
[0m20:11:16.729619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_mobility_project.source_dim_weather, now model.nyc_mobility_project.trip_enriched)
[0m20:11:16.731889 [debug] [Thread-1 (]: Began compiling node model.nyc_mobility_project.trip_enriched
[0m20:11:16.742400 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_mobility_project.trip_enriched"
[0m20:11:16.753051 [debug] [Thread-1 (]: Began executing node model.nyc_mobility_project.trip_enriched
[0m20:11:16.804509 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_mobility_project.trip_enriched"
[0m20:11:16.815463 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_enriched"
[0m20:11:16.818072 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: BEGIN
[0m20:11:16.820437 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:11:16.828693 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m20:11:16.831956 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_enriched"
[0m20:11:16.834801 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.trip_enriched"} */

  
    

  create  table "nyc_dwh"."public"."trip_enriched__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    t.passenger_count,
    t.trip_distance,
    t.tpep_pickup_datetime,
    t.tpep_dropoff_datetime,
    t.payment_type,
    t.fare_amount,
    t.tip_amount,
    t.tip_percentage,
    t.distance_bucket,
    t.pickup_hour,
    t.pickup_day_of_week,
    w.weather_category,
    w.temperature,
    w.humidity,
    w.wind_speed
FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
LEFT JOIN "nyc_dwh"."public"."source_dim_weather" w
    ON date_trunc('hour', t.tpep_pickup_datetime) = date_trunc('hour', w.event_time)
  );
  
[0m20:11:16.839880 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.source_fact_taxi_trips" does not exist
LINE 30: FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
              ^

[0m20:11:16.844239 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: ROLLBACK
[0m20:11:16.846660 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: Close
[0m20:11:16.862518 [debug] [Thread-1 (]: Database Error in model trip_enriched (models/marts/trip_enriched.sql)
  relation "public.source_fact_taxi_trips" does not exist
  LINE 30: FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
                ^
  compiled code at target/run/nyc_mobility_project/models/marts/trip_enriched.sql
[0m20:11:16.864743 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99d128a0-ef2d-49f4-8e11-d8997f9b4fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd96a2a2f0>]}
[0m20:11:16.867232 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.trip_enriched ..................... [[31mERROR[0m in 0.14s]
[0m20:11:16.869981 [debug] [Thread-1 (]: Finished running node model.nyc_mobility_project.trip_enriched
[0m20:11:16.872401 [debug] [Thread-4 (]: Marking all children of 'model.nyc_mobility_project.trip_enriched' to be skipped because of status 'error'.  Reason: Database Error in model trip_enriched (models/marts/trip_enriched.sql)
  relation "public.source_fact_taxi_trips" does not exist
  LINE 30: FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
                ^
  compiled code at target/run/nyc_mobility_project/models/marts/trip_enriched.sql.
[0m20:11:16.875783 [debug] [Thread-1 (]: Began running node model.nyc_mobility_project.high_value_customers
[0m20:11:16.878169 [info ] [Thread-1 (]: 3 of 4 SKIP relation public.high_value_customers ............................... [[33mSKIP[0m]
[0m20:11:16.880576 [debug] [Thread-1 (]: Finished running node model.nyc_mobility_project.high_value_customers
[0m20:11:16.882650 [debug] [Thread-1 (]: Began running node model.nyc_mobility_project.trip_summary_per_hour
[0m20:11:16.884955 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.trip_summary_per_hour .............................. [[33mSKIP[0m]
[0m20:11:16.886999 [debug] [Thread-1 (]: Finished running node model.nyc_mobility_project.trip_summary_per_hour
[0m20:11:16.890736 [debug] [MainThread]: Using postgres connection "master"
[0m20:11:16.892447 [debug] [MainThread]: On master: BEGIN
[0m20:11:16.894184 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:11:16.900340 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m20:11:16.902789 [debug] [MainThread]: On master: COMMIT
[0m20:11:16.904771 [debug] [MainThread]: Using postgres connection "master"
[0m20:11:16.906917 [debug] [MainThread]: On master: COMMIT
[0m20:11:16.909193 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:11:16.911356 [debug] [MainThread]: On master: Close
[0m20:11:16.913513 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:11:16.915713 [debug] [MainThread]: Connection 'model.nyc_mobility_project.trip_enriched' was properly closed.
[0m20:11:16.917803 [info ] [MainThread]: 
[0m20:11:16.919550 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 0.95 seconds (0.95s).
[0m20:11:16.922331 [debug] [MainThread]: Command end result
[0m20:11:17.012376 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m20:11:17.026078 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m20:11:17.051441 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m20:11:17.054010 [info ] [MainThread]: 
[0m20:11:17.056504 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:11:17.058937 [info ] [MainThread]: 
[0m20:11:17.061391 [error] [MainThread]:   Database Error in model trip_enriched (models/marts/trip_enriched.sql)
  relation "public.source_fact_taxi_trips" does not exist
  LINE 30: FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
                ^
  compiled code at target/run/nyc_mobility_project/models/marts/trip_enriched.sql
[0m20:11:17.063785 [info ] [MainThread]: 
[0m20:11:17.065886 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=2 TOTAL=4
[0m20:11:17.069200 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.1291637, "process_in_blocks": "27024", "process_kernel_time": 1.25703, "process_mem_max_rss": "127972", "process_out_blocks": "0", "process_user_time": 8.044992}
[0m20:11:17.071632 [debug] [MainThread]: Command `dbt run` failed at 20:11:17.071397 after 5.13 seconds
[0m20:11:17.073752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd979c7f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd94d8ff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd969566e0>]}
[0m20:11:17.075663 [debug] [MainThread]: Flushing usage events
[0m20:11:17.342281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc45ee58040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc45de68b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc45de68be0>]}


============================== 20:11:17.350787 | 1281c806-57b1-46bf-83e6-f9817361818f ==============================
[0m20:11:17.350787 [info ] [MainThread]: Running with dbt=1.9.4
[0m20:11:17.353041 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select trip_enriched trip_summary_per_hour high_value_customers source_dim_weather', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:11:17.476080 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m20:11:17.478091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1281c806-57b1-46bf-83e6-f9817361818f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc45e11c7c0>]}
[0m20:11:17.480166 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m20:11:17.482086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1281c806-57b1-46bf-83e6-f9817361818f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc45e11ff70>]}
[0m20:11:17.615274 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:11:17.699057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1281c806-57b1-46bf-83e6-f9817361818f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc45d8a0700>]}
[0m20:11:17.830665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1281c806-57b1-46bf-83e6-f9817361818f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc45ed80d30>]}
[0m20:11:17.833831 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:11:18.042321 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m20:11:18.446964 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:11:18.448997 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:11:18.551690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1281c806-57b1-46bf-83e6-f9817361818f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc45cdb4370>]}
[0m20:11:18.777158 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m20:11:18.795876 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m20:11:18.825991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1281c806-57b1-46bf-83e6-f9817361818f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc45c51a410>]}
[0m20:11:18.828341 [info ] [MainThread]: Found 6 models, 2 sources, 433 macros
[0m20:11:18.830537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1281c806-57b1-46bf-83e6-f9817361818f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc45c51a680>]}
[0m20:11:18.835641 [info ] [MainThread]: 
[0m20:11:18.837668 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:11:18.839653 [info ] [MainThread]: 
[0m20:11:18.842218 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:11:18.851653 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nyc_dwh'
[0m20:11:18.909761 [debug] [ThreadPool]: Using postgres connection "list_nyc_dwh"
[0m20:11:18.911635 [debug] [ThreadPool]: On list_nyc_dwh: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "connection_name": "list_nyc_dwh"} */

    select distinct nspname from pg_namespace
  
[0m20:11:18.913537 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:11:18.920769 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m20:11:18.923785 [debug] [ThreadPool]: On list_nyc_dwh: Close
[0m20:11:18.928229 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nyc_dwh, now list_nyc_dwh_public)
[0m20:11:18.990420 [debug] [ThreadPool]: Using postgres connection "list_nyc_dwh_public"
[0m20:11:18.992411 [debug] [ThreadPool]: On list_nyc_dwh_public: BEGIN
[0m20:11:18.994096 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:11:18.999793 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m20:11:19.002028 [debug] [ThreadPool]: Using postgres connection "list_nyc_dwh_public"
[0m20:11:19.003750 [debug] [ThreadPool]: On list_nyc_dwh_public: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "connection_name": "list_nyc_dwh_public"} */
select
      'nyc_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'nyc_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'nyc_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:11:19.008808 [debug] [ThreadPool]: SQL status: SELECT 47 in 0.003 seconds
[0m20:11:19.013479 [debug] [ThreadPool]: On list_nyc_dwh_public: ROLLBACK
[0m20:11:19.015326 [debug] [ThreadPool]: On list_nyc_dwh_public: Close
[0m20:11:19.037518 [debug] [MainThread]: Using postgres connection "master"
[0m20:11:19.039287 [debug] [MainThread]: On master: BEGIN
[0m20:11:19.040973 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:11:19.046477 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m20:11:19.048782 [debug] [MainThread]: Using postgres connection "master"
[0m20:11:19.050982 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:11:19.060645 [debug] [MainThread]: SQL status: SELECT 1 in 0.008 seconds
[0m20:11:19.063978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1281c806-57b1-46bf-83e6-f9817361818f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc45c988f40>]}
[0m20:11:19.066081 [debug] [MainThread]: On master: ROLLBACK
[0m20:11:19.069131 [debug] [MainThread]: Using postgres connection "master"
[0m20:11:19.070841 [debug] [MainThread]: On master: BEGIN
[0m20:11:19.073277 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:11:19.075564 [debug] [MainThread]: On master: COMMIT
[0m20:11:19.077310 [debug] [MainThread]: Using postgres connection "master"
[0m20:11:19.079014 [debug] [MainThread]: On master: COMMIT
[0m20:11:19.081196 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:11:19.083272 [debug] [MainThread]: On master: Close
[0m20:11:19.091004 [debug] [Thread-1 (]: Began running node model.nyc_mobility_project.source_dim_weather
[0m20:11:19.093084 [info ] [Thread-1 (]: 1 of 4 START sql view model public.source_dim_weather .......................... [RUN]
[0m20:11:19.095128 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nyc_dwh_public, now model.nyc_mobility_project.source_dim_weather)
[0m20:11:19.097102 [debug] [Thread-1 (]: Began compiling node model.nyc_mobility_project.source_dim_weather
[0m20:11:19.113829 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_mobility_project.source_dim_weather"
[0m20:11:19.130228 [debug] [Thread-1 (]: Began executing node model.nyc_mobility_project.source_dim_weather
[0m20:11:19.200021 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_mobility_project.source_dim_weather"
[0m20:11:19.211040 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.source_dim_weather"
[0m20:11:19.212985 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: BEGIN
[0m20:11:19.214697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:11:19.220781 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m20:11:19.223702 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.source_dim_weather"
[0m20:11:19.225922 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.source_dim_weather"} */

  create view "nyc_dwh"."public"."source_dim_weather__dbt_tmp"
    
    
  as (
    

SELECT * FROM "nyc_dwh"."public"."dim_weather"
  );
[0m20:11:19.229453 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m20:11:19.244616 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.source_dim_weather"
[0m20:11:19.246341 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.source_dim_weather"} */
alter table "nyc_dwh"."public"."source_dim_weather" rename to "source_dim_weather__dbt_backup"
[0m20:11:19.248825 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:11:19.255582 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.source_dim_weather"
[0m20:11:19.257515 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.source_dim_weather"} */
alter table "nyc_dwh"."public"."source_dim_weather__dbt_tmp" rename to "source_dim_weather"
[0m20:11:19.259818 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:11:19.291420 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: COMMIT
[0m20:11:19.293522 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.source_dim_weather"
[0m20:11:19.295394 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: COMMIT
[0m20:11:19.299375 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:11:19.311037 [debug] [Thread-1 (]: Applying DROP to: "nyc_dwh"."public"."source_dim_weather__dbt_backup"
[0m20:11:19.321962 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.source_dim_weather"
[0m20:11:19.323950 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.source_dim_weather"} */
drop view if exists "nyc_dwh"."public"."source_dim_weather__dbt_backup" cascade
[0m20:11:19.328698 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m20:11:19.334276 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: Close
[0m20:11:19.338449 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1281c806-57b1-46bf-83e6-f9817361818f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc45c9623e0>]}
[0m20:11:19.340814 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.source_dim_weather ..................... [[32mCREATE VIEW[0m in 0.24s]
[0m20:11:19.343125 [debug] [Thread-1 (]: Finished running node model.nyc_mobility_project.source_dim_weather
[0m20:11:19.345965 [debug] [Thread-1 (]: Began running node model.nyc_mobility_project.trip_enriched
[0m20:11:19.348096 [info ] [Thread-1 (]: 2 of 4 START sql table model public.trip_enriched .............................. [RUN]
[0m20:11:19.350393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_mobility_project.source_dim_weather, now model.nyc_mobility_project.trip_enriched)
[0m20:11:19.352300 [debug] [Thread-1 (]: Began compiling node model.nyc_mobility_project.trip_enriched
[0m20:11:19.359193 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_mobility_project.trip_enriched"
[0m20:11:19.369249 [debug] [Thread-1 (]: Began executing node model.nyc_mobility_project.trip_enriched
[0m20:11:19.412979 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_mobility_project.trip_enriched"
[0m20:11:19.423545 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_enriched"
[0m20:11:19.425837 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: BEGIN
[0m20:11:19.427842 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:11:19.434170 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m20:11:19.436597 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_enriched"
[0m20:11:19.438547 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.trip_enriched"} */

  
    

  create  table "nyc_dwh"."public"."trip_enriched__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    t.passenger_count,
    t.trip_distance,
    t.tpep_pickup_datetime,
    t.tpep_dropoff_datetime,
    t.payment_type,
    t.fare_amount,
    t.tip_amount,
    t.tip_percentage,
    t.distance_bucket,
    t.pickup_hour,
    t.pickup_day_of_week,
    w.weather_category,
    w.temperature,
    w.humidity,
    w.wind_speed
FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
LEFT JOIN "nyc_dwh"."public"."source_dim_weather" w
    ON date_trunc('hour', t.tpep_pickup_datetime) = date_trunc('hour', w.event_time)
  );
  
[0m20:11:19.441600 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.source_fact_taxi_trips" does not exist
LINE 30: FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
              ^

[0m20:11:19.444646 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: ROLLBACK
[0m20:11:19.447245 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: Close
[0m20:11:19.452644 [debug] [Thread-1 (]: Database Error in model trip_enriched (models/marts/trip_enriched.sql)
  relation "public.source_fact_taxi_trips" does not exist
  LINE 30: FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
                ^
  compiled code at target/run/nyc_mobility_project/models/marts/trip_enriched.sql
[0m20:11:19.455299 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1281c806-57b1-46bf-83e6-f9817361818f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc45edacb20>]}
[0m20:11:19.458264 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.trip_enriched ..................... [[31mERROR[0m in 0.10s]
[0m20:11:19.461058 [debug] [Thread-1 (]: Finished running node model.nyc_mobility_project.trip_enriched
[0m20:11:19.463515 [debug] [Thread-4 (]: Marking all children of 'model.nyc_mobility_project.trip_enriched' to be skipped because of status 'error'.  Reason: Database Error in model trip_enriched (models/marts/trip_enriched.sql)
  relation "public.source_fact_taxi_trips" does not exist
  LINE 30: FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
                ^
  compiled code at target/run/nyc_mobility_project/models/marts/trip_enriched.sql.
[0m20:11:19.466901 [debug] [Thread-1 (]: Began running node model.nyc_mobility_project.high_value_customers
[0m20:11:19.469005 [info ] [Thread-1 (]: 3 of 4 SKIP relation public.high_value_customers ............................... [[33mSKIP[0m]
[0m20:11:19.471118 [debug] [Thread-1 (]: Finished running node model.nyc_mobility_project.high_value_customers
[0m20:11:19.473308 [debug] [Thread-1 (]: Began running node model.nyc_mobility_project.trip_summary_per_hour
[0m20:11:19.475376 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.trip_summary_per_hour .............................. [[33mSKIP[0m]
[0m20:11:19.477445 [debug] [Thread-1 (]: Finished running node model.nyc_mobility_project.trip_summary_per_hour
[0m20:11:19.480829 [debug] [MainThread]: Using postgres connection "master"
[0m20:11:19.482988 [debug] [MainThread]: On master: BEGIN
[0m20:11:19.484828 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:11:19.490742 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m20:11:19.493059 [debug] [MainThread]: On master: COMMIT
[0m20:11:19.494817 [debug] [MainThread]: Using postgres connection "master"
[0m20:11:19.496572 [debug] [MainThread]: On master: COMMIT
[0m20:11:19.498854 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:11:19.500932 [debug] [MainThread]: On master: Close
[0m20:11:19.503202 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:11:19.504970 [debug] [MainThread]: Connection 'model.nyc_mobility_project.trip_enriched' was properly closed.
[0m20:11:19.507038 [info ] [MainThread]: 
[0m20:11:19.508953 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m20:11:19.511811 [debug] [MainThread]: Command end result
[0m20:11:19.575361 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m20:11:19.583648 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m20:11:19.601658 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m20:11:19.603494 [info ] [MainThread]: 
[0m20:11:19.605710 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:11:19.607823 [info ] [MainThread]: 
[0m20:11:19.609899 [error] [MainThread]:   Database Error in model trip_enriched (models/marts/trip_enriched.sql)
  relation "public.source_fact_taxi_trips" does not exist
  LINE 30: FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
                ^
  compiled code at target/run/nyc_mobility_project/models/marts/trip_enriched.sql
[0m20:11:19.611916 [info ] [MainThread]: 
[0m20:11:19.614068 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=2 TOTAL=4
[0m20:11:19.618117 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.409097, "process_in_blocks": "0", "process_kernel_time": 0.25955, "process_mem_max_rss": "120320", "process_out_blocks": "0", "process_user_time": 5.210981}
[0m20:11:19.620982 [debug] [MainThread]: Command `dbt run` failed at 20:11:19.620624 after 2.41 seconds
[0m20:11:19.623097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc45ee58040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc45b0a42b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc45b0a4cd0>]}
[0m20:11:19.625213 [debug] [MainThread]: Flushing usage events
[0m20:11:20.031395 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:51:07.330401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26e4053a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26e30d9c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26e30d8700>]}


============================== 20:51:07.343514 | 8228f645-6287-4c79-b5f0-7ad37d9104ba ==============================
[0m20:51:07.343514 [info ] [MainThread]: Running with dbt=1.10.3
[0m20:51:07.348231 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select trip_enriched trip_summary_per_hour high_value_customers source_dim_weather', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:51:07.531573 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m20:51:07.533626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8228f645-6287-4c79-b5f0-7ad37d9104ba', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26e2529f60>]}
[0m20:51:07.535579 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m20:51:07.537655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8228f645-6287-4c79-b5f0-7ad37d9104ba', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26e252bc10>]}
[0m20:51:07.807469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8228f645-6287-4c79-b5f0-7ad37d9104ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26e3dd0610>]}
[0m20:51:07.939112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8228f645-6287-4c79-b5f0-7ad37d9104ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26e57dd8d0>]}
[0m20:51:07.941981 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:51:08.168641 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m20:51:08.435287 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m20:51:08.438622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8228f645-6287-4c79-b5f0-7ad37d9104ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26e1ddf4c0>]}
[0m20:51:13.407840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8228f645-6287-4c79-b5f0-7ad37d9104ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26e0165570>]}
[0m20:51:13.655442 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m20:51:13.668253 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m20:51:13.750812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8228f645-6287-4c79-b5f0-7ad37d9104ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26d3f00820>]}
[0m20:51:13.753757 [info ] [MainThread]: Found 6 models, 2 sources, 433 macros
[0m20:51:13.758920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8228f645-6287-4c79-b5f0-7ad37d9104ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26d3f01c30>]}
[0m20:51:13.772405 [info ] [MainThread]: 
[0m20:51:13.787526 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:51:13.790435 [info ] [MainThread]: 
[0m20:51:13.799121 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:51:13.848021 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nyc_dwh'
[0m20:51:14.169628 [debug] [ThreadPool]: Using postgres connection "list_nyc_dwh"
[0m20:51:14.171867 [debug] [ThreadPool]: On list_nyc_dwh: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "nyc_profile", "target_name": "dev", "connection_name": "list_nyc_dwh"} */

    select distinct nspname from pg_namespace
  
[0m20:51:14.173738 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:51:14.183390 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.010 seconds
[0m20:51:14.187590 [debug] [ThreadPool]: On list_nyc_dwh: Close
[0m20:51:14.193412 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nyc_dwh, now list_nyc_dwh_public)
[0m20:51:14.214633 [debug] [ThreadPool]: Using postgres connection "list_nyc_dwh_public"
[0m20:51:14.220347 [debug] [ThreadPool]: On list_nyc_dwh_public: BEGIN
[0m20:51:14.223559 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:51:14.245963 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m20:51:14.249649 [debug] [ThreadPool]: Using postgres connection "list_nyc_dwh_public"
[0m20:51:14.253380 [debug] [ThreadPool]: On list_nyc_dwh_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "nyc_profile", "target_name": "dev", "connection_name": "list_nyc_dwh_public"} */
select
      'nyc_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'nyc_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'nyc_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:51:14.263226 [debug] [ThreadPool]: SQL status: SELECT 44 in 0.006 seconds
[0m20:51:14.278346 [debug] [ThreadPool]: On list_nyc_dwh_public: ROLLBACK
[0m20:51:14.282970 [debug] [ThreadPool]: On list_nyc_dwh_public: Close
[0m20:51:14.349058 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:14.363264 [debug] [MainThread]: On master: BEGIN
[0m20:51:14.402637 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:51:14.440768 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m20:51:14.445739 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:14.449711 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "nyc_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:51:14.469663 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m20:51:14.487311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8228f645-6287-4c79-b5f0-7ad37d9104ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26e119c070>]}
[0m20:51:14.498752 [debug] [MainThread]: On master: ROLLBACK
[0m20:51:14.517636 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:14.520510 [debug] [MainThread]: On master: BEGIN
[0m20:51:14.523519 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:51:14.526075 [debug] [MainThread]: On master: COMMIT
[0m20:51:14.528835 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:14.531738 [debug] [MainThread]: On master: COMMIT
[0m20:51:14.541625 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:51:14.544377 [debug] [MainThread]: On master: Close
[0m20:51:14.558298 [debug] [Thread-1 (]: Began running node model.nyc_mobility_project.source_dim_weather
[0m20:51:14.567028 [info ] [Thread-1 (]: 1 of 4 START sql view model public.source_dim_weather .......................... [RUN]
[0m20:51:14.569692 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nyc_dwh_public, now model.nyc_mobility_project.source_dim_weather)
[0m20:51:14.572044 [debug] [Thread-1 (]: Began compiling node model.nyc_mobility_project.source_dim_weather
[0m20:51:14.621412 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_mobility_project.source_dim_weather"
[0m20:51:14.641948 [debug] [Thread-1 (]: Began executing node model.nyc_mobility_project.source_dim_weather
[0m20:51:14.929151 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_mobility_project.source_dim_weather"
[0m20:51:15.007074 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.source_dim_weather"
[0m20:51:15.009601 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: BEGIN
[0m20:51:15.012451 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:51:15.028165 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m20:51:15.030703 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.source_dim_weather"
[0m20:51:15.033274 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.source_dim_weather"} */

  create view "nyc_dwh"."public"."source_dim_weather__dbt_tmp"
    
    
  as (
    

SELECT * FROM "nyc_dwh"."public"."dim_weather"
  );
[0m20:51:15.045489 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m20:51:15.090969 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.source_dim_weather"
[0m20:51:15.103396 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.source_dim_weather"} */
alter table "nyc_dwh"."public"."source_dim_weather__dbt_tmp" rename to "source_dim_weather"
[0m20:51:15.106795 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:51:15.183156 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: COMMIT
[0m20:51:15.185869 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.source_dim_weather"
[0m20:51:15.188242 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: COMMIT
[0m20:51:15.195323 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m20:51:15.225227 [debug] [Thread-1 (]: Applying DROP to: "nyc_dwh"."public"."source_dim_weather__dbt_backup"
[0m20:51:15.247519 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.source_dim_weather"
[0m20:51:15.250583 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.source_dim_weather"} */
drop view if exists "nyc_dwh"."public"."source_dim_weather__dbt_backup" cascade
[0m20:51:15.255638 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m20:51:15.273314 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: Close
[0m20:51:15.282867 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8228f645-6287-4c79-b5f0-7ad37d9104ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26e40e2590>]}
[0m20:51:15.289706 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.source_dim_weather ..................... [[32mCREATE VIEW[0m in 0.71s]
[0m20:51:15.294408 [debug] [Thread-1 (]: Finished running node model.nyc_mobility_project.source_dim_weather
[0m20:51:15.299328 [debug] [Thread-1 (]: Began running node model.nyc_mobility_project.trip_enriched
[0m20:51:15.302260 [info ] [Thread-1 (]: 2 of 4 START sql table model public.trip_enriched .............................. [RUN]
[0m20:51:15.305544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_mobility_project.source_dim_weather, now model.nyc_mobility_project.trip_enriched)
[0m20:51:15.308039 [debug] [Thread-1 (]: Began compiling node model.nyc_mobility_project.trip_enriched
[0m20:51:15.317310 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_mobility_project.trip_enriched"
[0m20:51:15.330650 [debug] [Thread-1 (]: Began executing node model.nyc_mobility_project.trip_enriched
[0m20:51:15.417752 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_mobility_project.trip_enriched"
[0m20:51:15.432617 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_enriched"
[0m20:51:15.435043 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: BEGIN
[0m20:51:15.437344 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:51:15.444564 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m20:51:15.447467 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_enriched"
[0m20:51:15.450166 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.trip_enriched"} */

  
    

  create  table "nyc_dwh"."public"."trip_enriched__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    t.passenger_count,
    t.trip_distance,
    t.tpep_pickup_datetime,
    t.tpep_dropoff_datetime,
    t.payment_type,
    t.fare_amount,
    t.tip_amount,
    t.tip_percentage,
    t.distance_bucket,
    t.pickup_hour,
    t.pickup_day_of_week,
    w.weather_category,
    w.temperature,
    w.humidity,
    w.wind_speed
FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
LEFT JOIN "nyc_dwh"."public"."source_dim_weather" w
    ON date_trunc('hour', t.tpep_pickup_datetime) = date_trunc('hour', w.event_time)
  );
  
[0m20:51:15.453285 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.source_fact_taxi_trips" does not exist
LINE 30: FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
              ^

[0m20:51:15.455560 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: ROLLBACK
[0m20:51:15.458286 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: Close
[0m20:51:16.748094 [debug] [Thread-1 (]: Database Error in model trip_enriched (models/marts/trip_enriched.sql)
  relation "public.source_fact_taxi_trips" does not exist
  LINE 30: FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
                ^
  compiled code at target/run/nyc_mobility_project/models/marts/trip_enriched.sql
[0m20:51:16.765758 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8228f645-6287-4c79-b5f0-7ad37d9104ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26e119d0c0>]}
[0m20:51:16.768845 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.trip_enriched ..................... [[31mERROR[0m in 1.46s]
[0m20:51:16.772604 [debug] [Thread-1 (]: Finished running node model.nyc_mobility_project.trip_enriched
[0m20:51:16.780945 [debug] [Thread-4 (]: Marking all children of 'model.nyc_mobility_project.trip_enriched' to be skipped because of status 'error'.  Reason: Database Error in model trip_enriched (models/marts/trip_enriched.sql)
  relation "public.source_fact_taxi_trips" does not exist
  LINE 30: FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
                ^
  compiled code at target/run/nyc_mobility_project/models/marts/trip_enriched.sql.
[0m20:51:16.786048 [debug] [Thread-1 (]: Began running node model.nyc_mobility_project.high_value_customers
[0m20:51:16.788619 [info ] [Thread-1 (]: 3 of 4 SKIP relation public.high_value_customers ............................... [[33mSKIP[0m]
[0m20:51:16.791695 [debug] [Thread-1 (]: Finished running node model.nyc_mobility_project.high_value_customers
[0m20:51:16.794406 [debug] [Thread-1 (]: Began running node model.nyc_mobility_project.trip_summary_per_hour
[0m20:51:16.798059 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.trip_summary_per_hour .............................. [[33mSKIP[0m]
[0m20:51:16.803679 [debug] [Thread-1 (]: Finished running node model.nyc_mobility_project.trip_summary_per_hour
[0m20:51:16.813361 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:16.816064 [debug] [MainThread]: On master: BEGIN
[0m20:51:16.818119 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:51:16.825596 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m20:51:16.827729 [debug] [MainThread]: On master: COMMIT
[0m20:51:16.829625 [debug] [MainThread]: Using postgres connection "master"
[0m20:51:16.832063 [debug] [MainThread]: On master: COMMIT
[0m20:51:16.835515 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:51:16.837390 [debug] [MainThread]: On master: Close
[0m20:51:16.839900 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:51:16.842225 [debug] [MainThread]: Connection 'model.nyc_mobility_project.trip_enriched' was properly closed.
[0m20:51:16.844564 [info ] [MainThread]: 
[0m20:51:16.846936 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 3.05 seconds (3.05s).
[0m20:51:16.850781 [debug] [MainThread]: Command end result
[0m20:51:16.931759 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m20:51:16.940449 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m20:51:16.960580 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m20:51:16.962399 [info ] [MainThread]: 
[0m20:51:16.964416 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:51:16.966214 [info ] [MainThread]: 
[0m20:51:16.968571 [error] [MainThread]: [31mFailure in model trip_enriched (models/marts/trip_enriched.sql)[0m
[0m20:51:16.971127 [error] [MainThread]:   Database Error in model trip_enriched (models/marts/trip_enriched.sql)
  relation "public.source_fact_taxi_trips" does not exist
  LINE 30: FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
                ^
  compiled code at target/run/nyc_mobility_project/models/marts/trip_enriched.sql
[0m20:51:16.973388 [info ] [MainThread]: 
[0m20:51:16.975686 [info ] [MainThread]:   compiled code at target/compiled/nyc_mobility_project/models/marts/trip_enriched.sql
[0m20:51:16.977721 [info ] [MainThread]: 
[0m20:51:16.979911 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=4
[0m20:51:16.982925 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigSourcePathDeprecation: 1 occurrence
- ConfigDataPathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m20:51:16.988644 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 9.81186, "process_in_blocks": "21440", "process_kernel_time": 0.75494, "process_mem_max_rss": "130660", "process_out_blocks": "496", "process_user_time": 12.582335}
[0m20:51:16.991402 [debug] [MainThread]: Command `dbt run` failed at 20:51:16.991083 after 9.81 seconds
[0m20:51:16.993890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26e4053a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26e0135360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26e3d0a860>]}
[0m20:51:16.996157 [debug] [MainThread]: Flushing usage events
[0m20:51:17.541389 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:56:21.698215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dee72ba60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8deff33b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8deff32260>]}


============================== 20:56:21.708971 | eabe0618-de5d-4db6-8aad-667aa9fbae31 ==============================
[0m20:56:21.708971 [info ] [MainThread]: Running with dbt=1.10.3
[0m20:56:21.711517 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt_project', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select trip_enriched trip_summary_per_hour high_value_customers source_dim_weather', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:56:21.824951 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m20:56:21.827039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'eabe0618-de5d-4db6-8aad-667aa9fbae31', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ded6cceb0>]}
[0m20:56:21.829343 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m20:56:21.831265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'eabe0618-de5d-4db6-8aad-667aa9fbae31', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ded6ce0b0>]}
[0m20:56:22.023914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eabe0618-de5d-4db6-8aad-667aa9fbae31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8defe1a800>]}
[0m20:56:22.138681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eabe0618-de5d-4db6-8aad-667aa9fbae31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ded563730>]}
[0m20:56:22.141278 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:56:22.296571 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m20:56:22.633403 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:56:22.635294 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:56:22.706040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eabe0618-de5d-4db6-8aad-667aa9fbae31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8deb989600>]}
[0m20:56:22.873919 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m20:56:22.881363 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m20:56:22.914926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eabe0618-de5d-4db6-8aad-667aa9fbae31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8deb544b50>]}
[0m20:56:22.917544 [info ] [MainThread]: Found 6 models, 2 sources, 433 macros
[0m20:56:22.919748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eabe0618-de5d-4db6-8aad-667aa9fbae31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8deb544880>]}
[0m20:56:22.923657 [info ] [MainThread]: 
[0m20:56:22.925435 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:56:22.927282 [info ] [MainThread]: 
[0m20:56:22.929391 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:56:22.938449 [debug] [ThreadPool]: Acquiring new postgres connection 'list_nyc_dwh'
[0m20:56:23.057422 [debug] [ThreadPool]: Using postgres connection "list_nyc_dwh"
[0m20:56:23.060063 [debug] [ThreadPool]: On list_nyc_dwh: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "nyc_profile", "target_name": "dev", "connection_name": "list_nyc_dwh"} */

    select distinct nspname from pg_namespace
  
[0m20:56:23.062616 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:56:23.075856 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.013 seconds
[0m20:56:23.080621 [debug] [ThreadPool]: On list_nyc_dwh: Close
[0m20:56:23.086312 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_nyc_dwh, now list_nyc_dwh_public)
[0m20:56:23.104298 [debug] [ThreadPool]: Using postgres connection "list_nyc_dwh_public"
[0m20:56:23.109077 [debug] [ThreadPool]: On list_nyc_dwh_public: BEGIN
[0m20:56:23.112076 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:56:23.122062 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m20:56:23.125136 [debug] [ThreadPool]: Using postgres connection "list_nyc_dwh_public"
[0m20:56:23.129361 [debug] [ThreadPool]: On list_nyc_dwh_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "nyc_profile", "target_name": "dev", "connection_name": "list_nyc_dwh_public"} */
select
      'nyc_dwh' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'nyc_dwh' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'nyc_dwh' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:56:23.136734 [debug] [ThreadPool]: SQL status: SELECT 45 in 0.005 seconds
[0m20:56:23.143548 [debug] [ThreadPool]: On list_nyc_dwh_public: ROLLBACK
[0m20:56:23.146652 [debug] [ThreadPool]: On list_nyc_dwh_public: Close
[0m20:56:23.181971 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:23.184734 [debug] [MainThread]: On master: BEGIN
[0m20:56:23.187009 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:56:23.195572 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m20:56:23.197929 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:23.201165 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "nyc_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:56:23.220509 [debug] [MainThread]: SQL status: SELECT 1 in 0.017 seconds
[0m20:56:23.224333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eabe0618-de5d-4db6-8aad-667aa9fbae31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dec985c00>]}
[0m20:56:23.226834 [debug] [MainThread]: On master: ROLLBACK
[0m20:56:23.229385 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:23.231214 [debug] [MainThread]: On master: BEGIN
[0m20:56:23.233523 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:56:23.235243 [debug] [MainThread]: On master: COMMIT
[0m20:56:23.236930 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:23.238571 [debug] [MainThread]: On master: COMMIT
[0m20:56:23.240465 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:56:23.242057 [debug] [MainThread]: On master: Close
[0m20:56:23.249007 [debug] [Thread-1 (]: Began running node model.nyc_mobility_project.source_dim_weather
[0m20:56:23.252129 [info ] [Thread-1 (]: 1 of 4 START sql view model public.source_dim_weather .......................... [RUN]
[0m20:56:23.254677 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_nyc_dwh_public, now model.nyc_mobility_project.source_dim_weather)
[0m20:56:23.257021 [debug] [Thread-1 (]: Began compiling node model.nyc_mobility_project.source_dim_weather
[0m20:56:23.276497 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_mobility_project.source_dim_weather"
[0m20:56:23.291194 [debug] [Thread-1 (]: Began executing node model.nyc_mobility_project.source_dim_weather
[0m20:56:23.370937 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_mobility_project.source_dim_weather"
[0m20:56:23.381269 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.source_dim_weather"
[0m20:56:23.383334 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: BEGIN
[0m20:56:23.385165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:23.391237 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m20:56:23.392851 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.source_dim_weather"
[0m20:56:23.394399 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.source_dim_weather"} */

  create view "nyc_dwh"."public"."source_dim_weather__dbt_tmp"
    
    
  as (
    

SELECT * FROM "nyc_dwh"."public"."dim_weather"
  );
[0m20:56:23.397607 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m20:56:23.410460 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.source_dim_weather"
[0m20:56:23.412410 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.source_dim_weather"} */
alter table "nyc_dwh"."public"."source_dim_weather" rename to "source_dim_weather__dbt_backup"
[0m20:56:23.414615 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:56:23.420940 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.source_dim_weather"
[0m20:56:23.422682 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.source_dim_weather"} */
alter table "nyc_dwh"."public"."source_dim_weather__dbt_tmp" rename to "source_dim_weather"
[0m20:56:23.424881 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:56:23.460082 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: COMMIT
[0m20:56:23.462047 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.source_dim_weather"
[0m20:56:23.463958 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: COMMIT
[0m20:56:23.468894 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m20:56:23.482123 [debug] [Thread-1 (]: Applying DROP to: "nyc_dwh"."public"."source_dim_weather__dbt_backup"
[0m20:56:23.490685 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.source_dim_weather"
[0m20:56:23.492608 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.source_dim_weather"} */
drop view if exists "nyc_dwh"."public"."source_dim_weather__dbt_backup" cascade
[0m20:56:23.498224 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m20:56:23.503386 [debug] [Thread-1 (]: On model.nyc_mobility_project.source_dim_weather: Close
[0m20:56:23.507284 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eabe0618-de5d-4db6-8aad-667aa9fbae31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8deb918670>]}
[0m20:56:23.509777 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.source_dim_weather ..................... [[32mCREATE VIEW[0m in 0.25s]
[0m20:56:23.512034 [debug] [Thread-1 (]: Finished running node model.nyc_mobility_project.source_dim_weather
[0m20:56:23.514685 [debug] [Thread-1 (]: Began running node model.nyc_mobility_project.trip_enriched
[0m20:56:23.517138 [info ] [Thread-1 (]: 2 of 4 START sql table model public.trip_enriched .............................. [RUN]
[0m20:56:23.519512 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_mobility_project.source_dim_weather, now model.nyc_mobility_project.trip_enriched)
[0m20:56:23.521172 [debug] [Thread-1 (]: Began compiling node model.nyc_mobility_project.trip_enriched
[0m20:56:23.527779 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_mobility_project.trip_enriched"
[0m20:56:23.537875 [debug] [Thread-1 (]: Began executing node model.nyc_mobility_project.trip_enriched
[0m20:56:23.596019 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_mobility_project.trip_enriched"
[0m20:56:23.606595 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_enriched"
[0m20:56:23.608773 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: BEGIN
[0m20:56:23.610440 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:23.616335 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m20:56:23.618294 [debug] [Thread-1 (]: Using postgres connection "model.nyc_mobility_project.trip_enriched"
[0m20:56:23.620451 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "nyc_profile", "target_name": "dev", "node_id": "model.nyc_mobility_project.trip_enriched"} */

  
    

  create  table "nyc_dwh"."public"."trip_enriched__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    t.passenger_count,
    t.trip_distance,
    t.tpep_pickup_datetime,
    t.tpep_dropoff_datetime,
    t.payment_type,
    t.fare_amount,
    t.tip_amount,
    t.tip_percentage,
    t.distance_bucket,
    t.pickup_hour,
    t.pickup_day_of_week,
    w.weather_category,
    w.temperature,
    w.humidity,
    w.wind_speed
FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
LEFT JOIN "nyc_dwh"."public"."source_dim_weather" w
    ON date_trunc('hour', t.tpep_pickup_datetime) = date_trunc('hour', w.event_time)
  );
  
[0m20:56:23.623562 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.source_fact_taxi_trips" does not exist
LINE 30: FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
              ^

[0m20:56:23.625399 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: ROLLBACK
[0m20:56:23.629245 [debug] [Thread-1 (]: On model.nyc_mobility_project.trip_enriched: Close
[0m20:56:23.635276 [debug] [Thread-1 (]: Database Error in model trip_enriched (models/marts/trip_enriched.sql)
  relation "public.source_fact_taxi_trips" does not exist
  LINE 30: FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
                ^
  compiled code at target/run/nyc_mobility_project/models/marts/trip_enriched.sql
[0m20:56:23.637454 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eabe0618-de5d-4db6-8aad-667aa9fbae31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dee8da620>]}
[0m20:56:23.639730 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.trip_enriched ..................... [[31mERROR[0m in 0.12s]
[0m20:56:23.642578 [debug] [Thread-1 (]: Finished running node model.nyc_mobility_project.trip_enriched
[0m20:56:23.645280 [debug] [Thread-4 (]: Marking all children of 'model.nyc_mobility_project.trip_enriched' to be skipped because of status 'error'.  Reason: Database Error in model trip_enriched (models/marts/trip_enriched.sql)
  relation "public.source_fact_taxi_trips" does not exist
  LINE 30: FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
                ^
  compiled code at target/run/nyc_mobility_project/models/marts/trip_enriched.sql.
[0m20:56:23.649136 [debug] [Thread-1 (]: Began running node model.nyc_mobility_project.high_value_customers
[0m20:56:23.651351 [info ] [Thread-1 (]: 3 of 4 SKIP relation public.high_value_customers ............................... [[33mSKIP[0m]
[0m20:56:23.653619 [debug] [Thread-1 (]: Finished running node model.nyc_mobility_project.high_value_customers
[0m20:56:23.655530 [debug] [Thread-1 (]: Began running node model.nyc_mobility_project.trip_summary_per_hour
[0m20:56:23.657672 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.trip_summary_per_hour .............................. [[33mSKIP[0m]
[0m20:56:23.659940 [debug] [Thread-1 (]: Finished running node model.nyc_mobility_project.trip_summary_per_hour
[0m20:56:23.662926 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:23.664415 [debug] [MainThread]: On master: BEGIN
[0m20:56:23.665859 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:56:23.671233 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m20:56:23.673359 [debug] [MainThread]: On master: COMMIT
[0m20:56:23.675507 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:23.677257 [debug] [MainThread]: On master: COMMIT
[0m20:56:23.679237 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:56:23.681019 [debug] [MainThread]: On master: Close
[0m20:56:23.683223 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:56:23.684895 [debug] [MainThread]: Connection 'model.nyc_mobility_project.trip_enriched' was properly closed.
[0m20:56:23.686789 [info ] [MainThread]: 
[0m20:56:23.688502 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 0.76 seconds (0.76s).
[0m20:56:23.691213 [debug] [MainThread]: Command end result
[0m20:56:23.774314 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m20:56:23.802488 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m20:56:23.827868 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m20:56:23.834307 [info ] [MainThread]: 
[0m20:56:23.837154 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:56:23.840960 [info ] [MainThread]: 
[0m20:56:23.844320 [error] [MainThread]: [31mFailure in model trip_enriched (models/marts/trip_enriched.sql)[0m
[0m20:56:23.847515 [error] [MainThread]:   Database Error in model trip_enriched (models/marts/trip_enriched.sql)
  relation "public.source_fact_taxi_trips" does not exist
  LINE 30: FROM "nyc_dwh"."public"."source_fact_taxi_trips" t
                ^
  compiled code at target/run/nyc_mobility_project/models/marts/trip_enriched.sql
[0m20:56:23.851524 [info ] [MainThread]: 
[0m20:56:23.857642 [info ] [MainThread]:   compiled code at target/compiled/nyc_mobility_project/models/marts/trip_enriched.sql
[0m20:56:23.862097 [info ] [MainThread]: 
[0m20:56:23.864970 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=4
[0m20:56:23.869170 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ConfigSourcePathDeprecation: 1 occurrence
- ConfigDataPathDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m20:56:23.875842 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.2988577, "process_in_blocks": "0", "process_kernel_time": 0.226886, "process_mem_max_rss": "123364", "process_out_blocks": "0", "process_user_time": 3.758423}
[0m20:56:23.879222 [debug] [MainThread]: Command `dbt run` failed at 20:56:23.878858 after 2.30 seconds
[0m20:56:23.883329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dee72ba60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8dee5e7370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8deb99e800>]}
[0m20:56:23.886134 [debug] [MainThread]: Flushing usage events
[0m20:56:24.470960 [debug] [MainThread]: An error was encountered while trying to flush usage events
